import{a as Z}from"./chunk-JN5OTYKR.js";import{a as ee}from"./chunk-VUDJFFTR.js";import"./chunk-I6AMTEEF.js";import{b as H}from"./chunk-U3KJZSAD.js";import{b as k}from"./chunk-LITGK74X.js";import{b as G,d as j,f as z,g as q,j as U,k as W,l as $,m as J,r as K,s as Q,u as X}from"./chunk-T2CGB3F3.js";import{b as D}from"./chunk-LGEN4PPC.js";import{Aa as S,Ca as w,Fa as h,Ha as g,Hb as L,J as A,Jb as M,Ka as c,Nb as Y,O as y,P as x,Qb as O,Rb as V,Sa as l,Ta as m,Ua as b,aa as C,ab as B,ba as i,bb as N,ca as E,fb as n,gb as o,ma as _,qa as f,tb as R,ub as F,wa as a,xa as r,ya as d,za as I,zb as P}from"./chunk-P2JR76SF.js";var te=()=>[20,25,30,35,40];function ie(s,v){if(s&1&&(I(0),a(1,"div",25)(2,"label",26),l(3),n(4,"translate"),r(),d(5,"input",27),n(6,"translate"),r(),S()),s&2){let t=v.$implicit;i(3),b(" ",o(4,3,"TREE_TYPE.CO2_AT_"+t+"_LABEL")," "),i(2),c("placeholder",o(6,5,"TREE_TYPE.CO2_PLACEHOLDER")),f("formControlName","co2AbsorptionAt"+t)}}function re(s,v){if(s&1){let t=w();a(0,"div",1)(1,"form",2),h("ngSubmit",function(){y(t);let p=g();return x(p.onSubmitTreeType())}),a(2,"h1",3),l(3),n(4,"translate"),n(5,"translate"),r(),a(6,"div",4),d(7,"img",5),n(8,"translate"),a(9,"label",6)(10,"span",7),l(11,"photo_camera"),r(),a(12,"span"),l(13),n(14,"translate"),r(),a(15,"input",8),h("change",function(p){y(t);let u=g();return x(u.onTreeTypeFileSelected(p))}),r()()(),a(16,"div",9)(17,"div",10)(18,"label",11),l(19),n(20,"translate"),r(),d(21,"input",12),n(22,"translate"),r(),a(23,"div",10)(24,"label",11),l(25),n(26,"translate"),r(),d(27,"input",13),n(28,"translate"),r()(),a(29,"div",14)(30,"label",11),l(31),n(32,"translate"),r(),d(33,"textarea",15),n(34,"translate"),r(),a(35,"div",16)(36,"p",17),l(37),n(38,"translate"),r(),a(39,"div",18),_(40,ie,7,7,"ng-container",19),r()(),a(41,"div",9)(42,"div",10)(43,"label",11),l(44),n(45,"translate"),r(),d(46,"input",20),n(47,"translate"),r(),a(48,"div",10)(49,"label",11),l(50),n(51,"translate"),r(),d(52,"input",21),n(53,"translate"),r()(),a(54,"div",22)(55,"button",23),h("click",function(){y(t);let p=g();return x(p.cancel())}),l(56),n(57,"translate"),r(),a(58,"button",24),l(59),n(60,"translate"),n(61,"translate"),r()()()()}if(s&2){let t=g();i(),f("formGroup",t.treeTypeForm),i(2),b(" ",t.treeType.id?o(4,19,"TREE_TYPE.EDIT_TITLE"):o(5,21,"TREE_TYPE.NEW_TITLE")," "),i(4),c("alt",o(8,23,"TREE_TYPE.IMAGE_ALT")),f("src",t.previewImage||t.treeType.picture||"assets/tree-placeholder.png",C),i(6),m(o(14,25,"TREE_TYPE.SELECT_IMAGE")),i(6),m(o(20,27,"TREE_TYPE.NAME")),i(2),c("placeholder",o(22,29,"TREE_TYPE.NAME_PLACEHOLDER")),i(4),m(o(26,31,"TREE_TYPE.SCIENTIFIC_NAME")),i(2),c("placeholder",o(28,33,"TREE_TYPE.SCIENTIFIC_NAME_PLACEHOLDER")),i(4),m(o(32,35,"TREE_TYPE.DESCRIPTION")),i(2),c("placeholder",o(34,37,"TREE_TYPE.DESCRIPTION_PLACEHOLDER")),i(4),m(o(38,39,"TREE_TYPE.CO2_ESTIMATIONS_TITLE")),i(3),f("ngForOf",N(55,te)),i(4),m(o(45,41,"TREE_TYPE.TYPICAL_HEIGHT_LABEL")),i(2),c("placeholder",o(47,43,"TREE_TYPE.HEIGHT_PLACEHOLDER")),i(4),m(o(51,45,"TREE_TYPE.LIFESPAN_LABEL")),i(2),c("placeholder",o(53,47,"TREE_TYPE.LIFESPAN_PLACEHOLDER")),i(4),b(" ",o(57,49,"COMMON.CANCEL")," "),i(3),b(" ",t.treeType.id?o(60,51,"COMMON.SAVE_CHANGES"):o(61,53,"TREE_TYPE.CREATE")," ")}}var be=(()=>{class s{constructor(t,e,p,u,T){this.fb=t,this.treeTypeService=e,this.route=p,this.router=u,this.snackBar=T,this.previewImage=null}ngOnInit(){this.initForm();let t=this.route.snapshot.paramMap.get("id");t?this.loadTreeType(+t):this.treeType={}}initForm(){this.treeTypeForm=this.fb.group({name:["",j.required],scientificName:[null],description:[null],co2AbsorptionAt20:[null],co2AbsorptionAt25:[null],co2AbsorptionAt30:[null],co2AbsorptionAt35:[null],co2AbsorptionAt40:[null],typicalHeight:[null],lifespanYears:[null]})}loadTreeType(t){this.treeTypeService.getTreeTypeById(t).subscribe({next:e=>{this.treeType=e,this.treeTypeForm.patchValue({name:e.name,scientificName:e.scientificName,description:e.description,co2AbsorptionAt20:e.co2AbsorptionAt20,co2AbsorptionAt25:e.co2AbsorptionAt25,co2AbsorptionAt30:e.co2AbsorptionAt30,co2AbsorptionAt35:e.co2AbsorptionAt35,co2AbsorptionAt40:e.co2AbsorptionAt40,typicalHeight:e.typicalHeight,lifespanYears:e.lifespanYears})},error:e=>{console.error("Error al cargar el tipo de \xE1rbol",e),this.snackBar.open("\u274C Error al cargar el tipo de \xE1rbol","Cerrar",{duration:3e3})}})}onTreeTypeFileSelected(t){let e=t.target;if(!e.files?.length)return;let p=e.files[0],u=new FileReader;u.onload=()=>this.previewImage=u.result,u.readAsDataURL(p),this.treeType?.id&&this.treeTypeService.updateTreeTypePicture(this.treeType.id,p).subscribe({next:T=>{this.treeType=T,this.snackBar.open("\u2705 Imagen actualizada","Cerrar",{duration:3e3})},error:T=>{console.error("Error al actualizar la imagen",T),this.snackBar.open("\u274C Error al actualizar la imagen","Cerrar",{duration:3e3})}})}onSubmitTreeType(){if(console.log("onSubmitTreeType"),this.treeTypeForm.invalid)return;let t=this.treeTypeForm.value;console.log("formValue",t),this.treeType?.id?this.treeTypeService.updateTreeType(this.treeType.id,t).subscribe({next:()=>{this.snackBar.open("\u2705 Tipo de \xE1rbol actualizado","Cerrar",{duration:3e3}),this.router.navigate(["/tree-type/",this.treeType.id])},error:e=>{console.error("Error al actualizar el tipo de \xE1rbol",e),this.snackBar.open("\u274C Error al actualizar el tipo de \xE1rbol","Cerrar",{duration:3e3})}}):this.treeTypeService.createTreeType(t).subscribe({next:()=>{this.snackBar.open("\u2705 Tipo de \xE1rbol creado","Cerrar",{duration:3e3}),this.router.navigate(["/admin/tree-types"])},error:e=>{console.error("Error al crear el tipo de \xE1rbol",e),this.snackBar.open("\u274C Error al crear el tipo de \xE1rbol","Cerrar",{duration:3e3})}})}cancel(){this.router.navigate(["/admin/tree-types"])}static{this.\u0275fac=function(e){return new(e||s)(E(Q),E(ee),E(L),E(M),E(Z))}}static{this.\u0275cmp=A({type:s,selectors:[["app-tree-types-form"]],standalone:!0,features:[B],decls:1,vars:1,consts:[["class","w-full max-w-full mx-auto bg-white p-6 rounded-2xl shadow-lg",4,"ngIf"],[1,"w-full","max-w-full","mx-auto","bg-white","p-6","rounded-2xl","shadow-lg"],[3,"ngSubmit","formGroup"],[1,"text-2xl","font-bold","mb-6","text-center"],[1,"flex","flex-col","items-center","mb-6"],[1,"w-24","h-24","rounded-full","shadow-lg","mb-2","object-cover",3,"src","alt"],[1,"cursor-pointer","bg-gray-200","hover:bg-gray-300","p-2","rounded-full","flex","items-center","gap-2"],[1,"material-icons"],["type","file","accept","image/*","hidden","",3,"change"],[1,"flex","flex-col","md:flex-row","gap-4","mb-6"],[1,"flex-1"],[1,"block","text-gray-700","font-medium","mb-1"],["type","text","formControlName","name","required","",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","transition",3,"placeholder"],["type","text","formControlName","scientificName",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","transition",3,"placeholder"],[1,"mb-6"],["formControlName","description",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","transition",3,"placeholder"],[1,"w-full","mb-6"],[1,"font-semibold","text-gray-700","mb-2"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-4","w-full"],[4,"ngFor","ngForOf"],["type","number","formControlName","typicalHeight","step","0.01",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","transition",3,"placeholder"],["type","number","formControlName","lifespanYears",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","transition",3,"placeholder"],[1,"flex","justify-end","gap-4","mt-6"],["type","button",1,"flex-1","bg-gray-300","text-gray-700","py-3","rounded-xl","hover:bg-gray-400","transition",3,"click"],["type","submit",1,"flex-1","bg-green-600","text-white","py-3","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition"],[1,"bg-white","shadow-md","rounded-lg","p-4","flex","flex-col","items-center","w-full"],[1,"font-semibold","text-gray-700","mb-1","text-center"],["type","number","step","0.01",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","transition",3,"formControlName","placeholder"]],template:function(e,p){e&1&&_(0,re,62,56,"div",0),e&2&&f("ngIf",p.treeType)},dependencies:[P,R,F,X,U,G,W,z,q,K,$,J,D,k,H,Y,V,O]})}}return s})();export{be as TreeTypesFormComponent};
