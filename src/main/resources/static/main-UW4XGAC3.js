import{a as vr,b as ji,c as xr,d as Er,e as Tr}from"./chunk-MYPSN4XL.js";import{a as or,b as ar,c as sr,d as ci}from"./chunk-KDF3HQL6.js";import{a as _r,b as di}from"./chunk-GBXYDTAZ.js";import{a as M,b as lr,c as ae}from"./chunk-SX3BAX22.js";import{a as mi}from"./chunk-5ZRNQWS5.js";import{a as yr,b as Ft,c as ze,d as pi,e as Bt,f as jt,g as Ut,h as Vt}from"./chunk-T7JQ6OOA.js";import{a as oe}from"./chunk-33AZJERS.js";import{a as ui}from"./chunk-3TRV4NIH.js";import{e as hr,g as gr}from"./chunk-VR2SS2MG.js";import{a as st}from"./chunk-ANM5QR2G.js";import{a as Me}from"./chunk-JN5OTYKR.js";import{a as Yt}from"./chunk-VUDJFFTR.js";import{a as dr}from"./chunk-I6AMTEEF.js";import{a as re,b as Q}from"./chunk-U3KJZSAD.js";import{a as ur,b as X}from"./chunk-LITGK74X.js";import{b as _e,d as Ce,f as ye,g as Pt,i as Ye,j as Nt,l as Ot,m as Rt,s as Dt,t as De,u as Lt}from"./chunk-T2CGB3F3.js";import{a as ee,b as J}from"./chunk-LGEN4PPC.js";import{$ as kn,A as An,Aa as de,Ab as Hn,Bb as Wn,Bc as pr,C as q,Ca as j,Cb as Qn,Db as Xn,E as Oe,Eb as Zn,Ec as cr,F as ri,Fa as T,Fb as Jn,H as we,Ha as _,Hb as Re,I as oi,Ia as jn,Ib as At,Ic as mr,J as P,Ja as Li,Jb as z,Jc as G,K as ai,Ka as te,Kb as Xe,Kc as Ze,L as Pn,La as Un,Lb as er,M as Nn,Mb as tr,Na as Vn,Nb as Z,Nc as fr,O as I,Oa as Yn,Ob as ir,Oc as Fi,P as w,Pb as ge,Q as On,Qb as U,R as Rn,Ra as Ue,Rb as L,Sa as d,Sb as nr,Ta as y,Tc as kt,Ua as g,Uc as Bi,V as qt,Va as W,Vc as li,W as Dn,Wa as zn,Xa as Gn,Y as Ln,Ya as Te,Z as Di,Za as Se,_a as be,a as St,aa as je,ab as N,b as Sn,ba as a,bb as ot,c as bn,ca as x,cb as me,db as It,eb as Kn,fa as Fn,fb as c,gb as u,h as Cn,hb as Y,i as In,ib as Ve,kb as qn,kc as ki,m as Kt,ma as E,n as ti,qa as f,qb as si,r as wn,ra as Bn,rc as rr,s as Ri,sa as ft,sb as at,t as ii,ta as bt,tb as ne,ua as Ct,ub as H,v as ni,wa as s,wb as $n,xa as l,xb as wt,ya as A,yb as Mt,z as Mn,za as le,zb as F}from"./chunk-P2JR76SF.js";var Sr=(()=>{class n{constructor(e){this.translate=e,e.addLangs(["en","es"]),e.setDefaultLang("es");let t=e.getBrowserLang();e.use(t?.match(/en|es/)?t:"es")}static{this.\u0275fac=function(t){return new(t||n)(x(ge))}}static{this.\u0275cmp=P({type:n,selectors:[["app-root"]],standalone:!0,features:[N],decls:2,vars:0,template:function(t,r){t&1&&A(0,"app-loading-spinner")(1,"router-outlet")},dependencies:[At,L,sr]})}}return n})();var fi=class{constructor(i,e="assets/i18n/",t=".json"){this.http=i,this.prefix=e,this.suffix=t}getTranslation(i){return this.http.get(`${this.prefix}${i}${this.suffix}`)}};function Ro(n,i){n&1&&(s(0,"div",12),d(1),c(2,"translate"),l()),n&2&&(a(),g(" ",u(2,1,"MENU.MENU")," "))}function Do(n,i){if(n&1&&(s(0,"span"),d(1),c(2,"translate"),l()),n&2){let e=_(2).$implicit;a(),g(" ",u(2,1,e.label)," ")}}function Lo(n,i){if(n&1&&(le(0),s(1,"a",13),A(2,"i"),E(3,Do,3,3,"span",9),l(),de()),n&2){let e=_().$implicit,t=_(2);a(),f("routerLink",e.route),a(),Ct("",e.icon," text-lg"),a(),f("ngIf",t.sidebarOpen)}}function ko(n,i){if(n&1&&(s(0,"a",18),A(1,"i"),d(2,"\xA0 "),s(3,"span"),d(4),c(5,"translate"),l()()),n&2){let e=_().$implicit;f("routerLink",e.route),a(),Ct("",e.icon," text-sm"),a(3),y(u(5,5,e.label))}}function Fo(n,i){if(n&1&&(le(0),E(1,ko,6,7,"a",17),de()),n&2){let e=i.$implicit,t=_(5);a(),f("ngIf",t.canShow(e))}}function Bo(n,i){if(n&1&&(s(0,"div")(1,"div",15),A(2,"i"),d(3),c(4,"translate"),l(),s(5,"div",16),E(6,Fo,2,1,"ng-container",6),l()()),n&2){let e=_(2).$implicit;a(2),bt(e.icon),a(),g(" ",u(4,5,e.label)," "),a(3),f("ngForOf",e.children)}}function jo(n,i){if(n&1&&(s(0,"a",23),A(1,"i"),l()),n&2){let e=_().$implicit;f("routerLink",e.route),a(),Ct("",e.icon," text-lg")}}function Uo(n,i){if(n&1&&(le(0),E(1,jo,2,4,"a",22),de()),n&2){let e=i.$implicit,t=_(5);a(),f("ngIf",t.canShow(e))}}function Vo(n,i){if(n&1&&(s(0,"div",19)(1,"div",20),A(2,"i"),l(),A(3,"div",21),E(4,Uo,2,1,"ng-container",6),l()),n&2){let e=_(2).$implicit;a(2),Ct("",e.icon," text-lg"),a(2),f("ngForOf",e.children)}}function Yo(n,i){if(n&1&&(le(0),E(1,Bo,7,7,"div",9)(2,Vo,5,4,"div",14),de()),n&2){let e=_(3);a(),f("ngIf",e.sidebarOpen),a(),f("ngIf",!e.sidebarOpen)}}function zo(n,i){if(n&1&&(le(0),E(1,Lo,4,5,"ng-container",9)(2,Yo,3,2,"ng-container",9),de()),n&2){let e=i.$implicit,t=_(2);a(),f("ngIf",!e.children&&t.canShow(e)),a(),f("ngIf",e.children&&t.canShow(e))}}function Go(n,i){n&1&&(s(0,"span"),d(1),c(2,"translate"),l()),n&2&&(a(),g(" ",u(2,1,"MENU.COLLAPSE")," "))}function Ko(n,i){if(n&1){let e=j();s(0,"button",24),T("click",function(){I(e);let r=_(2);return w(r.closeSidebar())}),l()}}function qo(n,i){if(n&1){let e=j();le(0),s(1,"a",28),T("click",function(){I(e);let r=_(4);return w(r.closeSidebar())}),A(2,"i"),d(3,"\xA0 "),s(4,"span"),d(5),c(6,"translate"),l()(),de()}if(n&2){let e=_().$implicit;a(),f("routerLink",e.route),a(),bt(e.icon),a(3),y(u(6,5,e.label))}}function $o(n,i){if(n&1){let e=j();s(0,"a",31),T("click",function(){I(e);let r=_(6);return w(r.closeSidebar())}),A(1,"i"),d(2,"\xA0 "),s(3,"span"),d(4),c(5,"translate"),l()()}if(n&2){let e=_().$implicit;f("routerLink",e.route),a(),Ct("",e.icon," text-sm"),a(3),y(u(5,5,e.label))}}function Ho(n,i){if(n&1&&(le(0),E(1,$o,6,7,"a",30),de()),n&2){let e=i.$implicit,t=_(5);a(),f("ngIf",t.canShow(e))}}function Wo(n,i){if(n&1&&(le(0),s(1,"div",29),A(2,"i"),d(3),c(4,"translate"),l(),s(5,"div",16),E(6,Ho,2,1,"ng-container",6),l(),de()),n&2){let e=_().$implicit;a(2),bt(e.icon),a(),g(" ",u(4,5,e.label)," "),a(3),f("ngForOf",e.children)}}function Qo(n,i){if(n&1&&(le(0),E(1,qo,7,7,"ng-container",9)(2,Wo,7,7,"ng-container",9),de()),n&2){let e=i.$implicit,t=_(3);a(),f("ngIf",!e.children&&t.canShow(e)),a(),f("ngIf",e.children&&t.canShow(e))}}function Xo(n,i){if(n&1&&(s(0,"aside",25)(1,"div",26),d(2),c(3,"translate"),l(),s(4,"div",27)(5,"nav",5),E(6,Qo,3,2,"ng-container",6),l()()()),n&2){let e=_(2);a(2),g(" ",u(3,2,"MENU.MENU")," "),a(4),f("ngForOf",e.menuLinks)}}function Zo(n,i){if(n&1){let e=j();le(0),s(1,"aside",2),E(2,Ro,3,3,"div",3),s(3,"div",4)(4,"nav",5),E(5,zo,3,2,"ng-container",6),l()(),s(6,"div",7)(7,"button",8),T("click",function(){I(e);let r=_();return w(r.onToggleSidebar())}),s(8,"mat-icon"),d(9),l(),E(10,Go,3,3,"span",9),l()()(),E(11,Ko,1,0,"button",10)(12,Xo,7,4,"aside",11),de()}if(n&2){let e=_();a(),ft("w-64",e.sidebarOpen)("w-16",!e.sidebarOpen),a(),f("ngIf",e.sidebarOpen),a(3),f("ngForOf",e.menuLinks),a(4),g(" ",e.sidebarOpen?"chevron_left":"chevron_right"," "),a(),f("ngIf",e.sidebarOpen),a(),f("ngIf",e.sidebarOpen),a(),f("ngIf",e.sidebarOpen)}}function Jo(n,i){n&1&&(s(0,"aside",32)(1,"div",26),d(2),c(3,"translate"),l(),s(4,"nav",5)(5,"a",33),d(6),c(7,"translate"),l(),s(8,"a",34),d(9),c(10,"translate"),l()()()),n&2&&(a(2),g(" ",u(3,3,"MENU.MENU")," "),a(4),g(" ",u(7,5,"MENU.LOGIN")," "),a(3),g(" ",u(10,7,"MENU.REGISTER")," "))}var br=(()=>{class n{constructor(e){this.userService=e,this.sidebarOpen=!1,this.sidebarOpenChange=new qt,this.menuLinks=[{label:"MENU.HOME",route:"home",icon:"fa-solid fa-house"},{label:"MENU.PROFILE",route:"profile",icon:"fa-solid fa-user"},{label:"MENU.MY_COMPANY",route:"company",roles:[M.COMPANY_ADMIN,M.COMPANY_USER],icon:"fa-solid fa-building"},{label:"MENU.MY_TREES",route:"my-trees",roles:[M.USER],icon:"fa-solid fa-tree"},{label:"MENU.ADMIN.LANDS",route:"/land/1",roles:[M.USER],icon:"fa-solid fa-tree-city"},{label:"MENU.MY_COMPANY_TREES",route:"my-trees",roles:[M.COMPANY_ADMIN,M.COMPANY_USER],icon:"fa-solid fa-seedling"},{label:"MENU.ADMIN.ADMIN",roles:[M.ADMIN,M.COMPANY_ADMIN],icon:"fa-solid fa-gear",children:[{label:"MENU.ADMIN.USERS",route:"admin/users",roles:[M.ADMIN,M.COMPANY_ADMIN],icon:"fa-solid fa-users"},{label:"MENU.ADMIN.COMPANIES",route:"admin/companies",roles:[M.ADMIN],icon:"fa-solid fa-building"},{label:"MENU.ADMIN.LANDS",route:"admin/lands",roles:[M.ADMIN],icon:"fa-solid fa-tree-city"},{label:"MENU.ADMIN.TREE_TYPES",route:"admin/tree-types",roles:[M.ADMIN],icon:"fa-solid fa-leaf"},{label:"MENU.ADMIN.PLANNED_PLANTATIONS",route:"admin/planned-plantations",roles:[M.ADMIN],icon:"fa-solid fa-seedling"}]}]}closeSidebar(){this.sidebarOpen=!1,this.sidebarOpenChange.emit(this.sidebarOpen)}canShow(e){if(!e.roles)return!0;let t=this.userService.getCurrentUser();return!!t&&e.roles.includes(t.role)}get userLinks(){return this.menuLinks.filter(e=>!e.children)}get adminLinks(){return this.menuLinks.filter(e=>e.children&&this.canShow(e))}onToggleSidebar(){this.sidebarOpen=!this.sidebarOpen,this.sidebarOpenChange.emit(this.sidebarOpen)}static{this.\u0275fac=function(t){return new(t||n)(x(ae))}}static{this.\u0275cmp=P({type:n,selectors:[["app-sidebar"]],inputs:{sidebarOpen:"sidebarOpen"},outputs:{sidebarOpenChange:"sidebarOpenChange"},standalone:!0,features:[N],decls:3,vars:2,consts:[["loggedOutLinks",""],[4,"ngIf","ngIfElse"],[1,"hidden","md:flex","flex-col","h-screen","bg-white","shadow-md","transition-all","duration-300","overflow-hidden"],["class","p-4 text-xl font-bold border-b whitespace-nowrap",4,"ngIf"],[1,"flex-1"],[1,"p-4","space-y-2"],[4,"ngFor","ngForOf"],[1,"border-t","p-3","flex","justify-center"],[1,"flex","items-center","gap-2","text-sm","text-gray-600","hover:text-gray-900",3,"click"],[4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden","aria-label","Cerrar men\xFA",3,"click",4,"ngIf"],["class",`fixed inset-y-0 left-0 w-64 bg-white shadow-md z-50
           md:hidden flex flex-col h-full`,4,"ngIf"],[1,"p-4","text-xl","font-bold","border-b","whitespace-nowrap"],[1,"flex","items-center","gap-3","px-3","py-2","rounded","hover:bg-gray-200","justify-center","md:justify-start",3,"routerLink"],["class","flex flex-col items-center space-y-2 mt-4",4,"ngIf"],[1,"px-3","py-2","font-semibold","text-gray-700","flex","items-center","gap-3"],[1,"ml-4","space-y-1"],["class","flex items-center gap-2 px-3 py-1 rounded hover:bg-gray-100",3,"routerLink",4,"ngIf"],[1,"flex","items-center","gap-2","px-3","py-1","rounded","hover:bg-gray-100",3,"routerLink"],[1,"flex","flex-col","items-center","space-y-2","mt-4"],[1,"w-10","h-10","flex","items-center","justify-center","rounded-full","bg-gray-200","text-gray-700"],[1,"w-6","border-t","border-gray-300","my-1"],["class","w-10 h-10 flex items-center justify-center rounded hover:bg-gray-200",3,"routerLink",4,"ngIf"],[1,"w-10","h-10","flex","items-center","justify-center","rounded","hover:bg-gray-200",3,"routerLink"],["aria-label","Cerrar men\xFA",1,"fixed","inset-0","bg-black","bg-opacity-50","z-40","md:hidden",3,"click"],[1,"fixed","inset-y-0","left-0","w-64","bg-white","shadow-md","z-50","md:hidden","flex","flex-col","h-full"],[1,"p-4","text-xl","font-bold","border-b"],[1,"flex-1","overflow-auto"],[1,"flex","items-center","gap-2","px-3","py-2","rounded","hover:bg-gray-200",3,"click","routerLink"],[1,"px-3","py-2","font-semibold","text-gray-700","flex","items-center","gap-2"],["class","flex items-center gap-2 px-3 py-1 rounded hover:bg-gray-100",3,"routerLink","click",4,"ngIf"],[1,"flex","items-center","gap-2","px-3","py-1","rounded","hover:bg-gray-100",3,"click","routerLink"],[1,"hidden","md:flex","w-64","bg-white","shadow-md","flex-col","h-screen"],["routerLink","login",1,"block","px-3","py-2","rounded","hover:bg-gray-200"],["routerLink","register",1,"block","px-3","py-2","rounded","hover:bg-gray-200"]],template:function(t,r){if(t&1&&E(0,Zo,13,10,"ng-container",1)(1,Jo,11,9,"ng-template",null,0,Ve),t&2){let o=Ue(2);f("ngIf",r.userService.getCurrentUser())("ngIfElse",o)}},dependencies:[L,U,F,ne,H,Z,Xe,Q,re],styles:['@charset "UTF-8";aside[_ngcontent-%COMP%]{background-color:#fff}aside[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{transition:background-color .2s;display:block;border-radius:.375rem;padding:.5rem .75rem}aside[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#e5e7eb}']})}}return n})();function ea(n,i){if(n&1&&(le(0),s(1,"div",12),A(2,"img",13),s(3,"span",14),d(4),l()(),de()),n&2){let e=i.ngIf;a(2),f("src",e.picture||"assets/default-avatar.png",je),a(2),W(" ",e.name," ",e.surname," ")}}var Cr=(()=>{class n{constructor(e,t,r){this.translate=e,this.authService=t,this.router=r,this.selectedLang="es",this.selectedLangChange=new qt,this.toggleSidebar=new qt,this.currentUser$=this.authService.user$}switchLanguage(e){this.selectedLang=e,this.selectedLangChange.emit(e),this.translate.use(e)}onToggleSidebar(){this.toggleSidebar.emit()}logout(){this.authService.logout(),this.router.navigate(["/login"])}static{this.\u0275fac=function(t){return new(t||n)(x(ge),x(oe),x(z))}}static{this.\u0275cmp=P({type:n,selectors:[["app-header"]],inputs:{selectedLang:"selectedLang"},outputs:{selectedLangChange:"selectedLangChange",toggleSidebar:"toggleSidebar"},standalone:!0,features:[N],decls:19,vars:10,consts:[[1,"flex","flex-col","md:flex-row","md:items-center","md:justify-between","bg-gradient-to-r","from-teal-500","to-green-500","text-white","p-4","shadow-md"],[1,"flex","justify-center","md:justify-start","mb-3","md:mb-0"],["src","assets/logo-forestplus.png","alt","forest+ Logo",1,"logo"],[1,"flex","items-center","justify-between","md:justify-end","space-x-4","w-full","md:w-auto"],[1,"md:hidden",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],[4,"ngIf"],[1,"flex","items-center","gap-1","bg-red-600","text-white","py-1","px-3","rounded","hover:bg-red-700","transition","font-semibold","text-sm",3,"click"],[1,"text-base"],[1,"language-switcher","flex","gap-1"],[3,"click"],[1,"flex","items-center","gap-2"],["alt","Usuario",1,"h-8","w-8","rounded-full","border","border-white",3,"src"],[1,"font-medium","hidden","sm:inline"]],template:function(t,r){t&1&&(s(0,"header",0)(1,"div",1),A(2,"img",2),l(),s(3,"div",3)(4,"button",4),T("click",function(){return r.onToggleSidebar()}),On(),s(5,"svg",5),A(6,"path",6),l()(),E(7,ea,5,3,"ng-container",7),c(8,"async"),Rn(),s(9,"button",8),T("click",function(){return r.logout()}),d(10),c(11,"translate"),s(12,"mat-icon",9),d(13,"logout"),l()(),s(14,"div",10)(15,"button",11),T("click",function(){return r.switchLanguage("es")}),d(16," ES "),l(),s(17,"button",11),T("click",function(){return r.switchLanguage("en")}),d(18," EN "),l()()()()),t&2&&(a(7),f("ngIf",u(8,6,r.currentUser$)),a(3),g(" ",u(11,8,"DASHBOARD.LOGOUT")," "),a(5),ft("active",r.selectedLang==="es"),a(2),ft("active",r.selectedLang==="en"))},dependencies:[L,U,Q,re,F,H,$n],styles:[".language-switcher[_ngcontent-%COMP%]{display:flex;gap:.5rem}.language-switcher[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;color:#fff;padding:.2rem .5rem;border-radius:3px;font-size:.75rem;font-weight:500;transition:all .2s}.language-switcher[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#ffffff4d}.language-switcher[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#fff3;font-weight:700}.logo[_ngcontent-%COMP%]{height:40px;max-height:40px;width:auto;flex-shrink:0}"]})}}return n})();var Ir=(()=>{class n{constructor(){this.sidebarOpen=!1,this.selectedLang="es"}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=P({type:n,selectors:[["app-dashboard"]],standalone:!0,features:[N],decls:6,vars:2,consts:[[1,"flex","min-h-screen","bg-gray-100"],[3,"sidebarOpenChange","sidebarOpen"],[1,"flex-1","flex","flex-col"],[3,"selectedLangChange","toggleSidebar","selectedLang"],[1,"p-6","flex-1","overflow-auto"]],template:function(t,r){t&1&&(s(0,"div",0)(1,"app-sidebar",1),be("sidebarOpenChange",function(p){return Se(r.sidebarOpen,p)||(r.sidebarOpen=p),p}),l(),s(2,"div",2)(3,"app-header",3),be("selectedLangChange",function(p){return Se(r.selectedLang,p)||(r.selectedLang=p),p}),T("toggleSidebar",function(){return r.sidebarOpen=!r.sidebarOpen}),l(),s(4,"main",4),A(5,"router-outlet"),l()()()),t&2&&(a(),Te("sidebarOpen",r.sidebarOpen),a(2),Te("selectedLang",r.selectedLang))},dependencies:[F,Z,At,L,br,Cr],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100vh}.sidenav[_ngcontent-%COMP%]{width:220px}.content[_ngcontent-%COMP%]{padding:16px}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}.dashboard-card[_ngcontent-%COMP%]{text-align:center}.language-switcher[_ngcontent-%COMP%]{display:flex;gap:.5rem}.language-switcher[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;color:#fff;padding:.2rem .5rem;border-radius:3px;font-size:.75rem;font-weight:500;transition:all .2s}.language-switcher[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#ffffff4d}.language-switcher[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#fff3;color:#fff;font-weight:700}"]})}}return n})();var wr=(()=>{class n{constructor(e){this.dashboardController=e,this.homeKpisSubject=new In(null)}getHomeKpis(){return this.homeKpisSubject.asObservable()}getCurrentHomeKpis(){return this.homeKpisSubject.value}loadHomeKpis(){return this.dashboardController.getHomeKpis().pipe(ti(e=>(this.homeKpisSubject.next(e),e)))}clearHomeKpis(){this.homeKpisSubject.next(null)}static{this.\u0275fac=function(t){return new(t||n)(we(pr))}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var na=n=>({count:n}),$t=n=>({value:n});function ra(n,i){if(n&1&&(s(0,"span"),d(1),l()),n&2){let e=_();a(),g(", ",e.userName,"")}}function oa(n,i){n&1&&(s(0,"span"),d(1," Admin"),l())}function aa(n,i){if(n&1&&(s(0,"div",6),d(1),c(2,"translate"),l()),n&2){let e=_();a(),g(" ",Y(2,1,"HOME.PENDING_TREES_WARNING",me(4,na,e.homeKpis==null?null:e.homeKpis.pendingTreesCount))," ")}}function sa(n,i){if(n&1&&(s(0,"span"),d(1),c(2,"translate"),l()),n&2){let e=_(4);a(),g(" ",Y(2,1,"HOME.ENVIRONMENTAL_IMPACT.HOMES",me(4,$t,e.homes))," ")}}function la(n,i){if(n&1&&(s(0,"span"),d(1),c(2,"number"),c(3,"translate"),l()),n&2){let e=_(4);a(),g(" ",Y(3,4,"HOME.ENVIRONMENTAL_IMPACT.HOME_PERCENT",me(7,$t,Y(2,1,e.homes*100,"1.0-0")))," ")}}function da(n,i){if(n&1&&(s(0,"div",21)(1,"p",22),d(2),c(3,"translate"),l(),s(4,"p",23),d(5),c(6,"translate"),l(),s(7,"p",24),d(8),c(9,"translate"),l(),s(10,"ul",25)(11,"li",26)(12,"span"),d(13,"\u{1F697}"),l(),s(14,"span"),d(15),c(16,"translate"),l()(),s(17,"li",26)(18,"span"),d(19,"\u2708\uFE0F"),l(),s(20,"span"),d(21),c(22,"translate"),l()(),s(23,"li",26)(24,"span"),d(25,"\u{1F3E0}"),l(),E(26,sa,3,6,"span",2)(27,la,4,9,"span",2),l()()()),n&2){let e=_(3);a(2),g(" ",u(3,7,"HOME.ENVIRONMENTAL_IMPACT.TITLE")," "),a(3),g(" ",Y(6,9,"HOME.ENVIRONMENTAL_IMPACT.VALUE",me(20,$t,e.homeKpis==null?null:e.homeKpis.annualCo2Compensated))," "),a(3),g(" ",u(9,12,"HOME.ENVIRONMENTAL_IMPACT.INTRO")," "),a(7),y(Y(16,14,"HOME.ENVIRONMENTAL_IMPACT.CAR",me(22,$t,e.carKm))),a(6),y(Y(22,17,"HOME.ENVIRONMENTAL_IMPACT.PLANE",me(24,$t,e.planeKm))),a(5),f("ngIf",e.homes>=1),a(),f("ngIf",e.homes<1)}}function pa(n,i){if(n&1){let e=j();s(0,"div",11)(1,"div",12)(2,"div",13),A(3,"i",14),l(),s(4,"div",15)(5,"span",16),d(6),l(),s(7,"p",17),d(8),c(9,"translate"),l()()(),E(10,da,28,26,"div",18),s(11,"div",19)(12,"button",20),T("click",function(){I(e);let r=_(2);return w(r.buyNewTree())}),s(13,"mat-icon"),d(14,"add"),l(),d(15),c(16,"translate"),l()()()}if(n&2){let e,t=_(2);a(6),y(t.homeKpis==null?null:t.homeKpis.plantedTrees),a(2),g(" ",u(9,4,"HOME.PLANTED_TREES")," "),a(2),f("ngIf",((e=t.homeKpis==null?null:t.homeKpis.annualCo2Compensated)!==null&&e!==void 0?e:0)>0),a(5),g(" ",u(16,6,"MY_TREES.ADD_NEW_TREE")," ")}}function ca(n,i){n&1&&(s(0,"div",27)(1,"p",28),d(2),c(3,"translate"),l(),s(4,"p",29),d(5),c(6,"translate"),l(),s(7,"a",30),d(8),c(9,"translate"),l()()),n&2&&(a(2),g(" ",u(3,3,"HOME.NO_TREES.TITLE")," "),a(3),g(" ",u(6,5,"HOME.NO_TREES.DESCRIPTION")," "),a(3),g(" ",u(9,7,"HOME.NO_TREES.CTA")," "))}function ma(n,i){if(n&1&&(s(0,"div",33)(1,"h2",34),d(2),c(3,"translate"),l(),s(4,"p",22),d(5),l(),s(6,"p",35),d(7),l(),s(8,"p",36),d(9),c(10,"translate"),l(),s(11,"div",37),A(12,"div",38),l(),s(13,"p",39),d(14),c(15,"number"),l()()),n&2){let e,t,r,o=i.$implicit;a(2),g(" ",u(3,8,"HOME.NEXT_PLANTATION")," "),a(3),g(" ",o.plantationName," "),a(2),W(" ",(e=o.soldTrees)!==null&&e!==void 0?e:0," / ",(e=o.minTrees)!==null&&e!==void 0?e:0," "),a(2),g(" ",u(10,10,"HOME.PLANTED_TREES")," "),a(3),Bn("width",((t=o.soldTrees)!==null&&t!==void 0?t:0)/((t=o.minTrees)!==null&&t!==void 0?t:1)*100,"%"),a(2),g(" ",Y(15,12,((r=o.soldTrees)!==null&&r!==void 0?r:0)/((r=o.minTrees)!==null&&r!==void 0?r:1)*100,"1.0-0"),"% ")}}function ua(n,i){if(n&1&&(s(0,"div",31),E(1,ma,16,15,"div",32),l()),n&2){let e=_(2);a(),f("ngForOf",e.homeKpis==null?null:e.homeKpis.plannedPlantations)}}function fa(n,i){if(n&1&&(s(0,"section",7),E(1,pa,17,8,"div",8)(2,ca,10,9,"div",9)(3,ua,2,1,"div",10),l()),n&2){let e=_();a(),f("ngIf",(e.homeKpis==null?null:e.homeKpis.plantedTrees)>0),a(),f("ngIf",(e.homeKpis==null?null:e.homeKpis.plantedTrees)===0&&!(e.homeKpis!=null&&e.homeKpis.pendingTreesCount)),a(),f("ngIf",e.homeKpis==null||e.homeKpis.plannedPlantations==null?null:e.homeKpis.plannedPlantations.length)}}var Mr=(()=>{class n{constructor(e,t,r,o){this.userService=e,this.dashboardService=t,this.authService=r,this.router=o,this.userName="",this.isAdmin=!1,this.CO2_EQUIVALENCES={CAR_KG_PER_KM:.12,PLANE_KG_PER_KM:.1,HOME_YEAR_KG:1800}}checkRole(){let e=this.authService.currentUserRole;this.isAdmin=e==="ADMIN"}calculateEquivalences(){let e=this.homeKpis?.annualCo2Compensated??0;this.carKm=Math.round(e/this.CO2_EQUIVALENCES.CAR_KG_PER_KM),this.planeKm=Math.round(e/this.CO2_EQUIVALENCES.PLANE_KG_PER_KM),this.homes=+(e/this.CO2_EQUIVALENCES.HOME_YEAR_KG).toFixed(1)}buyNewTree(){this.router.navigate(["/buy-tree"])}ngOnInit(){this.userService.user$.pipe(wn(e=>e!==null),ii(1)).subscribe(e=>{this.userName=e.name,this.checkRole(),this.dashboardService.loadHomeKpis().subscribe(t=>{this.homeKpis=t,this.calculateEquivalences()})})}static{this.\u0275fac=function(t){return new(t||n)(x(ae),x(wr),x(oe),x(z))}}static{this.\u0275cmp=P({type:n,selectors:[["app-home"]],standalone:!0,features:[N],decls:10,vars:10,consts:[[1,"home-presentation","p-8","max-w-5xl","mx-auto","text-center","space-y-6"],[1,"text-4xl","font-extrabold","text-green-800"],[4,"ngIf"],["class","mb-4 p-4 rounded-xl bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800",4,"ngIf"],[1,"text-lg","text-gray-700","leading-relaxed",3,"innerHTML"],["class","planted-trees p-8 max-w-5xl mx-auto",4,"ngIf"],[1,"mb-4","p-4","rounded-xl","bg-yellow-100","border-l-4","border-yellow-500","text-yellow-800"],[1,"planted-trees","p-8","max-w-5xl","mx-auto"],["class","grid grid-cols-1 md:grid-cols-4 gap-6",4,"ngIf"],["class","bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded-lg flex flex-col items-center text-center space-y-4 mt-6",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-4 gap-6 mt-8",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6"],[1,"bg-white","shadow-md","rounded-xl","p-6","flex","items-center","space-x-4"],[1,"flex-shrink-0"],[1,"fas","fa-tree","text-green-500","text-4xl"],[1,"flex","flex-col"],[1,"text-3xl","font-extrabold","text-gray-800"],[1,"text-green-600","font-medium","mt-1"],["class","md:col-span-3 bg-white rounded-xl shadow-md p-6",4,"ngIf"],[1,"md:col-span-4","flex","justify-end","mb-4"],[1,"flex","items-center","gap-2","bg-green-600","text-white","py-3","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click"],[1,"md:col-span-3","bg-white","rounded-xl","shadow-md","p-6"],[1,"text-sm","text-gray-500","mb-1"],[1,"text-3xl","font-bold","text-green-700","mb-2"],[1,"text-sm","text-gray-600","mb-4"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-3","text-sm","text-gray-700"],[1,"flex","items-center","gap-2"],[1,"bg-yellow-50","border-l-4","border-yellow-400","p-6","rounded-lg","flex","flex-col","items-center","text-center","space-y-4","mt-6"],[1,"text-yellow-700","font-semibold","text-lg"],[1,"text-yellow-600"],["href","/#/buy-tree",1,"bg-green-500","hover:bg-green-600","text-white","font-bold","py-2","px-6","rounded-lg","transition","duration-300"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mt-8"],["class","md:col-span-4 bg-white rounded-2xl shadow p-6",4,"ngFor","ngForOf"],[1,"md:col-span-4","bg-white","rounded-2xl","shadow","p-6"],[1,"text-xl","font-bold","text-gray-700","mb-4"],[1,"text-3xl","font-bold","text-green-700"],[1,"text-sm","text-gray-500","mb-3"],[1,"w-full","bg-gray-200","rounded-full","h-3","overflow-hidden"],[1,"bg-green-500","h-3","rounded-full","transition-all","duration-500"],[1,"text-xs","text-gray-500","mt-2","text-right"]],template:function(t,r){t&1&&(s(0,"section",0)(1,"h1",1),d(2),c(3,"translate"),E(4,ra,2,1,"span",2)(5,oa,2,0,"span",2),l(),E(6,aa,3,6,"div",3),A(7,"p",4),c(8,"translate"),l(),E(9,fa,4,3,"section",5)),t&2&&(a(2),g(" ",u(3,6,"HOME.TITLE")," "),a(2),f("ngIf",r.userName),a(),f("ngIf",r.isAdmin),a(),f("ngIf",(r.homeKpis==null?null:r.homeKpis.pendingTreesCount)>0),a(),f("innerHTML",u(8,8,"HOME.LINES"),kn),a(2),f("ngIf",!r.isAdmin))},dependencies:[F,ne,H,Mt,L,U,Q,re]})}}return n})();function ha(n,i){if(n&1&&(s(0,"p",15),d(1),c(2,"translate"),l()),n&2){let e=_(2);a(),W(" ",u(2,2,"PROFILE.COMPANY_LABEL"),": ",e.user.company==null?null:e.user.company.name," ")}}function ga(n,i){if(n&1&&(s(0,"li",17)(1,"span"),d(2),l(),s(3,"span",18),d(4),l()()),n&2){let e=i.$implicit;a(2),y(e.treeTypeName),a(2),y(e.quantity)}}function _a(n,i){if(n&1&&(s(0,"ul"),E(1,ga,5,2,"li",16),l()),n&2){let e=_(2);a(),f("ngForOf",e.plantedTrees)}}function ya(n,i){n&1&&(s(0,"p",19),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"LANDS.NO_PLANTED_TREES_BY_USER")))}function va(n,i){if(n&1){let e=j();s(0,"div",2)(1,"mat-card",3)(2,"div",4),A(3,"img",5),c(4,"translate"),s(5,"h2",6),d(6),l(),s(7,"p",7),d(8),l(),E(9,ha,3,4,"p",8),s(10,"div",9)(11,"button",10),T("click",function(){I(e);let r=_();return w(r.goToEdit())}),d(12),c(13,"translate"),l()()(),s(14,"div",11)(15,"div",12)(16,"p",13),d(17),c(18,"translate"),l()(),E(19,_a,2,1,"ul",14)(20,ya,3,3,"ng-template",null,0,Ve),l()()()}if(n&2){let e=Ue(21),t=_();a(3),f("src",t.user.picture||"assets/logo-white.png",je)("alt",u(4,11,"PROFILE.AVATAR_ALT")),a(3),zn(" ",t.user.name," ",t.user.surname," ",t.user.secondSurname," "),a(2),y(t.user.email),a(),f("ngIf",t.user.role==="COMPANY_ADMIN"||t.user.role==="COMPANY_USER"),a(3),g(" ",u(13,13,"PROFILE.EDIT_BUTTON")," "),a(5),y(u(18,15,"LANDS.PLANTED_TREES_BY_USER")),a(2),f("ngIf",t.plantedTrees==null?null:t.plantedTrees.length)("ngIfElse",e)}}var Vi=(()=>{class n{constructor(e,t,r,o,p){this.authService=e,this.userService=t,this.router=r,this.route=o,this.treeService=p,this.plantedTrees=[],this.isAdmin=!1,this.destroy$=new Cn}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e?this.userService.getUserById(+e).subscribe({next:t=>{this.user=t,this.checkRole(),this.loadUserTrees(t.id)},error:t=>{console.error("Error al cargar usuario por id",t)}}):this.authService.user$.pipe(An(this.destroy$)).subscribe(t=>{t&&(this.user=t,this.checkRole(),this.loadUserTrees(t.id))})}goToEdit(){this.user?.id&&this.router.navigate([`profile/edit/${this.user.id}`])}loadUserTrees(e){this.treeService.getTreesByOwner(e).subscribe({next:t=>this.plantedTrees=t,error:t=>console.error("Error al cargar \xE1rboles",t)})}checkRole(){let e=this.authService.currentUserRole;this.isAdmin=e==="ADMIN"}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(t){return new(t||n)(x(oe),x(ae),x(z),x(Re),x(st))}}static{this.\u0275cmp=P({type:n,selectors:[["app-profile"]],standalone:!0,features:[N],decls:1,vars:1,consts:[["noPlantedTrees",""],["class","w-full max-w-full mx-auto",4,"ngIf"],[1,"w-full","max-w-full","mx-auto"],[1,"rounded-2xl","shadow-md","p-6","md:p-8"],[1,"flex","flex-col","items-center","text-center"],[1,"w-24","h-24","rounded-full","shadow-lg","mb-4","object-cover",3,"src","alt"],[1,"text-xl","md:text-2xl","font-semibold"],[1,"text-gray-500"],["class","text-gray-500 font-medium mt-1",4,"ngIf"],[1,"flex","gap-4","mt-4","w-full","justify-center","md:justify-start"],[1,"flex-1","md:flex-auto","bg-green-600","text-white","py-3","px-6","rounded-xl","hover:bg-green-700","transition",3,"click"],[1,"mt-4","w-full","text-left"],[1,"flex","justify-between","items-center","mb-2"],[1,"font-semibold","text-gray-700"],[4,"ngIf","ngIfElse"],[1,"text-gray-500","font-medium","mt-1"],["class","flex justify-between border-b py-1",4,"ngFor","ngForOf"],[1,"flex","justify-between","border-b","py-1"],[1,"font-semibold"],[1,"text-gray-500","italic"]],template:function(t,r){t&1&&E(0,va,22,17,"div",1),t&2&&f("ngIf",r.user)},dependencies:[F,ne,H,L,U,J,ee,X,Q]})}}return n})();var Ar=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=P({type:n,selectors:[["app-settings"]],standalone:!0,features:[N],decls:2,vars:0,template:function(t,r){t&1&&(s(0,"p"),d(1,"settings works!"),l())}})}}return n})();var xa=()=>["../login"],Ea=()=>({length:6});function Ta(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"REGISTER.NAME_REQUIRED")))}function Sa(n,i){if(n&1&&(s(0,"div",23),E(1,Ta,3,3,"div",24),l()),n&2){let e,t=_(2);a(),f("ngIf",(e=t.registerForm.get("name"))==null?null:e.hasError("required"))}}function ba(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"REGISTER.SURNAME_REQUIRED")))}function Ca(n,i){if(n&1&&(s(0,"div",23),E(1,ba,3,3,"div",24),l()),n&2){let e,t=_(2);a(),f("ngIf",(e=t.registerForm.get("surname"))==null?null:e.hasError("required"))}}function Ia(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"REGISTER.EMAIL_REQUIRED")))}function wa(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"REGISTER.EMAIL_INVALID")))}function Ma(n,i){if(n&1&&(s(0,"div",23),E(1,Ia,3,3,"div",24)(2,wa,3,3,"div",24),l()),n&2){let e,t,r=_(2);a(),f("ngIf",(e=r.registerForm.get("email"))==null?null:e.hasError("required")),a(),f("ngIf",(t=r.registerForm.get("email"))==null?null:t.hasError("email"))}}function Aa(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"REGISTER.PASSWORD_REQUIRED")))}function Pa(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(Y(2,1,"REGISTER.PASSWORD_MINLENGTH",ot(4,Ea))))}function Na(n,i){if(n&1&&(s(0,"div",23),E(1,Aa,3,3,"div",24)(2,Pa,3,5,"div",24),l()),n&2){let e,t,r=_(2);a(),f("ngIf",(e=r.registerForm.get("password"))==null?null:e.hasError("required")),a(),f("ngIf",(t=r.registerForm.get("password"))==null?null:t.hasError("minlength"))}}function Oa(n,i){if(n&1){let e=j();s(0,"form",10),T("ngSubmit",function(){I(e);let r=_();return w(r.onSubmit())}),s(1,"div",11)(2,"label",12),d(3),c(4,"translate"),l(),A(5,"input",13),c(6,"translate"),E(7,Sa,2,1,"div",14),l(),s(8,"div")(9,"label",12),d(10),c(11,"translate"),l(),A(12,"input",15),c(13,"translate"),E(14,Ca,2,1,"div",14),l(),s(15,"div")(16,"label",12),d(17),c(18,"translate"),l(),A(19,"input",16),c(20,"translate"),l(),s(21,"div",11)(22,"label",12),d(23),c(24,"translate"),l(),A(25,"input",17),c(26,"translate"),E(27,Ma,3,2,"div",14),l(),s(28,"div",18)(29,"label",12),d(30),c(31,"translate"),l(),A(32,"input",19),c(33,"translate"),s(34,"button",20),T("click",function(){I(e);let r=_();return w(r.hidePassword=!r.hidePassword)}),d(35),l(),E(36,Na,3,2,"div",14),l(),s(37,"div",21)(38,"button",22),d(39),c(40,"translate"),l()()()}if(n&2){let e,t,r,o,p=_();f("formGroup",p.registerForm),a(3),y(u(4,19,"REGISTER.NAME")),a(2),te("placeholder",u(6,21,"REGISTER.NAME_PLACEHOLDER")),a(2),f("ngIf",((e=p.registerForm.get("name"))==null?null:e.invalid)&&((e=p.registerForm.get("name"))==null?null:e.touched)),a(3),y(u(11,23,"REGISTER.SURNAME")),a(2),te("placeholder",u(13,25,"REGISTER.SURNAME_PLACEHOLDER")),a(2),f("ngIf",((t=p.registerForm.get("surname"))==null?null:t.invalid)&&((t=p.registerForm.get("surname"))==null?null:t.touched)),a(3),y(u(18,27,"REGISTER.SECOND_SURNAME")),a(2),te("placeholder",u(20,29,"REGISTER.SECOND_SURNAME_PLACEHOLDER")),a(4),y(u(24,31,"REGISTER.EMAIL")),a(2),te("placeholder",u(26,33,"REGISTER.EMAIL_PLACEHOLDER")),a(2),f("ngIf",((r=p.registerForm.get("email"))==null?null:r.invalid)&&((r=p.registerForm.get("email"))==null?null:r.touched)),a(3),y(u(31,35,"REGISTER.PASSWORD")),a(2),te("placeholder",u(33,37,"REGISTER.PASSWORD_PLACEHOLDER")),f("type",p.hidePassword?"password":"text"),a(3),g(" ",p.hidePassword?"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F":"\u{1F441}\uFE0F"," "),a(),f("ngIf",((o=p.registerForm.get("password"))==null?null:o.invalid)&&((o=p.registerForm.get("password"))==null?null:o.touched)),a(2),f("disabled",p.registerForm.invalid),a(),g(" ",u(40,39,"REGISTER.BUTTON")," ")}}function Ra(n,i){n&1&&(s(0,"div",25),d(1),c(2,"translate"),l()),n&2&&(a(),g(" ",u(2,1,"REGISTER.SUCCESS")," "))}function Da(n,i){if(n&1&&(s(0,"div",26),d(1),l()),n&2){let e=_();a(),g(" ",e.registerError," ")}}var Pr=(()=>{class n{constructor(e,t){this.fb=e,this.authService=t,this.hidePassword=!0,this.registerError="",this.registerSuccess=!1,this.roles=lr,this.registerForm=this.fb.group({name:["",Ce.required],surname:[""],secondSurname:[""],email:["",[Ce.required,Ce.email]],password:["",[Ce.required,Ce.minLength(6)]],role:[M.USER]})}onSubmit(){this.registerForm.invalid||(this.registerError="",this.registerSuccess=!1,this.authService.register(this.registerForm.value).subscribe({next:()=>{this.registerSuccess=!0,this.registerForm.reset()},error:e=>this.registerError=e.error?.message||"Error al registrarse"}))}static{this.\u0275fac=function(t){return new(t||n)(x(Dt),x(oe))}}static{this.\u0275cmp=P({type:n,selectors:[["app-register"]],standalone:!0,features:[N],decls:16,vars:14,consts:[[1,"flex","flex-col","items-center","justify-start","min-h-screen","bg-gray-100","pt-16"],[1,"flex","flex-col","items-center","mb-4"],["src","assets/logo.png","alt","forest+ Logo",1,"h-24","w-24","mb-4"],[1,"w-full","max-w-3xl","p-6","bg-white","shadow-lg","rounded-2xl"],[1,"text-2xl","font-bold","text-green-700","text-center","mb-6"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",3,"formGroup","ngSubmit",4,"ngIf"],["class","text-center text-green-600 font-semibold text-lg mt-4",4,"ngIf"],["class","text-center text-red-500 mt-4",4,"ngIf"],[1,"text-center","text-gray-500","mt-4"],[1,"text-blue-500","font-semibold","hover:underline",3,"routerLink"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],[1,"md:col-span-2"],[1,"block","text-gray-700","mb-1"],["type","text","formControlName","name",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"placeholder"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["type","text","formControlName","surname",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"placeholder"],["type","text","formControlName","secondSurname",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"placeholder"],["type","email","formControlName","email",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"placeholder"],[1,"md:col-span-2","relative"],["formControlName","password",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"type","placeholder"],["type","button",1,"absolute","right-0","top-1/2","transform","-translate-y-1/2","px-2","text-gray-500",3,"click"],[1,"md:col-span-2","mt-4"],["type","submit",1,"w-full","bg-green-600","text-white","py-3","rounded-lg","hover:bg-green-700","disabled:opacity-50",3,"disabled"],[1,"text-red-500","text-sm","mt-1"],[4,"ngIf"],[1,"text-center","text-green-600","font-semibold","text-lg","mt-4"],[1,"text-center","text-red-500","mt-4"]],template:function(t,r){t&1&&(s(0,"div",0)(1,"div",1),A(2,"img",2),l(),s(3,"div",3)(4,"h1",4),d(5),c(6,"translate"),l(),E(7,Oa,41,41,"form",5)(8,Ra,3,3,"div",6)(9,Da,2,1,"div",7),s(10,"p",8),d(11),c(12,"translate"),s(13,"a",9),d(14),c(15,"translate"),l()()()()),t&2&&(a(5),g(" ",u(6,7,"REGISTER.TITLE")," "),a(2),f("ngIf",!r.registerSuccess),a(),f("ngIf",r.registerSuccess),a(),f("ngIf",r.registerError),a(2),g(" ",u(12,9,"REGISTER.ALREADY_ACCOUNT")," "),a(2),f("routerLink",ot(13,xa)),a(),g(" ",u(15,11,"REGISTER.LOGIN")," "))},dependencies:[F,H,L,U,Z,Xe,Lt,Nt,_e,ye,Pt,Ot,Rt,J,hr,gr,X,Q,di]})}}return n})();var La=()=>["../register"],ka=()=>({length:6});function Fa(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),g(" ",u(2,1,"LOGIN.EMAIL_REQUIRED")," "))}function Ba(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),g(" ",u(2,1,"LOGIN.EMAIL_INVALID")," "))}function ja(n,i){if(n&1&&(s(0,"div",18),E(1,Fa,3,3,"div",19)(2,Ba,3,3,"div",19),l()),n&2){let e,t,r=_(2);a(),f("ngIf",(e=(r.forgotMode?r.forgotForm:r.loginForm).get("email"))==null?null:e.hasError("required")),a(),f("ngIf",(t=(r.forgotMode?r.forgotForm:r.loginForm).get("email"))==null?null:t.hasError("email"))}}function Ua(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),g(" ",u(2,1,"LOGIN.PASSWORD_REQUIRED")," "))}function Va(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),g(" ",Y(2,1,"LOGIN.PASSWORD_MINLENGTH",ot(4,ka))," "))}function Ya(n,i){if(n&1&&(s(0,"div",18),E(1,Ua,3,3,"div",19)(2,Va,3,5,"div",19),l()),n&2){let e,t,r=_(3);a(),f("ngIf",(e=r.loginForm.get("password"))==null?null:e.hasError("required")),a(),f("ngIf",(t=r.loginForm.get("password"))==null?null:t.hasError("minlength"))}}function za(n,i){if(n&1){let e=j();s(0,"div",20)(1,"label",21),d(2),c(3,"translate"),l(),A(4,"input",22),c(5,"translate"),s(6,"button",23),T("click",function(){I(e);let r=_(2);return w(r.hidePassword=!r.hidePassword)}),d(7),l(),E(8,Ya,3,2,"div",15),l()}if(n&2){let e,t=_(2);a(2),y(u(3,5,"LOGIN.PASSWORD")),a(2),te("placeholder",u(5,7,"LOGIN.PASSWORD_PLACEHOLDER")),f("type",t.hidePassword?"password":"text"),a(3),g(" ",t.hidePassword?"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F":"\u{1F441}\uFE0F"," "),a(),f("ngIf",((e=t.loginForm.get("password"))==null?null:e.invalid)&&((e=t.loginForm.get("password"))==null?null:e.touched))}}function Ga(n,i){if(n&1){let e=j();s(0,"form",11),T("ngSubmit",function(){I(e);let r=_();return w(r.forgotMode?r.onForgotSubmit():r.onSubmit())}),s(1,"div",12)(2,"label",13),d(3),c(4,"translate"),l(),A(5,"input",14),c(6,"translate"),E(7,ja,3,2,"div",15),l(),E(8,za,9,9,"div",16),s(9,"button",17),d(10),c(11,"translate"),c(12,"translate"),l()()}if(n&2){let e,t=_();f("formGroup",t.forgotMode?t.forgotForm:t.loginForm),a(3),y(u(4,7,"LOGIN.EMAIL")),a(2),te("placeholder",u(6,9,"LOGIN.EMAIL_PLACEHOLDER")),a(2),f("ngIf",((e=(t.forgotMode?t.forgotForm:t.loginForm).get("email"))==null?null:e.invalid)&&((e=(t.forgotMode?t.forgotForm:t.loginForm).get("email"))==null?null:e.touched)),a(),f("ngIf",!t.forgotMode),a(),f("disabled",(t.forgotMode?t.forgotForm:t.loginForm).invalid),a(),g(" ",t.forgotMode?u(11,11,"LOGIN.SEND_NEW_PASSWORD"):u(12,13,"LOGIN.BUTTON")," ")}}function Ka(n,i){if(n&1){let e=j();s(0,"div",24),d(1),c(2,"translate"),s(3,"div",25)(4,"button",26),T("click",function(){I(e);let r=_();return w(r.toggleForgotMode())}),d(5),c(6,"translate"),l()()()}n&2&&(a(),g(" ",u(2,2,"LOGIN.FORGOT_PASSWORD_SUCCESS")," "),a(4),g(" ",u(6,4,"LOGIN.GO_TO_LOGIN")," "))}function qa(n,i){if(n&1){let e=j();s(0,"button",29),T("click",function(){I(e);let r=_(2);return w(r.resendVerificationEmail())}),d(1),c(2,"translate"),l()}n&2&&(a(),g(" ",u(2,1,"LOGIN.RESEND_EMAIL")," "))}function $a(n,i){if(n&1&&(s(0,"div",27),d(1),E(2,qa,3,3,"button",28),l()),n&2){let e=_();a(),g(" ",e.loginError," "),a(),f("ngIf",e.showResendButton)}}function Ha(n,i){if(n&1){let e=j();s(0,"div",30)(1,"button",31),T("click",function(){I(e);let r=_();return w(r.toggleForgotMode())}),d(2),c(3,"translate"),l()()}n&2&&(a(2),g(" ",u(3,1,"LOGIN.FORGOT_PASSWORD")," "))}var Nr=(()=>{class n{constructor(e,t,r,o){this.fb=e,this.router=t,this.translate=r,this.authService=o,this.hidePassword=!0,this.loginError=null,this.showResendButton=!1,this.unverifiedEmail=null,this.success=!1,this.forgotMode=!1,this.accessKey="",this.error=!1,this.loginForm=this.fb.group({email:["",[Ce.required,Ce.email]],password:["",[Ce.required,Ce.minLength(6)]]}),this.forgotForm=this.fb.group({email:["",[Ce.required,Ce.email]]}),this.loginForm.valueChanges.subscribe(()=>this.loginError=null)}toggleForgotMode(){this.forgotMode=!this.forgotMode,this.success=!1,this.loginError=null}onSubmit(){if(this.forgotMode){this.onForgotSubmit();return}if(this.loginForm.valid){let{email:e,password:t}=this.loginForm.value;this.authService.login({email:e,password:t}).subscribe({next:r=>{r&&(r.forcePasswordChange?this.router.navigate(["/reset-password"],{queryParams:{email:r.email}}):this.router.navigateByUrl("/"))},error:r=>this.handleLoginError(r)})}}handleLoginError(e){console.error(e);let t=e.error?.message||"LOGIN.GENERIC_ERROR";t==="EMAIL_NOT_VERIFIED"?(this.loginError=this.translate.instant("LOGIN.EMAIL_NOT_VERIFIED"),this.showResendButton=!0,this.unverifiedEmail=this.loginForm.value.email):this.translate.get(t).subscribe(r=>{this.loginError=r,this.showResendButton=!1})}resendVerificationEmail(){this.unverifiedEmail&&this.authService.resendVerification(this.unverifiedEmail).subscribe({next:()=>{this.loginError=this.translate.instant("LOGIN.VERIFICATION_EMAIL_SENT"),this.showResendButton=!1},error:()=>{this.loginError=this.translate.instant("LOGIN.VERIFICATION_EMAIL_FAILED")}})}onForgotSubmit(){if(this.forgotForm.invalid)return;let e=this.forgotForm.value.email;this.authService.forgotPassword(e).pipe(ni(()=>{})).subscribe({next:()=>{this.success=!0},error:t=>{alert(t?.error?.message||"Error enviando correo de restablecimiento")}})}static{this.\u0275fac=function(t){return new(t||n)(x(Dt),x(z),x(ge),x(oe))}}static{this.\u0275cmp=P({type:n,selectors:[["app-login"]],standalone:!0,features:[N],decls:18,vars:17,consts:[[1,"flex","flex-col","items-center","justify-start","min-h-screen","bg-gray-100","pt-16"],[1,"flex","flex-col","items-center","mb-4"],["src","assets/logo.png","alt","forest+ Logo",1,"h-24","w-24","mb-4"],[1,"w-full","max-w-md","p-6","bg-white","shadow-lg","rounded-2xl"],[1,"text-2xl","font-bold","text-green-700","text-center","mb-6"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","text-center text-green-600 font-semibold text-lg mt-4",4,"ngIf"],["class","text-center text-red-500 mt-4",4,"ngIf"],["class","text-center mt-4",4,"ngIf"],[1,"text-center","text-gray-500","mt-4"],[1,"text-green-500","font-semibold","hover:underline",3,"routerLink"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","email",1,"block","text-gray-700","mb-1"],["id","email","type","email","formControlName","email",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"placeholder"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["class","mb-6 relative",4,"ngIf"],["type","submit",1,"w-full","bg-green-600","text-white","py-3","rounded-lg","hover:bg-green-700","disabled:opacity-50",3,"disabled"],[1,"text-red-500","text-sm","mt-1"],[4,"ngIf"],[1,"mb-6","relative"],["for","password",1,"block","text-gray-700","mb-1"],["id","password","formControlName","password",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"type","placeholder"],["type","button",1,"absolute","right-0","top-1/2","transform","-translate-y-1/2","px-2","text-gray-500",3,"click"],[1,"text-center","text-green-600","font-semibold","text-lg","mt-4"],[1,"mt-6"],[1,"bg-green-700","hover:bg-green-800","text-white","font-bold","py-2","px-4","rounded-lg",3,"click"],[1,"text-center","text-red-500","mt-4"],["class","ml-2 bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",3,"click",4,"ngIf"],[1,"ml-2","bg-blue-600","text-white","px-2","py-1","rounded","hover:bg-blue-700",3,"click"],[1,"text-center","mt-4"],["type","button",1,"text-green-500","font-semibold","hover:underline",3,"click"]],template:function(t,r){t&1&&(s(0,"div",0)(1,"div",1),A(2,"img",2),l(),s(3,"div",3)(4,"h1",4),d(5),c(6,"translate"),c(7,"translate"),l(),E(8,Ga,13,15,"form",5)(9,Ka,7,6,"div",6)(10,$a,3,2,"div",7)(11,Ha,4,3,"div",8),s(12,"p",9),d(13),c(14,"translate"),s(15,"a",10),d(16),c(17,"translate"),l()()()()),t&2&&(a(5),g(" ",r.forgotMode?u(6,8,"LOGIN.FORGOT_PASSWORD_TITLE"):u(7,10,"LOGIN.TITLE")," "),a(3),f("ngIf",!r.success),a(),f("ngIf",r.success),a(),f("ngIf",!r.forgotMode&&r.loginError),a(),f("ngIf",!r.forgotMode&&!r.success),a(2),g(" ",u(14,12,"LOGIN.NO_ACCOUNT")," "),a(2),f("routerLink",ot(16,La)),a(),g(" ",u(17,14,"LOGIN.REGISTER")," "))},dependencies:[F,H,Lt,Nt,_e,ye,Pt,Ot,Rt,De,L,U,Z,Xe],styles:[".minimal-outline[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{background-color:transparent!important;padding-top:.5rem!important;padding-bottom:.5rem!important}.minimal-outline[_ngcontent-%COMP%]   .mat-mdc-form-field-outline[_ngcontent-%COMP%], .minimal-outline[_ngcontent-%COMP%]   .mat-mdc-form-field-outline-start[_ngcontent-%COMP%], .minimal-outline[_ngcontent-%COMP%]   .mat-mdc-form-field-outline-end[_ngcontent-%COMP%]{border-color:#cbd5e1!important;border-width:1px!important}"]})}}return n})();var et=(()=>{class n{constructor(e,t){this.authService=e,this.router=t}canActivate(){return this.authService.user$.pipe(ii(1),ti(e=>e?!0:(this.router.navigate(["/login"]),!1)))}static{this.\u0275fac=function(t){return new(t||n)(we(oe),we(z))}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Wa(n,i){n&1&&(s(0,"div",7),d(1),c(2,"translate"),s(3,"div",8)(4,"a",9),d(5),c(6,"translate"),l()()()),n&2&&(a(),g(" ",u(2,2,"VERIFY_EMAIL.SUCCESS")," "),a(4),g(" ",u(6,4,"VERIFY_EMAIL.GO_TO_LOGIN")," "))}function Qa(n,i){if(n&1&&(s(0,"div",10),d(1),c(2,"translate"),l()),n&2){let e=_();a(),g(" ",e.errorMessage||u(2,1,"VERIFY_EMAIL.ERROR")," ")}}var Or=(()=>{class n{constructor(e,t,r){this.route=e,this.authService=t,this.translate=r,this.loading=!0,this.success=!1,this.errorMessage=null}ngOnInit(){this.route.queryParams.subscribe(e=>{let t=e.uuid;console.log("uuid:",t),t?this.authService.verifyEmail(t).subscribe({next:()=>{this.success=!0,this.loading=!1},error:r=>{console.error(r),this.success=!1,this.loading=!1;let o=r?.error?.message||"VERIFY_EMAIL.ERROR";this.translate.get(o).subscribe(p=>this.errorMessage=p)}}):(this.loading=!1,this.success=!1,this.translate.get("VERIFY_EMAIL.INVALID_LINK").subscribe(r=>{this.errorMessage=r}))})}static{this.\u0275fac=function(t){return new(t||n)(x(Re),x(oe),x(ge))}}static{this.\u0275cmp=P({type:n,selectors:[["app-email-verify"]],standalone:!0,features:[N],decls:9,vars:5,consts:[[1,"flex","flex-col","items-center","justify-start","min-h-screen","bg-gray-100","pt-16"],[1,"flex","flex-col","items-center","mb-4"],["src","assets/logo.png","alt","forest+ Logo",1,"h-24","w-24","mb-4"],[1,"w-full","max-w-3xl","p-6","shadow-lg","rounded-2xl"],[1,"text-2xl","font-bold","text-green-700","text-center","mb-6"],["class","text-center text-green-600 font-semibold text-lg mt-4",4,"ngIf"],["class","text-center text-red-600 font-semibold mt-4",4,"ngIf"],[1,"text-center","text-green-600","font-semibold","text-lg","mt-4"],[1,"mt-6"],["routerLink","/login",1,"bg-green-700","hover:bg-green-800","text-white","font-bold","py-2","px-4","rounded-lg"],[1,"text-center","text-red-600","font-semibold","mt-4"]],template:function(t,r){t&1&&(s(0,"div",0)(1,"div",1),A(2,"img",2),l(),s(3,"mat-card",3)(4,"h1",4),d(5),c(6,"translate"),l(),E(7,Wa,7,6,"div",5)(8,Qa,3,3,"div",6),l()()),t&2&&(a(5),g(" ",u(6,3,"VERIFY_EMAIL.TITLE")," "),a(2),f("ngIf",!r.loading&&r.success),a(),f("ngIf",!r.loading&&!r.success))},dependencies:[F,H,L,U,J,ee,Z,Xe,or]})}}return n})();var Xa=()=>["../login"];function Za(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"RESET_PASSWORD.NEW_PASSWORD_REQUIRED")))}function Ja(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"RESET_PASSWORD.NEW_PASSWORD_MINLENGTH")))}function es(n,i){if(n&1&&(s(0,"div",18),E(1,Za,3,3,"div",19)(2,Ja,3,3,"div",19),l()),n&2){let e,t,r=_();a(),f("ngIf",(e=r.resetForm.get("newPassword"))==null?null:e.hasError("required")),a(),f("ngIf",(t=r.resetForm.get("newPassword"))==null?null:t.hasError("minlength"))}}function ts(n,i){n&1&&(s(0,"div"),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"RESET_PASSWORD.CONFIRM_PASSWORD_REQUIRED")))}function is(n,i){if(n&1&&(s(0,"div",18),E(1,ts,3,3,"div",19),l()),n&2){let e,t=_();a(),f("ngIf",(e=t.resetForm.get("confirmPassword"))==null?null:e.hasError("required"))}}function ns(n,i){if(n&1&&(s(0,"div",20),d(1),l()),n&2){let e=_();a(),y(e.errorMessage)}}function rs(n,i){if(n&1&&(s(0,"div",21),d(1),l()),n&2){let e=_();a(),y(e.successMessage)}}var Rr=(()=>{class n{constructor(e,t,r,o){this.fb=e,this.authService=t,this.router=r,this.route=o,this.errorMessage="",this.successMessage="",this.token=null,this.resetForm=this.fb.group({newPassword:["",[Ce.required,Ce.minLength(6)]],confirmPassword:["",Ce.required]}),this.token=this.route.snapshot.queryParamMap.get("token")||localStorage.getItem("forestPlus_token")}onSubmit(){if(this.resetForm.invalid)return;let{newPassword:e,confirmPassword:t}=this.resetForm.value;if(e!==t){this.errorMessage="Las contrase\xF1as no coinciden";return}if(!this.token){this.errorMessage="Token inv\xE1lido o expirado";return}let r={newPassword:e};this.authService.resetPassword(r,this.isUUID(this.token)?this.token:void 0).subscribe({next:()=>{this.successMessage="Contrase\xF1a cambiada correctamente",setTimeout(()=>this.router.navigate(["/"]),2e3)},error:p=>{this.errorMessage=p.error?.message||"Error al cambiar la contrase\xF1a"}})}isUUID(e){return e.length===36&&e.includes("-")}static{this.\u0275fac=function(t){return new(t||n)(x(Dt),x(oe),x(z),x(Re))}}static{this.\u0275cmp=P({type:n,selectors:[["app-reset-password"]],standalone:!0,features:[N],decls:34,vars:35,consts:[[1,"flex","flex-col","items-center","justify-start","min-h-screen","bg-gray-100","pt-16"],[1,"flex","flex-col","items-center","mb-4"],["src","assets/logo.png",1,"h-24","w-24",3,"alt"],[1,"w-full","max-w-md","p-6","bg-white","shadow-lg","rounded-2xl"],[1,"text-2xl","font-bold","text-green-700","text-center","mb-6"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","newPassword",1,"block","text-gray-700","mb-1"],["id","newPassword","type","password","formControlName","newPassword",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"placeholder"],["class","text-red-500 text-sm mt-1",4,"ngIf"],[1,"mb-6"],["for","confirmPassword",1,"block","text-gray-700","mb-1"],["id","confirmPassword","type","password","formControlName","confirmPassword",1,"w-full","px-4","py-2","border-b","border-gray-300","focus:border-green-500","focus:outline-none","bg-transparent",3,"placeholder"],["type","submit",1,"w-full","bg-green-600","text-white","py-3","rounded-lg","hover:bg-green-700","disabled:opacity-50",3,"disabled"],["class","text-center text-red-500 mt-4",4,"ngIf"],["class","text-center text-green-600 mt-4",4,"ngIf"],[1,"text-center","text-gray-500","mt-4"],[1,"text-blue-500","font-semibold","hover:underline",3,"routerLink"],[1,"text-red-500","text-sm","mt-1"],[4,"ngIf"],[1,"text-center","text-red-500","mt-4"],[1,"text-center","text-green-600","mt-4"]],template:function(t,r){if(t&1&&(s(0,"div",0)(1,"div",1),A(2,"img",2),c(3,"translate"),l(),s(4,"div",3)(5,"h1",4),d(6),c(7,"translate"),l(),s(8,"form",5),T("ngSubmit",function(){return r.onSubmit()}),s(9,"div",6)(10,"label",7),d(11),c(12,"translate"),l(),A(13,"input",8),c(14,"translate"),E(15,es,3,2,"div",9),l(),s(16,"div",10)(17,"label",11),d(18),c(19,"translate"),l(),A(20,"input",12),c(21,"translate"),E(22,is,2,1,"div",9),l(),s(23,"button",13),d(24),c(25,"translate"),l()(),E(26,ns,2,1,"div",14)(27,rs,2,1,"div",15),s(28,"p",16),d(29),c(30,"translate"),s(31,"a",17),d(32),c(33,"translate"),l()()()()),t&2){let o,p;a(2),f("alt",u(3,16,"RESET_PASSWORD.LOGO_ALT")),a(4),g(" ",u(7,18,"RESET_PASSWORD.TITLE")," "),a(2),f("formGroup",r.resetForm),a(3),y(u(12,20,"RESET_PASSWORD.NEW_PASSWORD_LABEL")),a(2),f("placeholder",u(14,22,"RESET_PASSWORD.NEW_PASSWORD_PLACEHOLDER")),a(2),f("ngIf",((o=r.resetForm.get("newPassword"))==null?null:o.invalid)&&((o=r.resetForm.get("newPassword"))==null?null:o.touched)),a(3),y(u(19,24,"RESET_PASSWORD.CONFIRM_PASSWORD_LABEL")),a(2),f("placeholder",u(21,26,"RESET_PASSWORD.CONFIRM_PASSWORD_PLACEHOLDER")),a(2),f("ngIf",((p=r.resetForm.get("confirmPassword"))==null?null:p.invalid)&&((p=r.resetForm.get("confirmPassword"))==null?null:p.touched)),a(),f("disabled",r.resetForm.invalid),a(),g(" ",u(25,28,"RESET_PASSWORD.SUBMIT_BUTTON")," "),a(2),f("ngIf",r.errorMessage),a(),f("ngIf",r.successMessage),a(2),g(" ",u(30,30,"RESET_PASSWORD.REMEMBER_PASSWORD")," "),a(2),f("routerLink",ot(34,Xa)),a(),g(" ",u(33,32,"RESET_PASSWORD.LOGIN_LINK")," ")}},dependencies:[F,H,Lt,Nt,_e,ye,Pt,Ot,Rt,L,U,Z,Xe]})}}return n})();var xe=(()=>{class n{constructor(e,t){this.userService=e,this.router=t}canActivate(e){let t=e.data.roles,r=this.userService.getCurrentUser();return r?r.role&&t.includes(r.role)?!0:(this.router.navigate(["/dashboard"]),!1):(this.router.navigate(["/login"]),!1)}static{this.\u0275fac=function(t){return new(t||n)(we(ae),we(z))}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var os=["*",[["mat-toolbar-row"]]],as=["*","mat-toolbar-row"],ss=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275dir=Pn({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0})}}return n})(),Dr=(()=>{class n{constructor(e,t,r){this._elementRef=e,this._platform=t,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static{this.\u0275fac=function(t){return new(t||n)(x(Ln),x(nr),x(si))}}static{this.\u0275cmp=P({type:n,selectors:[["mat-toolbar"]],contentQueries:function(t,r,o){if(t&1&&Un(o,ss,5),t&2){let p;Vn(p=Yn())&&(r._toolbarRows=p)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(t,r){t&2&&(bt(r.color?"mat-"+r.color:""),ft("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",r._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[N],ngContentSelectors:as,decls:2,vars:0,template:function(t,r){t&1&&(jn(os),Li(0),Li(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color, var(--mat-app-surface));color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface))}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font, var(--mat-app-title-large-font));font-size:var(--mat-toolbar-title-text-size, var(--mat-app-title-large-size));line-height:var(--mat-toolbar-title-text-line-height, var(--mat-app-title-large-line-height));font-weight:var(--mat-toolbar-title-text-weight, var(--mat-app-title-large-weight));letter-spacing:var(--mat-toolbar-title-text-tracking, var(--mat-app-title-large-tracking));margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface));--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface))}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}}return n})();var Lr=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=ai({type:n})}static{this.\u0275inj=ri({imports:[ki,ki]})}}return n})();var kr=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=P({type:n,selectors:[["app-admin-page"]],standalone:!0,features:[N],decls:8,vars:3,consts:[["color","primary",1,"flex","items-center","justify-between","px-6","py-4","bg-white","shadow-md"],[1,"flex","items-center","space-x-3"],[1,"text-gray-800"],[1,"text-2xl","font-bold","text-gray-800"]],template:function(t,r){t&1&&(s(0,"mat-toolbar",0)(1,"div",1)(2,"mat-icon",2),d(3,"admin_panel_settings"),l(),s(4,"h1",3),d(5),c(6,"translate"),l()()(),A(7,"router-outlet")),t&2&&(a(5),y(u(6,1,"ADMIN_PAGE.TITLE")))},dependencies:[Z,At,Lr,Dr,Q,re,X,L,U]})}}return n})();var tt=(()=>{class n{constructor(e,t){this.data=e,this.dialogRef=t}onConfirm(){this.dialogRef.close(!0)}onCancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(t){return new(t||n)(x(Ft),x(yr))}}static{this.\u0275cmp=P({type:n,selectors:[["app-confirm-dialog"]],standalone:!0,features:[N],decls:14,vars:12,consts:[["mat-dialog-title",""],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,r){t&1&&(s(0,"h2",0),d(1),c(2,"translate"),l(),s(3,"mat-dialog-content")(4,"p"),d(5),c(6,"translate"),l()(),s(7,"mat-dialog-actions",1)(8,"button",2),T("click",function(){return r.onCancel()}),d(9),c(10,"translate"),l(),s(11,"button",3),T("click",function(){return r.onConfirm()}),d(12),c(13,"translate"),l()()),t&2&&(a(),y(u(2,4,r.data.title)),a(4),y(u(6,6,r.data.message)),a(4),y(u(10,8,"CONFIRM_DIALOG.CANCEL")),a(3),y(u(13,10,"CONFIRM_DIALOG.CONFIRM_DELETE")))},dependencies:[F,Vt,Bt,Ut,jt,X,ur,L,U]})}}return n})();var ds=(n,i)=>({current:n,total:i}),ps=n=>({"border-red-500 bg-red-50":n});function cs(n,i){if(n&1&&(s(0,"span",20),d(1),l()),n&2){let e=_().$implicit;a(),g(" ",e.pendingTreesCount," ")}}function ms(n,i){if(n&1){let e=j();s(0,"div",10)(1,"div",11)(2,"div",12),d(3),E(4,cs,2,1,"span",13),l(),s(5,"div",14),d(6),l(),s(7,"div",15),d(8),l()(),s(9,"div",16)(10,"button",17),T("click",function(){let r=I(e).$implicit,o=_(2);return w(o.onView(r))}),s(11,"mat-icon",18),d(12,"visibility"),l()(),s(13,"button",17),T("click",function(){let r=I(e).$implicit,o=_(2);return w(o.onEdit(r))}),s(14,"mat-icon",18),d(15,"edit"),l()(),s(16,"button",19),T("click",function(){let r=I(e).$implicit,o=_(2);return w(o.onDelete(r))}),s(17,"mat-icon",18),d(18,"delete"),l()()()()}if(n&2){let e,t,r=i.$implicit;f("ngClass",me(6,ps,((e=r.pendingTreesCount)!==null&&e!==void 0?e:0)>0)),a(3),W(" ",r.name," ",r.surname," "),a(),f("ngIf",((t=r.pendingTreesCount)!==null&&t!==void 0?t:0)>0),a(2),y(r.email),a(2),y(r.role||"\u2014")}}function us(n,i){if(n&1&&(s(0,"div",8),E(1,ms,19,8,"div",9),l()),n&2){let e=_();a(),f("ngForOf",e.getPagedUsers())}}var Fr=(()=>{class n{constructor(e,t,r,o,p){this.userService=e,this.snackBar=t,this.dialog=r,this.router=o,this.translate=p,this.users=[],this.filteredUsers=[],this.currentPage=0,this.pageSize=10,this.totalPages=1,this.filterText=""}ngOnInit(){this.loadUsers()}loadUsers(){let e=this.userService.getCurrentUser(),t=e?.role===M.COMPANY_ADMIN?e.company?.id:void 0;this.userService.getUsers(0,1e3,"id,asc",void 0,t).subscribe({next:r=>{let o=(r.content??[]).filter(p=>p.id!==e?.id);this.users=o,this.applyFilter()},error:r=>console.error("\u274C Error al cargar usuarios",r)})}applyFilter(){let e=this.filterText.trim().toLowerCase();this.filteredUsers=this.users.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.surname||"").toLowerCase().includes(e)||(t.email||"").toLowerCase().includes(e)),this.currentPage=0,this.totalPages=Math.ceil(this.filteredUsers.length/this.pageSize)}getPagedUsers(){let e=this.currentPage*this.pageSize;return this.filteredUsers.slice(e,e+this.pageSize)}previousPage(){this.currentPage>0&&this.currentPage--}nextPage(){this.currentPage+1<this.totalPages&&this.currentPage++}addUser(){this.router.navigate(["/admin/user-form"])}onEdit(e){this.router.navigate(["/admin/user-form",e.id])}onView(e){this.router.navigate(["/profile",e.id])}onDelete(e){this.dialog.open(tt,{width:"400px",data:{title:this.translate.instant("ADMIN_USERS.CONFIRM_DELETE_USER.TITLE"),message:this.translate.instant("ADMIN_USERS.CONFIRM_DELETE_USER.MESSAGE",{name:e.name})}}).afterClosed().subscribe(r=>{r&&this.userService.deleteUser(e.id).subscribe({next:()=>{this.snackBar.open(this.translate.instant("ADMIN_USERS.USER_DELETED"),this.translate.instant("COMMON.CLOSE"),{duration:3e3}),this.loadUsers()},error:o=>{console.error("\u274C Error al eliminar usuario",o);let p=o?.error?.message||this.translate.instant("ADMIN_USERS.USER_DELETE_ERROR");this.snackBar.open(`${this.translate.instant("ADMIN_USERS.USER_DELETE_ERROR")}: ${p}`,this.translate.instant("COMMON.CLOSE"),{duration:6e3})}})})}static{this.\u0275fac=function(t){return new(t||n)(x(ae),x(Me),x(ze),x(z),x(ge))}}static{this.\u0275cmp=P({type:n,selectors:[["app-admin-users"]],standalone:!0,features:[N],decls:24,vars:23,consts:[[1,"p-4"],[1,"flex","justify-between","items-center","mb-4"],["type","text",1,"w-64","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"ngModelChange","keyup","placeholder","ngModel"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-3","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click"],["class","flex flex-col gap-4",4,"ngIf"],[1,"mt-6","flex","justify-center","items-center","gap-4"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-2","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click","disabled"],[1,"text-gray-700","font-medium"],[1,"flex","flex-col","gap-4"],["class","border rounded p-4 shadow-sm flex justify-between items-center w-full",3,"ngClass",4,"ngFor","ngForOf"],[1,"border","rounded","p-4","shadow-sm","flex","justify-between","items-center","w-full",3,"ngClass"],[1,"flex","flex-col","text-left"],[1,"font-semibold","text-lg","flex","items-center","gap-2"],["class","bg-red-600 text-white text-xs px-2 py-0.5 rounded-full",4,"ngIf"],[1,"text-gray-600"],[1,"text-gray-500"],[1,"flex","gap-2"],[1,"bg-green-600","hover:bg-green-700","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"],[1,"text-white",2,"font-size","20px"],[1,"bg-red-600","hover:bg-red-700","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"],[1,"bg-red-600","text-white","text-xs","px-2","py-0.5","rounded-full"]],template:function(t,r){if(t&1&&(s(0,"mat-card",0)(1,"div",1)(2,"input",2),c(3,"translate"),be("ngModelChange",function(p){return Se(r.filterText,p)||(r.filterText=p),p}),T("keyup",function(){return r.applyFilter()}),l(),s(4,"button",3),T("click",function(){return r.addUser()}),s(5,"mat-icon"),d(6,"add"),l(),d(7),c(8,"translate"),l()(),E(9,us,2,1,"div",4),s(10,"div",5)(11,"button",6),T("click",function(){return r.previousPage()}),s(12,"mat-icon"),d(13,"chevron_left"),l(),d(14),c(15,"translate"),l(),s(16,"span",7),d(17),c(18,"translate"),l(),s(19,"button",6),T("click",function(){return r.nextPage()}),d(20),c(21,"translate"),s(22,"mat-icon"),d(23,"chevron_right"),l()()()()),t&2){let o;a(2),te("placeholder",u(3,9,"ADMIN_USERS.SEARCH_PLACEHOLDER")),Te("ngModel",r.filterText),a(5),g(" ",u(8,11,"ADMIN_USERS.ADD_BUTTON")," "),a(2),f("ngIf",(o=r.getPagedUsers())==null?null:o.length),a(2),f("disabled",r.currentPage===0),a(3),g(" ",u(15,13,"ADMIN_USERS.PAGINATION.PREVIOUS")," "),a(3),g(" ",Y(18,15,"ADMIN_USERS.PAGINATION.PAGE_INFO",It(20,ds,r.currentPage+1,r.totalPages))," "),a(2),f("disabled",r.currentPage+1>=r.totalPages),a(),g(" ",u(21,18,"ADMIN_USERS.PAGINATION.NEXT")," ")}},dependencies:[F,at,ne,H,Z,De,_e,ye,Ye,J,ee,X,Q,re,L,U]})}}return n})();function hs(n,i){if(n&1){let e=j();s(0,"div",9)(1,"div",10)(2,"div",11),d(3),l(),s(4,"div",12),d(5),l()(),s(6,"div",13)(7,"button",14),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onView(r))}),s(8,"mat-icon",15),d(9,"visibility"),l()(),s(10,"button",14),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onEdit(r))}),s(11,"mat-icon",15),d(12,"edit"),l()(),s(13,"button",16),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onDelete(r))}),s(14,"mat-icon",15),d(15,"delete"),l()()()()}if(n&2){let e=i.$implicit;a(3),y(e.name),a(2),y(e.address||"\u2014")}}var Br=(()=>{class n{constructor(e,t,r,o,p,m){this.companyService=e,this.userService=t,this.snackBar=r,this.dialog=o,this.router=p,this.translate=m,this.companies=[],this.filteredCompanies=[],this.currentPage=0,this.pageSize=5,this.totalPages=1,this.filterText=""}ngOnInit(){this.loadCompanies()}loadCompanies(){let e=this.userService.getCurrentUser();this.companyService.getAllCompanies().subscribe({next:t=>{if(e?.role===M.COMPANY_ADMIN&&e.company?.id!=null){let r=e.company.id;this.companies=t.filter(o=>o.id===r)}else this.companies=t;console.log("this.companies",this.companies),console.log("typeof",typeof this.companies),this.applyFilter()},error:t=>console.error("\u274C Error al cargar compa\xF1\xEDas",t)})}applyFilter(){let e=this.filterText.trim().toLowerCase();this.filteredCompanies=this.companies.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.address||"").toLowerCase().includes(e)),this.currentPage=0,this.totalPages=Math.ceil(this.filteredCompanies.length/this.pageSize)}getPagedCompanies(){let e=this.currentPage*this.pageSize;return this.filteredCompanies.slice(e,e+this.pageSize)}previousPage(){this.currentPage>0&&this.currentPage--}nextPage(){this.currentPage+1<this.totalPages&&this.currentPage++}addCompany(){this.router.navigate(["/admin/company-form"])}onEdit(e){this.router.navigate(["/admin/company-form",e.id])}onView(e){this.router.navigate(["/company",e.id])}onDelete(e){if(!e.id)return;this.dialog.open(tt,{width:"400px",data:{title:this.translate.instant("ADMIN_COMPANIES.CONFIRM_DELETE_COMPANY.TITLE"),message:this.translate.instant("ADMIN_COMPANIES.CONFIRM_DELETE_COMPANY.MESSAGE",{name:e.name})}}).afterClosed().subscribe(r=>{r&&e.id!==void 0&&this.companyService.deleteCompany(e.id).subscribe({next:()=>{this.snackBar.open(this.translate.instant("ADMIN_COMPANIES.COMPANY_DELETED"),this.translate.instant("COMMON.CLOSE"),{duration:3e3}),this.loadCompanies()},error:o=>{console.error("Error al eliminar compa\xF1\xEDa",o),this.snackBar.open(this.translate.instant("ADMIN_COMPANIES.COMPANY_DELETE_ERROR"),this.translate.instant("COMMON.CLOSE"),{duration:3e3})}})})}static{this.\u0275fac=function(t){return new(t||n)(x(ci),x(ae),x(Me),x(ze),x(z),x(ge))}}static{this.\u0275cmp=P({type:n,selectors:[["app-admin-companies"]],standalone:!0,features:[N],decls:24,vars:18,consts:[[1,"p-4"],[1,"flex","justify-between","items-center","mb-4"],["type","text",1,"w-64","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"ngModelChange","keyup","placeholder","ngModel"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-3","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click"],[1,"flex","flex-col","gap-4"],["class","border rounded p-4 shadow-sm flex justify-between items-center w-full",4,"ngFor","ngForOf"],[1,"mt-6","flex","justify-center","items-center","gap-4"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-2","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click","disabled"],[1,"text-gray-700","font-medium"],[1,"border","rounded","p-4","shadow-sm","flex","justify-between","items-center","w-full"],[1,"flex","flex-col","text-left"],[1,"font-semibold","text-lg"],[1,"text-gray-600"],[1,"flex","gap-2"],[1,"bg-green-600","hover:bg-green-700","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"],[1,"text-white",2,"font-size","20px"],[1,"bg-red-600","hover:bg-red-700","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"]],template:function(t,r){t&1&&(s(0,"mat-card",0)(1,"div",1)(2,"input",2),c(3,"translate"),be("ngModelChange",function(p){return Se(r.filterText,p)||(r.filterText=p),p}),T("keyup",function(){return r.applyFilter()}),l(),s(4,"button",3),T("click",function(){return r.addCompany()}),s(5,"mat-icon"),d(6,"add"),l(),d(7),c(8,"translate"),l()(),s(9,"div",4),E(10,hs,16,2,"div",5),l(),s(11,"div",6)(12,"button",7),T("click",function(){return r.previousPage()}),s(13,"mat-icon"),d(14,"chevron_left"),l(),d(15),c(16,"translate"),l(),s(17,"span",8),d(18),l(),s(19,"button",7),T("click",function(){return r.nextPage()}),d(20),c(21,"translate"),s(22,"mat-icon"),d(23,"chevron_right"),l()()()()),t&2&&(a(2),te("placeholder",u(3,10,"ADMIN.COMPANIES.SEARCH_PLACEHOLDER")),Te("ngModel",r.filterText),a(5),g(" ",u(8,12,"COMPANIES.NEW_COMPANY")," "),a(3),f("ngForOf",r.getPagedCompanies()),a(2),f("disabled",r.currentPage===0),a(3),g(" ",u(16,14,"COMPANIES.PREVIOUS")," "),a(3),W("",r.currentPage+1," / ",r.totalPages,""),a(),f("disabled",r.currentPage+1>=r.totalPages),a(),g(" ",u(21,16,"COMPANIES.NEXT")," "))},dependencies:[F,ne,Z,J,ee,X,Q,re,De,_e,ye,Ye,L,U]})}}return n})();var jr=n=>({percentage:n});function gs(n,i){if(n&1){let e=j();s(0,"div",12)(1,"button",13),T("click",function(){I(e);let r=_(2);return w(r.goToEditForm())}),d(2),c(3,"translate"),l()()}n&2&&(a(2),g(" ",u(3,1,"COMPANY.EDIT_BUTTON")," "))}function _s(n,i){if(n&1&&(s(0,"li",15)(1,"span"),d(2),l(),s(3,"span",16),d(4),l()()),n&2){let e=i.$implicit;a(2),y(e.treeTypeName),a(2),y(e.quantity||1)}}function ys(n,i){if(n&1&&(s(0,"ul"),E(1,_s,5,2,"li",14),l()),n&2){let e=_(2);a(),f("ngForOf",e.companyTrees)}}function vs(n,i){n&1&&(s(0,"p",17),d(1),c(2,"translate"),l()),n&2&&(a(),y(u(2,1,"COMPANY.NO_TREES_PLANTED")))}function xs(n,i){if(n&1&&(s(0,"div",31)(1,"div",32)(2,"div",33),d(3),l(),s(4,"div",34)(5,"div",21),A(6,"canvas",35),l(),s(7,"div",21),A(8,"canvas",35),l(),s(9,"div",24)(10,"div",36),d(11),c(12,"number"),l(),s(13,"div",26),d(14),c(15,"translate"),l(),s(16,"div",27),d(17),c(18,"translate"),l()()()()()),n&2){let e=i.$implicit,t=_(4);a(3),y(e.year),a(3),f("id",e.emitidoRef),a(2),f("id",e.compensadoRef),a(2),f("ngClass",t.getNetColorClass(e.totalEmissions,e.totalCompensations)),a(),g(" ",Y(12,7,e.totalEmissions-e.totalCompensations,"1.0-0")," "),a(3),y(u(15,10,"COMPANY.TONS_CO2")),a(3),g(" ",Y(18,12,"COMPANY.COMPENSATED_PERCENTAGE",me(15,jr,t.getCompensatedPercentage(e.totalEmissions,e.totalCompensations)))," ")}}function Es(n,i){if(n&1&&(s(0,"div",29)(1,"div",8)(2,"p",9),d(3),c(4,"translate"),l()(),E(5,xs,19,17,"div",30),l()),n&2){let e=_(3);a(3),y(u(4,2,"COMPANY.PREVIOUS_YEARS_TITLE")),a(2),f("ngForOf",e.co2Years.slice(1))}}function Ts(n,i){if(n&1&&(s(0,"div",18)(1,"div",8)(2,"p",9),d(3),c(4,"translate"),l()(),s(5,"div",19)(6,"p",9),d(7),c(8,"translate"),l(),s(9,"p",9),d(10),l(),s(11,"div",20)(12,"div",21)(13,"div",22),d(14),c(15,"translate"),l(),A(16,"canvas",23),l(),s(17,"div",21)(18,"div",22),d(19),c(20,"translate"),l(),A(21,"canvas",23),l(),s(22,"div",24)(23,"div",22),d(24),c(25,"translate"),l(),s(26,"div",25),d(27),c(28,"number"),l(),s(29,"div",26),d(30),c(31,"translate"),l(),s(32,"div",27),d(33),c(34,"translate"),l()()()(),E(35,Es,6,4,"div",28),l()),n&2){let e=_(2);a(3),y(u(4,13,"COMPANY.CO2_SECTION_TITLE")),a(4),y(u(8,15,"COMPANY.LAST_YEAR")),a(3),y(e.co2Years[0].year),a(4),y(u(15,17,"COMPANY.ISSUED_LABEL")),a(2),f("id",e.co2Years[0].emitidoRef),a(3),y(u(20,19,"COMPANY.COMPENSATED_LABEL")),a(2),f("id",e.co2Years[0].compensadoRef),a(3),y(u(25,21,"COMPANY.NET_VALUE")),a(2),f("ngClass",e.getNetColorClass(e.co2Years[0].totalEmissions,e.co2Years[0].totalCompensations)),a(),g(" ",Y(28,23,e.co2Years[0].totalEmissions-e.co2Years[0].totalCompensations,"1.0-0")," "),a(3),y(u(31,26,"COMPANY.TONS_CO2")),a(3),g(" ",Y(34,28,"COMPANY.COMPENSATED_PERCENTAGE",me(31,jr,e.getCompensatedPercentage(e.co2Years[0].totalEmissions,e.co2Years[0].totalCompensations)))," "),a(2),f("ngIf",e.co2Years.length>1)}}function Ss(n,i){if(n&1&&(s(0,"mat-card",2),A(1,"img",3),c(2,"translate"),s(3,"h2",4),d(4),l(),s(5,"p",5),d(6),l(),E(7,gs,4,3,"div",6),s(8,"div",7)(9,"div",8)(10,"p",9),d(11),c(12,"translate"),l()(),E(13,ys,2,1,"ul",10)(14,vs,3,3,"ng-template",null,0,Ve),l(),E(16,Ts,36,33,"div",11),l()),n&2){let e=Ue(15),t=_();a(),te("alt",u(2,9,"COMPANY.COMPANY_LOGO_ALT")),f("src",t.previewImage||t.company.picture||"assets/company_profile.png",je),a(3),y(t.company.name),a(2),y(t.company.address),a(),f("ngIf",(t.user==null?null:t.user.role)==="COMPANY_ADMIN"||t.isEditable),a(4),y(u(12,11,"COMPANY.TREES_PLANTED_TITLE")),a(2),f("ngIf",t.companyTrees==null?null:t.companyTrees.length)("ngIfElse",e),a(3),f("ngIf",t.co2Years==null?null:t.co2Years.length)}}var Yi=(()=>{class n{constructor(e,t,r,o,p,m,h){this.userService=e,this.companyService=t,this.treeService=r,this.router=o,this.route=p,this.cdr=m,this.authService=h,this.co2Years=[],this.chartsMap={},this.isEditable=!1,this.isAdmin=!1,this.companyTrees=[],ji.register(vr,xr,Tr,Er)}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e?(this.isEditable=!0,this.checkRole(),this.companyService.getCompanyById(+e).subscribe({next:t=>{this.company=t,this.company&&(this.prepareCO2Years(),this.loadCompanyTrees())},error:t=>{console.error("Error cargando la compa\xF1\xEDa por ID:",t)}})):this.userService.getUser().subscribe({next:t=>{this.user=t,this.checkRole(),t?.company?.id?this.companyService.getCompanyById(t.company.id).subscribe({next:r=>{this.company=r,this.company&&(this.prepareCO2Years(),this.loadCompanyTrees())},error:r=>{console.error("Error cargando la compa\xF1\xEDa del usuario:",r)}}):console.warn("El usuario no tiene compa\xF1\xEDa asignada")},error:t=>{console.error("Error cargando el usuario:",t)}})}checkRole(){let e=this.authService.currentUserRole;this.isAdmin=e==="ADMIN"}ngAfterViewInit(){this.co2Years?.length&&setTimeout(()=>this.renderCO2Charts(),50)}loadCompanyTrees(){let e=this.company?.id||this.user?.company?.id;e&&this.treeService.getTreesByOwner(void 0,e).subscribe({next:t=>this.companyTrees=t,error:t=>console.error("Error cargando \xE1rboles de la compa\xF1\xEDa:",t)})}prepareCO2Years(){if(!this.company?.co2?.length)return;let e=[...this.company.co2].filter(t=>t.year!==void 0).sort((t,r)=>r.year-t.year);this.co2Years=e.map(t=>Sn(St({},t),{totalEmissions:t.totalEmissions||0,totalCompensations:t.totalCompensations||0,net:(t.totalEmissions||0)-(t.totalCompensations||0),emitidoRef:`emitido-${t.year}`,compensadoRef:`compensado-${t.year}`,netoRef:`neto-${t.year}`})),this.cdr.detectChanges(),setTimeout(()=>this.renderCO2Charts(),100)}goToEditForm(){let e=this.company?.id||this.user?.company?.id;e&&this.router.navigate(["/company/form",e])}renderCO2Charts(){this.co2Years.forEach((e,t)=>{["emitidoRef","compensadoRef","netoRef"].forEach(r=>{let o=document.getElementById(e[r]);if(!o)return;let p=t===0?200:80;o.width=p,o.height=p;let m=r==="emitidoRef"?e.totalEmissions:r==="compensadoRef"?e.totalCompensations:e.net,h=r==="emitidoRef"?"#fc4d03ff":r==="compensadoRef"?"#89de8cff":"#2c80c5cf";this.createDonutChart(o,m,h,e.totalEmissions||1)})})}createDonutChart(e,t,r,o){let p=e.getContext("2d");if(!p)return;this.chartsMap[e.id]&&this.chartsMap[e.id].destroy();let m=t/(o>0?o:1)*100,h={datasets:[{data:[m,100-m],backgroundColor:[r,"#e0e0e0"],cutout:"75%",borderWidth:0}]},v={id:"centerText",beforeDraw:b=>{let{ctx:S,width:V,height:k}=b;S&&(S.save(),S.font=`${k/100*20}px sans-serif`,S.fillStyle="#333",S.textBaseline="middle",S.fillText(`${t}`,V/2-S.measureText(`${t}`).width/2,k/2-10),S.font=`${k/100*8}px sans-serif`,S.fillStyle="#666",S.fillText("Toneladas de CO\u2082",V/2-S.measureText("Toneladas de CO\u2082").width/2,k/2+15),S.restore())}};this.chartsMap[e.id]=new ji(p,{type:"doughnut",data:h,options:{responsive:!0,plugins:{legend:{display:!1},tooltip:{enabled:!1}},animation:{animateRotate:!0,animateScale:!0}},plugins:[v]})}getNetColorClass(e,t){let r=e-t,o=e>0?r/e:1;return o<.5?"net-yellow":o<=1?"net-red":"net-green"}getCompensatedPercentage(e,t){return e?(t/e*100).toFixed(0):"0"}static{this.\u0275fac=function(t){return new(t||n)(x(ae),x(ci),x(st),x(z),x(Re),x(qn),x(oe))}}static{this.\u0275cmp=P({type:n,selectors:[["app-company"]],standalone:!0,features:[N],decls:1,vars:1,consts:[["noCompanyTrees",""],["class","rounded-2xl shadow-md p-4 md:p-6 flex flex-col items-center text-center w-full max-w-full",4,"ngIf"],[1,"rounded-2xl","shadow-md","p-4","md:p-6","flex","flex-col","items-center","text-center","w-full","max-w-full"],[1,"w-24","h-24","rounded-full","shadow-lg","mb-4","object-cover",3,"src","alt"],[1,"text-xl","md:text-2xl","font-semibold"],[1,"text-gray-500"],["class","flex gap-4 mt-4 w-full justify-center md:justify-start",4,"ngIf"],[1,"mt-4","w-full","text-left"],[1,"flex","justify-between","items-center","mb-2"],[1,"font-semibold","text-gray-700"],[4,"ngIf","ngIfElse"],["class","w-full mt-6",4,"ngIf"],[1,"flex","gap-4","mt-4","w-full","justify-center","md:justify-start"],[1,"flex-1","md:flex-auto","bg-green-600","text-white","py-3","px-6","rounded-xl","hover:bg-green-700","transition",3,"click"],["class","flex justify-between border-b py-1",4,"ngFor","ngForOf"],[1,"flex","justify-between","border-b","py-1"],[1,"font-semibold"],[1,"text-gray-500","italic"],[1,"w-full","mt-6"],[1,"mb-8"],[1,"co2-container","flex","justify-center","gap-4","mt-4","items-center"],[1,"donut-wrapper"],[1,"donut-label"],[1,"donut-large",3,"id"],[1,"donut-wrapper","neto-wrapper"],[1,"donut-neto","text-4xl","font-bold",3,"ngClass"],[1,"donut-neto-unit"],[1,"donut-neto-info"],["class","mt-6",4,"ngIf"],[1,"mt-6"],["class","co2-year-row flex flex-col items-start gap-2 mb-4 w-full",4,"ngFor","ngForOf"],[1,"co2-year-row","flex","flex-col","items-start","gap-2","mb-4","w-full"],[1,"flex","items-center","gap-4","w-full"],[1,"w-16","font-bold"],[1,"co2-container","flex","gap-4","items-center"],[1,"donut-small",3,"id"],[1,"donut-neto",3,"ngClass"]],template:function(t,r){t&1&&E(0,Ss,17,13,"mat-card",1),t&2&&f("ngIf",r.company)},dependencies:[F,at,ne,H,Mt,J,ee,X,Z,L,U],encapsulation:2})}}return n})();var bs=(n,i)=>({current:n,total:i}),Cs=n=>({value:n});function Is(n,i){if(n&1){let e=j();s(0,"div",9)(1,"div",10)(2,"div",11),d(3),l(),s(4,"div",12),d(5),l(),s(6,"div",12),d(7),c(8,"translate"),l()(),s(9,"div",13)(10,"button",14),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onView(r))}),s(11,"mat-icon",15),d(12,"visibility"),l()(),s(13,"button",14),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onEdit(r))}),s(14,"mat-icon",15),d(15,"edit"),l()(),s(16,"button",16),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onDelete(r))}),s(17,"mat-icon",15),d(18,"delete"),l()()()()}if(n&2){let e=i.$implicit;a(3),y(e.name),a(2),y(e.description||"\u2014"),a(2),g(" ",Y(8,3,"ADMIN_TREE_TYPES.CO2_LABEL",me(6,Cs,e.co2AbsorptionAt20))," ")}}var Vr=(()=>{class n{constructor(e,t,r,o,p,m){this.treeTypeService=e,this.userService=t,this.snackBar=r,this.dialog=o,this.router=p,this.translate=m,this.treeTypes=[],this.filteredTreeTypes=[],this.currentPage=0,this.pageSize=5,this.totalPages=1,this.filterText=""}ngOnInit(){this.loadTreeTypes()}loadTreeTypes(){this.treeTypeService.getAllTreeTypes().subscribe({next:e=>{this.treeTypes=e,this.applyFilter()},error:e=>console.error("\u274C Error al cargar tipos de \xE1rboles",e)})}applyFilter(){let e=this.filterText.trim().toLowerCase();this.filteredTreeTypes=this.treeTypes.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.description||"").toLowerCase().includes(e)),this.currentPage=0,this.totalPages=Math.ceil(this.filteredTreeTypes.length/this.pageSize)}getPagedTreeTypes(){let e=this.currentPage*this.pageSize;return this.filteredTreeTypes.slice(e,e+this.pageSize)}previousPage(){this.currentPage>0&&this.currentPage--}nextPage(){this.currentPage+1<this.totalPages&&this.currentPage++}addTreeType(){this.router.navigate(["/admin/tree-type-form"])}onEdit(e){this.router.navigate(["/admin/tree-type-form",e.id])}onView(e){this.router.navigate(["/tree-type",e.id])}onDelete(e){if(!e.id)return;this.dialog.open(tt,{width:"400px",data:{title:this.translate.instant("ADMIN_TREE_TYPES.CONFIRM_DELETE_TREE_TYPE.TITLE"),message:this.translate.instant("ADMIN_TREE_TYPES.CONFIRM_DELETE_TREE_TYPE.MESSAGE",{name:e.name})}}).afterClosed().subscribe(r=>{r&&e.id!==void 0&&this.treeTypeService.deleteTreeType(e.id).subscribe({next:()=>{this.snackBar.open(this.translate.instant("ADMIN_TREE_TYPES.TREE_TYPE_DELETED"),this.translate.instant("COMMON.CLOSE"),{duration:3e3}),this.loadTreeTypes()},error:o=>{console.error("Error al eliminar tipo de \xE1rbol",o);let p=this.translate.instant(o?.error?.message);this.snackBar.open(p,this.translate.instant("COMMON.CLOSE"),{duration:3e3})}})})}static{this.\u0275fac=function(t){return new(t||n)(x(Yt),x(ae),x(Me),x(ze),x(z),x(ge))}}static{this.\u0275cmp=P({type:n,selectors:[["app-admin-tree-types"]],standalone:!0,features:[N],decls:25,vars:23,consts:[[1,"p-4"],[1,"flex","justify-between","items-center","mb-4"],["type","text",1,"w-64","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"ngModelChange","keyup","placeholder","ngModel"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-3","px-4","rounded-xl","hover:bg-green-700","transition",3,"click"],[1,"flex","flex-col","gap-4"],["class","border rounded p-4 shadow-sm flex justify-between items-center w-full",4,"ngFor","ngForOf"],[1,"mt-6","flex","justify-center","items-center","gap-4"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-2","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click","disabled"],[1,"text-gray-700","font-medium"],[1,"border","rounded","p-4","shadow-sm","flex","justify-between","items-center","w-full"],[1,"flex","flex-col","text-left"],[1,"font-semibold","text-lg"],[1,"text-gray-600"],[1,"flex","gap-2"],[1,"bg-green-600","hover:bg-green-700","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"],[1,"text-white",2,"font-size","20px"],[1,"bg-red-500","hover:bg-red-600","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"]],template:function(t,r){t&1&&(s(0,"mat-card",0)(1,"div",1)(2,"input",2),c(3,"translate"),be("ngModelChange",function(p){return Se(r.filterText,p)||(r.filterText=p),p}),T("keyup",function(){return r.applyFilter()}),l(),s(4,"button",3),T("click",function(){return r.addTreeType()}),s(5,"mat-icon"),d(6,"add"),l(),d(7),c(8,"translate"),l()(),s(9,"div",4),E(10,Is,19,8,"div",5),l(),s(11,"div",6)(12,"button",7),T("click",function(){return r.previousPage()}),s(13,"mat-icon"),d(14,"chevron_left"),l(),d(15),c(16,"translate"),l(),s(17,"span",8),d(18),c(19,"translate"),l(),s(20,"button",7),T("click",function(){return r.nextPage()}),d(21),c(22,"translate"),s(23,"mat-icon"),d(24,"chevron_right"),l()()()()),t&2&&(a(2),te("placeholder",u(3,9,"ADMIN_TREE_TYPES.SEARCH_PLACEHOLDER")),Te("ngModel",r.filterText),a(5),g(" ",u(8,11,"ADMIN_TREE_TYPES.ADD_BUTTON")," "),a(3),f("ngForOf",r.getPagedTreeTypes()),a(2),f("disabled",r.currentPage===0),a(3),g(" ",u(16,13,"ADMIN_TREE_TYPES.PAGINATION.PREVIOUS")," "),a(3),g(" ",Y(19,15,"ADMIN_TREE_TYPES.PAGINATION.PAGE_INFO",It(20,bs,r.currentPage+1,r.totalPages))," "),a(2),f("disabled",r.currentPage+1>=r.totalPages),a(),g(" ",u(22,18,"ADMIN_TREE_TYPES.PAGINATION.NEXT")," "))},dependencies:[F,ne,Z,J,ee,X,Q,re,De,_e,ye,Ye,L,U]})}}return n})();var ws=n=>({label:"TREE_TYPE.CO2_AT_20_LABEL",value:n}),Ms=n=>({label:"TREE_TYPE.CO2_AT_25_LABEL",value:n}),As=n=>({label:"TREE_TYPE.CO2_AT_30_LABEL",value:n}),Ps=n=>({label:"TREE_TYPE.CO2_AT_35_LABEL",value:n}),Ns=n=>({label:"TREE_TYPE.CO2_AT_40_LABEL",value:n}),Os=(n,i,e,t,r)=>[n,i,e,t,r];function Rs(n,i){if(n&1&&(s(0,"p",5)(1,"em"),d(2),l()()),n&2){let e=_(2);a(2),y(e.treeType.scientificName)}}function Ds(n,i){if(n&1&&(s(0,"div")(1,"div",13)(2,"p",14),d(3),c(4,"translate"),l(),s(5,"p",15),d(6),c(7,"translate"),l()()()),n&2){let e=i.$implicit;a(3),y(u(4,2,e.label)),a(3),g(" ",e.value!==void 0&&e.value!==null?e.value+" "+u(7,4,"TREE_TYPE.CO2_UNIT"):"-"," ")}}function Ls(n,i){if(n&1){let e=j();s(0,"div",16)(1,"button",17),T("click",function(){I(e);let r=_(2);return w(r.goToEditForm())}),d(2),c(3,"translate"),l()()}n&2&&(a(2),g(" ",u(3,1,"TREE_TYPE.EDIT_BUTTON")," "))}function ks(n,i){if(n&1&&(s(0,"mat-card",1),A(1,"img",2),s(2,"h2",3),d(3),l(),E(4,Rs,3,1,"p",4),s(5,"p",5),d(6),c(7,"translate"),l(),s(8,"div",6)(9,"p",7),d(10),c(11,"translate"),l(),s(12,"div",8),E(13,Ds,8,6,"div",9),l()(),s(14,"div",10)(15,"div")(16,"p",11),d(17),c(18,"translate"),l(),s(19,"p"),d(20),c(21,"translate"),l()(),s(22,"div")(23,"p",11),d(24),c(25,"translate"),l(),s(26,"p"),d(27),c(28,"translate"),l()()(),E(29,Ls,4,3,"div",12),l()),n&2){let e=_();a(),f("src",e.previewImage||"assets/tree_placeholder.png",je)("alt",e.treeType.name),a(2),y(e.treeType.name),a(),f("ngIf",e.treeType.scientificName),a(2),y(e.treeType.description||u(7,14,"TREE_TYPE.NO_DESCRIPTION")),a(4),g("",u(11,16,"TREE_TYPE.CO2_ESTIMATIONS_TITLE")," "),a(3),f("ngForOf",Kn(36,Os,me(26,ws,e.treeType.co2AbsorptionAt20),me(28,Ms,e.treeType.co2AbsorptionAt25),me(30,As,e.treeType.co2AbsorptionAt30),me(32,Ps,e.treeType.co2AbsorptionAt35),me(34,Ns,e.treeType.co2AbsorptionAt40))),a(4),y(u(18,18,"TREE_TYPE.TYPICAL_HEIGHT_LABEL")),a(3),W("",e.treeType.typicalHeight," ",u(21,20,"TREE_TYPE.HEIGHT_UNIT"),""),a(4),y(u(25,22,"TREE_TYPE.LIFESPAN_LABEL")),a(3),W("",e.treeType.lifespanYears," ",u(28,24,"TREE_TYPE.YEARS_UNIT"),""),a(2),f("ngIf",e.isEditable)}}var Yr=(()=>{class n{constructor(e,t,r,o,p){this.route=e,this.router=t,this.treeTypeService=r,this.snackBar=o,this.userService=p,this.previewImage=null,this.user=null,this.isEditable=!1}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");this.user=this.userService.getCurrentUser(),e&&this.treeTypeService.getTreeTypeById(+e).subscribe({next:t=>{this.treeType=t,this.previewImage=t.picture||"assets/tree_placeholder.png",this.isEditable=this.user?.role===M.ADMIN},error:t=>{console.error("\u274C Error al cargar tipo de \xE1rbol",t),this.snackBar.open("Error al cargar el tipo de \xE1rbol","Cerrar",{duration:3e3})}})}goToEditForm(){console.log("this.treeType?.id",this.treeType?.id),this.treeType?.id&&this.router.navigate(["/admin/tree-type-form",this.treeType.id])}static{this.\u0275fac=function(t){return new(t||n)(x(Re),x(z),x(Yt),x(Me),x(ae))}}static{this.\u0275cmp=P({type:n,selectors:[["app-tree-types-view"]],standalone:!0,features:[N],decls:1,vars:1,consts:[["class","rounded-2xl shadow-md p-4 md:p-6 flex flex-col items-center text-center w-full max-w-full",4,"ngIf"],[1,"rounded-2xl","shadow-md","p-4","md:p-6","flex","flex-col","items-center","text-center","w-full","max-w-full"],[1,"w-24","h-24","rounded-full","shadow-lg","mb-4","object-cover",3,"src","alt"],[1,"text-xl","md:text-2xl","font-semibold"],["class","text-gray-500 italic",4,"ngIf"],[1,"text-gray-500","italic"],[1,"w-full","mt-6","text-left"],[1,"font-semibold","text-gray-700","mb-2"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-4","w-full"],[4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4","mt-6","text-left","w-full","max-w-md"],[1,"font-semibold","text-gray-700"],["class","flex gap-4 mt-6 justify-center",4,"ngIf"],[1,"bg-white","shadow-md","rounded-lg","p-4","flex","flex-col","items-center","w-full"],[1,"font-semibold","text-gray-700","mb-1","text-center"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","gap-4","mt-6","justify-center"],[1,"bg-green-600","text-white","py-3","px-6","rounded-xl","hover:bg-green-700","transition",3,"click"]],template:function(t,r){t&1&&E(0,ks,30,42,"mat-card",0),t&2&&f("ngIf",r.treeType)},dependencies:[F,ne,H,J,ee,X,Q,L,U]})}}return n})();function Bs(n,i){if(n&1){let e=j();s(0,"div",9)(1,"div",10)(2,"div",11),d(3),l(),s(4,"div",12),d(5),l(),s(6,"div",13),d(7),l()(),s(8,"div",14)(9,"button",15),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onView(r))}),s(10,"mat-icon",16),d(11,"visibility"),l()(),s(12,"button",15),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onEdit(r))}),s(13,"mat-icon",16),d(14,"edit"),l()(),s(15,"button",17),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onDelete(r))}),s(16,"mat-icon",16),d(17,"delete"),l()()()()}if(n&2){let e=i.$implicit;a(3),y(e.name),a(2),y(e.location||"\u2014"),a(2),g("",e.area||"\u2014"," m\xB2")}}var zr=(()=>{class n{constructor(e,t,r,o,p,m){this.landService=e,this.userService=t,this.snackBar=r,this.dialog=o,this.router=p,this.translate=m,this.lands=[],this.filteredLands=[],this.currentPage=0,this.pageSize=5,this.totalPages=1,this.filterText=""}ngOnInit(){this.loadLands()}loadLands(){let e=this.userService.getCurrentUser(),t=e?.company?.id;this.landService.getAllLands().subscribe({next:r=>{e?.role===M.COMPANY_ADMIN&&t!=null?this.lands=r.filter(o=>(o.companyIds||[]).includes(t)):this.lands=r,this.applyFilter()},error:r=>console.error("\u274C Error al cargar terrenos",r)})}applyFilter(){let e=this.filterText.trim().toLowerCase();this.filteredLands=this.lands.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.location||"").toLowerCase().includes(e)),this.currentPage=0,this.totalPages=Math.ceil(this.filteredLands.length/this.pageSize)}getPagedLands(){let e=this.currentPage*this.pageSize;return this.filteredLands.slice(e,e+this.pageSize)}previousPage(){this.currentPage>0&&this.currentPage--}nextPage(){this.currentPage+1<this.totalPages&&this.currentPage++}addLand(){this.router.navigate(["/admin/land-form"])}onEdit(e){this.router.navigate(["/admin/land-form",e.id])}onView(e){this.router.navigate(["/land",e.id])}onDelete(e){if(!e.id)return;this.dialog.open(tt,{width:"400px",data:{title:this.translate.instant("COMMON.CONFIRM_DELETE"),message:this.translate.instant("COMMON.CONFIRM_DELETE_MESSAGE",{name:e.name})}}).afterClosed().subscribe(r=>{r&&e.id!==void 0&&this.landService.deleteLand(e.id).subscribe({next:()=>{this.snackBar.open(this.translate.instant("ADMIN_LANDS.LAND_DELETED"),this.translate.instant("COMMON.CLOSE"),{duration:3e3}),this.loadLands()},error:o=>{console.error("Error al eliminar terreno",o),this.snackBar.open(this.translate.instant("ADMIN_LANDS.LAND_DELETE_ERROR"),this.translate.instant("COMMON.CLOSE"),{duration:3e3})}})})}static{this.\u0275fac=function(t){return new(t||n)(x(mi),x(ae),x(Me),x(ze),x(z),x(ge))}}static{this.\u0275cmp=P({type:n,selectors:[["app-admin-lands"]],standalone:!0,features:[N],decls:24,vars:18,consts:[[1,"p-4"],[1,"flex","justify-between","items-center","mb-4"],["type","text",1,"w-64","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"ngModelChange","keyup","placeholder","ngModel"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-3","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click"],[1,"flex","flex-col","gap-4"],["class","border rounded p-4 shadow-sm flex justify-between items-center w-full",4,"ngFor","ngForOf"],[1,"mt-6","flex","justify-center","items-center","gap-4"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-2","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click","disabled"],[1,"text-gray-700","font-medium"],[1,"border","rounded","p-4","shadow-sm","flex","justify-between","items-center","w-full"],[1,"flex","flex-col","text-left"],[1,"font-semibold","text-lg"],[1,"text-gray-600"],[1,"text-gray-500","text-sm"],[1,"flex","gap-2"],[1,"bg-green-600","hover:bg-green-700","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"],[1,"text-white",2,"font-size","20px"],[1,"bg-red-500","hover:bg-red-600","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"]],template:function(t,r){t&1&&(s(0,"mat-card",0)(1,"div",1)(2,"input",2),c(3,"translate"),be("ngModelChange",function(p){return Se(r.filterText,p)||(r.filterText=p),p}),T("keyup",function(){return r.applyFilter()}),l(),s(4,"button",3),T("click",function(){return r.addLand()}),s(5,"mat-icon"),d(6,"add"),l(),d(7),c(8,"translate"),l()(),s(9,"div",4),E(10,Bs,18,3,"div",5),l(),s(11,"div",6)(12,"button",7),T("click",function(){return r.previousPage()}),s(13,"mat-icon"),d(14,"chevron_left"),l(),d(15),c(16,"translate"),l(),s(17,"span",8),d(18),l(),s(19,"button",7),T("click",function(){return r.nextPage()}),d(20),c(21,"translate"),s(22,"mat-icon"),d(23,"chevron_right"),l()()()()),t&2&&(a(2),te("placeholder",u(3,10,"LANDS.SEARCH_PLACEHOLDER")),Te("ngModel",r.filterText),a(5),g(" ",u(8,12,"LANDS.NEW_LAND")," "),a(3),f("ngForOf",r.getPagedLands()),a(2),f("disabled",r.currentPage===0),a(3),g(" ",u(16,14,"LANDS.PREVIOUS")," "),a(3),W("",r.currentPage+1," / ",r.totalPages,""),a(),f("disabled",r.currentPage+1>=r.totalPages),a(),g(" ",u(21,16,"LANDS.NEXT")," "))},dependencies:[F,ne,Z,J,ee,X,Q,re,De,_e,ye,Ye,L,U]})}}return n})();function js(n,i){if(n&1){let e=j();s(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10),d(4),l(),s(5,"div",11),d(6),l(),s(7,"div",11),d(8),c(9,"translate"),l()()(),s(10,"div",12)(11,"button",13),T("click",function(){let r=I(e).$implicit,o=_();return w(o.goToTree(r.id))}),s(12,"mat-icon"),d(13,"chevron_right"),l()()()()}if(n&2){let e=i.$implicit;a(4),y(e.customName||e.treeTypeName),a(2),g(" ",e.treeTypeName," "),a(2),W(" ",u(9,4,"MY_TREES.PLANTED_IN")," ",e.landName," ")}}function Us(n,i){if(n&1){let e=j();s(0,"div",14)(1,"button",15),T("click",function(){I(e);let r=_();return w(r.previousPage())}),s(2,"mat-icon"),d(3,"chevron_left"),l(),d(4),c(5,"translate"),l(),s(6,"span",16),d(7),l(),s(8,"button",15),T("click",function(){I(e);let r=_();return w(r.nextPage())}),d(9),c(10,"translate"),s(11,"mat-icon"),d(12,"chevron_right"),l()()()}if(n&2){let e=_();a(),f("disabled",e.currentPage===0),a(3),g(" ",u(5,6,"MY_TREES.PREVIOUS")," "),a(3),W("",e.currentPage+1," / ",e.totalPages,""),a(),f("disabled",e.currentPage+1>=e.totalPages),a(),g(" ",u(10,8,"MY_TREES.NEXT")," ")}}var Gr=(()=>{class n{constructor(e,t,r){this.treeService=e,this.auth=t,this.router=r,this.loading=!0,this.error=null,this.trees=[],this.filteredTrees=[],this.filterText="",this.currentPage=0,this.pageSize=10,this.totalPages=1}ngOnInit(){let e=this.auth.getUser();if(!e){this.error="No hay usuario en sesi\xF3n.",this.loading=!1;return}let t=e.company?.id??void 0,r=t?void 0:e.id??void 0;this.treeService.getAllTreesByOwner(r,t).subscribe({next:o=>{this.trees=o,this.applyFilter(),this.loading=!1},error:o=>{console.error(o),this.error="Error al cargar tus \xE1rboles.",this.loading=!1}})}applyFilter(){let e=this.filterText.toLowerCase();this.filteredTrees=this.trees.filter(t=>(t.treeTypeName||"").toLowerCase().includes(e)),this.currentPage=0,this.totalPages=Math.ceil(this.filteredTrees.length/this.pageSize)}getPagedTrees(){let e=this.currentPage*this.pageSize;return this.filteredTrees.slice(e,e+this.pageSize)}previousPage(){this.currentPage>0&&this.currentPage--}nextPage(){this.currentPage+1<this.totalPages&&this.currentPage++}buyNewTree(){this.router.navigate(["/buy-tree"])}goToTree(e){this.router.navigate(["/tree",e])}static{this.\u0275fac=function(t){return new(t||n)(x(st),x(oe),x(z))}}static{this.\u0275cmp=P({type:n,selectors:[["app-my-trees"]],standalone:!0,features:[N],decls:12,vars:9,consts:[[1,"p-4"],[1,"flex","justify-between","items-center","mb-4"],["type","text",1,"w-64","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"ngModelChange","keyup","placeholder","ngModel"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-3","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click"],[1,"flex","flex-col","gap-4"],["class","border rounded p-4 shadow-sm flex justify-between items-center w-full",4,"ngFor","ngForOf"],["class","mt-6 flex justify-center items-center gap-4",4,"ngIf"],[1,"border","rounded","p-4","shadow-sm","flex","justify-between","items-center","w-full"],[1,"flex","items-center","gap-4"],[1,"flex","flex-col","text-left"],[1,"font-semibold","text-lg"],[1,"text-gray-600"],[1,"flex","gap-2"],[1,"bg-green-600","hover:bg-green-700","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"],[1,"mt-6","flex","justify-center","items-center","gap-4"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-2","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click","disabled"],[1,"text-gray-700","font-medium"]],template:function(t,r){t&1&&(s(0,"mat-card",0)(1,"div",1)(2,"input",2),c(3,"translate"),be("ngModelChange",function(p){return Se(r.filterText,p)||(r.filterText=p),p}),T("keyup",function(){return r.applyFilter()}),l(),s(4,"button",3),T("click",function(){return r.buyNewTree()}),s(5,"mat-icon"),d(6,"add"),l(),d(7),c(8,"translate"),l()(),s(9,"div",4),E(10,js,14,6,"div",5),l(),E(11,Us,13,10,"div",6),l()),t&2&&(a(2),te("placeholder",u(3,5,"MY_TREES.SEARCH_PLACEHOLDER")),Te("ngModel",r.filterText),a(5),g(" ",u(8,7,"MY_TREES.BUY_NEW_TREE")," "),a(3),f("ngForOf",r.getPagedTrees()),a(),f("ngIf",r.totalPages>1))},dependencies:[F,ne,H,De,_e,ye,Ye,J,ee,Q,re,L,U],styles:[".my-trees-container[_ngcontent-%COMP%]{max-width:900px;margin:auto;padding:20px}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%], .empty[_ngcontent-%COMP%]{font-size:1.2rem;margin-top:20px}.error[_ngcontent-%COMP%]{color:#d9534f}.tree-list[_ngcontent-%COMP%]{margin-top:20px;display:grid;gap:20px}.tree-card[_ngcontent-%COMP%]{border:1px solid #ddd;padding:15px;border-radius:10px;background:#fafafa}"]})}}return n})();var Kr=(()=>{class n{constructor(e){this.data=e}static{this.\u0275fac=function(t){return new(t||n)(x(Ft))}}static{this.\u0275cmp=P({type:n,selectors:[["app-land-info-modal"]],standalone:!0,features:[N],decls:18,vars:3,consts:[["mat-dialog-title",""],["align","end"],["mat-dialog-close","",1,"bg-green-600","text-white","px-4","py-2","rounded-lg","hover:bg-green-700","transition"]],template:function(t,r){t&1&&(s(0,"h2",0),d(1,"Informaci\xF3n del Terreno"),l(),s(2,"mat-dialog-content")(3,"p")(4,"strong"),d(5,"Nombre:"),l(),d(6),l(),s(7,"p")(8,"strong"),d(9,"Superficie:"),l(),d(10),l(),s(11,"p")(12,"strong"),d(13,"Ubicaci\xF3n:"),l(),d(14),l()(),s(15,"mat-dialog-actions",1)(16,"button",2),d(17," Cerrar "),l()()),t&2&&(a(6),g(" ",r.data.land==null?null:r.data.land.name,""),a(4),g(" ",r.data.land==null?null:r.data.land.area," m\xB2"),a(4),g(" ",r.data.land==null?null:r.data.land.location,""))},dependencies:[F,Vt,pi,Bt,Ut,jt,X],encapsulation:2})}}return n})();var qr=(()=>{class n{constructor(e){this.data=e}static{this.\u0275fac=function(t){return new(t||n)(x(Ft))}}static{this.\u0275cmp=P({type:n,selectors:[["app-tree-type-info-modal"]],standalone:!0,features:[N],decls:18,vars:3,consts:[["mat-dialog-title",""],["align","end"],["mat-dialog-close","",1,"bg-green-600","text-white","px-4","py-2","rounded-lg","hover:bg-green-700","transition"]],template:function(t,r){t&1&&(s(0,"h2",0),d(1,"Informaci\xF3n del \xC1rbol"),l(),s(2,"mat-dialog-content")(3,"p")(4,"strong"),d(5,"Especie:"),l(),d(6),l(),s(7,"p")(8,"strong"),d(9,"Altura:"),l(),d(10),l(),s(11,"p")(12,"strong"),d(13,"Edad Aproximada:"),l(),d(14),l()(),s(15,"mat-dialog-actions",1)(16,"button",2),d(17," Cerrar "),l()()),t&2&&(a(6),g(" ",r.data.tree==null?null:r.data.tree.scientificName,""),a(4),g(" ",r.data.tree==null?null:r.data.tree.height," m"),a(4),g(" ",r.data.tree==null?null:r.data.tree.age," a\xF1os"))},dependencies:[F,Vt,pi,Bt,Ut,jt,X],encapsulation:2})}}return n})();var $r=(()=>{class n{constructor(e){this.dialog=e}openLandInfoModal(e){return this.dialog.open(Kr,{width:"450px",data:{land:e}})}openTreeTypeInfoModal(e){return this.dialog.open(qr,{width:"450px",data:{tree:e}})}static{this.\u0275fac=function(t){return new(t||n)(we(ze))}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Hr=(()=>{class n{constructor(e){this.purchaseApi=e}purchaseTrees(e){return this.purchaseApi.purchaseTrees(e)}static{this.\u0275fac=function(t){return new(t||n)(we(cr))}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function zs(n,i){if(n&1&&(s(0,"mat-option",12),d(1),l()),n&2){let e=i.$implicit;f("value",e.id),a(),g(" ",e.name," ")}}function Gs(n,i){if(n&1){let e=j();le(0),s(1,"h2",7),d(2),c(3,"translate"),l(),s(4,"mat-select",8),c(5,"translate"),be("valueChange",function(r){I(e);let o=_();return Se(o.selectedLand,r)||(o.selectedLand=r),w(r)}),T("selectionChange",function(r){I(e);let o=_();return w(o.onLandSelected(r.value))}),E(6,zs,2,2,"mat-option",9),l(),s(7,"div",10)(8,"button",11),T("click",function(){I(e);let r=_();return w(r.nextStep())}),d(9),c(10,"translate"),l()(),de()}if(n&2){let e=_();a(2),y(u(3,6,"BUY_TREE.SELECT_LAND")),a(2),te("placeholder",u(5,8,"BUY_TREE.SELECT_LAND_PLACEHOLDER")),Te("value",e.selectedLand),a(2),f("ngForOf",e.lands),a(2),f("disabled",!e.selectedLand),a(),g(" ",u(10,10,"BUY_TREE.NEXT")," ")}}function Ks(n,i){if(n&1){let e=j();le(0),s(1,"h2",7),d(2),c(3,"translate"),l(),s(4,"div",13)(5,"button",14),T("click",function(){I(e);let r=_();return w(r.decrease())}),s(6,"mat-icon"),d(7,"remove"),l()(),s(8,"div",15),d(9),l(),s(10,"button",14),T("click",function(){I(e);let r=_();return w(r.increase())}),s(11,"mat-icon"),d(12,"add"),l()()(),s(13,"div",16)(14,"p",17),d(15),c(16,"translate"),c(17,"number"),l()(),s(18,"div",18)(19,"button",19),T("click",function(){I(e);let r=_();return w(r.prevStep())}),d(20),c(21,"translate"),l(),s(22,"button",19),T("click",function(){I(e);let r=_();return w(r.nextStep())}),d(23),c(24,"translate"),l()(),de()}if(n&2){let e=_();a(2),y(u(3,6,"BUY_TREE.SELECT_QUANTITY")),a(7),g(" ",e.quantity," "),a(6),W(" ",u(16,8,"BUY_TREE.TOTAL"),": ",Y(17,10,e.totalPrice,"1.2-2")," \u20AC "),a(5),g(" ",u(21,13,"BUY_TREE.BACK")," "),a(3),g(" ",u(24,15,"BUY_TREE.NEXT")," ")}}function qs(n,i){if(n&1){let e=j();le(0),s(1,"h2",7),d(2),c(3,"translate"),l(),s(4,"p")(5,"strong"),d(6),c(7,"translate"),l(),d(8),l(),s(9,"p")(10,"strong"),d(11),c(12,"translate"),l(),d(13),l(),s(14,"p")(15,"strong"),d(16),c(17,"translate"),l(),d(18),c(19,"number"),l(),s(20,"p")(21,"strong"),d(22),c(23,"translate"),l(),d(24),l(),s(25,"p",20),d(26),c(27,"translate"),c(28,"number"),l(),s(29,"div",21)(30,"button",19),T("click",function(){I(e);let r=_();return w(r.prevStep())}),d(31),c(32,"translate"),l(),s(33,"button",22),T("click",function(){I(e);let r=_();return w(r.confirmPurchase())}),d(34),c(35,"translate"),l()(),de()}if(n&2){let e=_();a(2),y(u(3,13,"BUY_TREE.SUMMARY")),a(4),g("",u(7,15,"BUY_TREE.LAND"),":"),a(2),g(" ",e.selectedLandName,""),a(3),g("",u(12,17,"BUY_TREE.TREE"),":"),a(2),g(" ",e.selectedTreeType==null?null:e.selectedTreeType.name,""),a(3),g("",u(17,19,"BUY_TREE.UNIT_PRICE"),":"),a(2),g(" ",Y(19,21,e.unitPrice,"1.2-2")," \u20AC "),a(4),g("",u(23,24,"BUY_TREE.QUANTITY"),":"),a(2),g(" ",e.quantity,""),a(2),W(" ",u(27,26,"BUY_TREE.TOTAL"),": ",Y(28,28,e.totalPrice,"1.2-2")," \u20AC "),a(5),g(" ",u(32,31,"BUY_TREE.BACK")," "),a(3),g(" ",u(35,33,"BUY_TREE.CONFIRM")," ")}}function $s(n,i){if(n&1&&A(0,"img",26),n&2){let e=_(2);f("src",e.selectedLandInfo.picture,je)}}function Hs(n,i){if(n&1){let e=j();s(0,"mat-card",23)(1,"h3",24),d(2),l(),E(3,$s,1,1,"img",25),s(4,"p"),d(5),l(),s(6,"button",19),T("click",function(){I(e);let r=_();return w(r.openLandInfoModal(r.selectedLandInfo))}),d(7),c(8,"translate"),l()()}if(n&2){let e=_();a(2),y(e.selectedLandInfo.name),a(),f("ngIf",e.selectedLandInfo.picture),a(2),y(e.selectedLandInfo.location),a(2),g(" ",u(8,4,"COMMON.MORE_INFO")," ")}}var Wr=(()=>{class n{constructor(e,t,r,o,p,m){this.landService=e,this.treeTypeService=t,this.modalService=r,this.snackBar=o,this.purchaseService=p,this.router=m,this.step=1,this.lands=[],this.selectedLand=null,this.selectedLandInfo=null,this.treeTypes=[],this.selectedTreeType=null,this.selectedTreeTypeInfo=null,this.defaultTreePrice=2,this.treePrices={7:10},this.quantity=1}ngOnInit(){this.loadLands(),this.loadTreeTypes()}loadLands(){this.landService.getAllLands().subscribe({next:e=>this.lands=e,error:e=>console.error("Error cargando lands:",e)})}loadTreeTypes(){this.treeTypeService.getAllTreeTypes().subscribe({next:e=>this.treeTypes=e,error:e=>console.error("Error cargando tipos de \xE1rbol:",e)})}onLandSelected(e){this.selectedLand=e,this.selectedTreeType=this.treeTypes.find(t=>t.id===7),this.selectedLandInfo=this.lands.find(t=>t.id===e)??null}onTreeSelected(e){this.selectedTreeType=e,this.selectedTreeTypeInfo=e}openLandInfoModal(e){this.modalService.openLandInfoModal(e)}openTreeInfoModal(e){this.modalService.openLandInfoModal(e)}get selectedLandName(){return this.lands.find(e=>e.id===this.selectedLand)?.name??""}get totalPrice(){if(!this.selectedTreeType)return 0;let e=this.selectedTreeType.id,t=this.treePrices[e]??this.defaultTreePrice;return this.quantity*t}get unitPrice(){return this.selectedTreeType?this.treePrices[this.selectedTreeType.id]??this.defaultTreePrice:0}nextStep(){this.step<4&&this.step++}prevStep(){this.step>1&&this.step--}increase(){this.quantity++}decrease(){this.quantity>1&&this.quantity--}confirmPurchase(){if(!this.selectedLand||!this.selectedTreeType)return;let e={landId:this.selectedLand,treeTypeId:this.selectedTreeType.id,quantity:this.quantity,pricePerUnit:this.unitPrice};this.purchaseService.purchaseTrees(e).subscribe({next:t=>{this.router.navigate(["/home"]),this.snackBar.open(`Compra confirmada: ${this.selectedTreeType?.name} x${this.quantity}`,"Cerrar",{duration:5e3,panelClass:["bg-green-600","text-white"]}),this.step=1,this.selectedLand=null,this.selectedLandInfo=null,this.selectedTreeType=null,this.selectedTreeTypeInfo=null,this.quantity=1},error:t=>{console.error("Error al realizar la compra",t),this.snackBar.open("Error al confirmar la compra","Cerrar",{duration:5e3,panelClass:["bg-red-600","text-white"]})}})}static{this.\u0275fac=function(t){return new(t||n)(x(mi),x(Yt),x($r),x(Me),x(Hr),x(z))}}static{this.\u0275cmp=P({type:n,selectors:[["app-buy-tree"]],standalone:!0,features:[N],decls:11,vars:7,consts:[[1,"max-w-6xl","mx-auto","p-6","flex","gap-6"],[1,"flex-grow"],[1,"text-3xl","font-bold","mb-6","text-green-700"],[1,"p-6","shadow-md","rounded-xl"],[4,"ngIf"],[1,"w-80"],["class","p-4",4,"ngIf"],[1,"text-2xl","font-semibold","mb-4"],[1,"w-full",3,"valueChange","selectionChange","value","placeholder"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","justify-end","mt-6"],[1,"bg-green-600","text-white","px-4","py-2","rounded-lg","hover:bg-green-700","transition","disabled:opacity-40",3,"click","disabled"],[3,"value"],[1,"flex","items-center","gap-4"],[1,"bg-green-600","text-white","w-10","h-10","rounded-full","flex","items-center","justify-center","hover:bg-green-700",3,"click"],[1,"text-3xl","font-bold","w-16","text-center"],[1,"flex","justify-end","mt-4"],[1,"text-xl","font-bold"],[1,"mt-6","flex","justify-between"],[1,"bg-green-600","text-white","px-4","py-2","rounded-lg","hover:bg-green-700","transition","disabled:opacity-40",3,"click"],[1,"text-xl","font-bold","mt-3"],[1,"flex","justify-between","mt-6"],[1,"bg-yellow-500","text-white","px-4","py-2","rounded-lg","hover:bg-yellow-600","transition",3,"click"],[1,"p-4"],[1,"text-xl","font-bold","mb-2"],["class","rounded mb-3",3,"src",4,"ngIf"],[1,"rounded","mb-3",3,"src"]],template:function(t,r){t&1&&(s(0,"div",0)(1,"div",1)(2,"h1",2),d(3),c(4,"translate"),l(),s(5,"mat-card",3),E(6,Gs,11,12,"ng-container",4)(7,Ks,25,17,"ng-container",4)(8,qs,36,35,"ng-container",4),l()(),s(9,"div",5),E(10,Hs,9,6,"mat-card",6),l()()),t&2&&(a(3),g(" ",u(4,5,"BUY_TREE.TITLE")," "),a(3),f("ngIf",r.step===1),a(),f("ngIf",r.step===2),a(),f("ngIf",r.step===3),a(2),f("ngIf",r.step===1&&r.selectedLandInfo))},dependencies:[F,ne,H,Mt,J,ee,Q,re,di,_r,rr,X,L,U]})}}return n})();function Ws(n,i){if(n&1&&(le(0),d(1),de()),n&2){let e=_(2);a(),y(e.tree.customName)}}function Qs(n,i){if(n&1&&(le(0),d(1),de()),n&2){let e=_(3);a(),y(e.tree.treeType.name)}}function Xs(n,i){if(n&1&&E(0,Qs,2,1,"ng-container",9),n&2){_();let e=Ue(7),t=_();f("ngIf",t.tree.treeType)("ngIfElse",e)}}function Zs(n,i){n&1&&(d(0),c(1,"translate")),n&2&&y(u(1,1,"TREE.ARBOL_SIN_TIPO"))}function Js(n,i){if(n&1&&(le(0),d(1),de()),n&2){let e=_(2);a(),y(e.tree.scientificName)}}function el(n,i){n&1&&(d(0),c(1,"translate")),n&2&&y(u(1,1,"TREE.ESPECIE_NO_DEFINIDA"))}function tl(n,i){if(n&1&&(le(0),d(1),de()),n&2){let e=_(2);a(),y(e.tree.land.name)}}function il(n,i){n&1&&(d(0),c(1,"translate")),n&2&&y(u(1,1,"TREE.SIN_ASIGNAR"))}function nl(n,i){if(n&1&&(s(0,"div",12)(1,"span",13),d(2),c(3,"translate"),l(),s(4,"span"),d(5),c(6,"date"),l()()),n&2){let e=_(2);a(2),y(u(3,2,"TREE.PLANTACION_PLANIFICADA")),a(3),y(Y(6,4,e.tree.plannedPlantation.plannedDate,"dd/MM/yyyy"))}}function rl(n,i){n&1&&(s(0,"div",12)(1,"span",13),d(2),c(3,"translate"),l(),s(4,"span"),d(5),c(6,"translate"),l()()),n&2&&(a(2),y(u(3,2,"TREE.PLANTACION_PLANIFICADA")),a(3),y(u(6,4,"TREE.SIN_ASIGNAR")))}function ol(n,i){if(n&1){let e=j();s(0,"button",24),T("click",function(){I(e);let r=_(2);return w(r.goToEdit())}),d(1),c(2,"translate"),l()}n&2&&(a(),g(" ",u(2,1,"PROFILE.EDIT_BUTTON")," "))}function al(n,i){if(n&1&&(s(0,"div",29)(1,"div",13),d(2),c(3,"translate"),l(),s(4,"div"),d(5),l()()),n&2){let e=_(3);a(2),y(u(3,2,"TREE.DESCRIPCION")),a(3),y(e.tree.treeType.description)}}function sl(n,i){if(n&1&&(s(0,"div",12)(1,"span",13),d(2),c(3,"translate"),l(),s(4,"span"),d(5),l()()),n&2){let e=_(3);a(2),y(u(3,2,"TREE.CO2_ABSORCION_TIPO")),a(3),g("",e.tree.treeType.co2AbsorptionAt20," kg/a\xF1o")}}function ll(n,i){if(n&1&&(s(0,"div",12)(1,"span",13),d(2),c(3,"translate"),l(),s(4,"span"),d(5),l()()),n&2){let e=_(3);a(2),y(u(3,2,"TREE.ALTURA_TIPICA")),a(3),g("",e.tree.treeType.typicalHeight," m")}}function dl(n,i){if(n&1&&(s(0,"div",12)(1,"span",13),d(2),c(3,"translate"),l(),s(4,"span"),d(5),l()()),n&2){let e=_(3);a(2),y(u(3,2,"TREE.VIDA_UTIL")),a(3),g("",e.tree.treeType.lifespanYears," a\xF1os")}}function pl(n,i){if(n&1&&(s(0,"div",25)(1,"h3",26),d(2),c(3,"translate"),l(),E(4,al,6,4,"div",27)(5,sl,6,4,"div",28)(6,ll,6,4,"div",28)(7,dl,6,4,"div",28),l()),n&2){let e=_(2);a(2),y(u(3,5,"TREE.INFORMACION_TIPO_ARBOL")),a(2),f("ngIf",e.tree.treeType.description),a(),f("ngIf",e.tree.treeType.co2AbsorptionAt20),a(),f("ngIf",e.tree.treeType.typicalHeight),a(),f("ngIf",e.tree.treeType.lifespanYears)}}function cl(n,i){if(n&1&&(s(0,"div",12)(1,"span",13),d(2),c(3,"translate"),l(),s(4,"span"),d(5),l()()),n&2){let e=_(3);a(2),y(u(3,2,"TREE.UBICACION")),a(3),y(e.tree.land.location)}}function ml(n,i){if(n&1&&(s(0,"div",12)(1,"span",13),d(2),c(3,"translate"),l(),s(4,"span"),d(5),l()()),n&2){let e=_(3);a(2),y(u(3,2,"TREE.AREA")),a(3),g("",e.tree.land.area," m\xB2")}}function ul(n,i){if(n&1&&(s(0,"div",12)(1,"span",13),d(2),c(3,"translate"),l(),s(4,"span"),d(5),l()()),n&2){let e=_(3);a(2),y(u(3,2,"TREE.MAX_ARBOLES")),a(3),y(e.tree.land.maxTrees)}}function fl(n,i){if(n&1&&(s(0,"div",25)(1,"h3",26),d(2),c(3,"translate"),l(),s(4,"div",12)(5,"span",13),d(6),c(7,"translate"),l(),s(8,"span"),d(9),l()(),E(10,cl,6,4,"div",28)(11,ml,6,4,"div",28)(12,ul,6,4,"div",28),l()),n&2){let e=_(2);a(2),y(u(3,6,"TREE.INFORMACION_TERRENO")),a(4),y(u(7,8,"TREE.NOMBRE")),a(3),y(e.tree.land.name),a(),f("ngIf",e.tree.land.location),a(),f("ngIf",e.tree.land.area),a(),f("ngIf",e.tree.land.maxTrees)}}function hl(n,i){if(n&1&&(s(0,"mat-card",6),A(1,"img",7),s(2,"h2",8),E(3,Ws,2,1,"ng-container",9)(4,Xs,1,2,"ng-template",null,0,Ve)(6,Zs,2,3,"ng-template",null,1,Ve),l(),s(8,"p",10),d(9),c(10,"translate"),l(),s(11,"div",11)(12,"div",12)(13,"span",13),d(14),c(15,"translate"),l(),s(16,"span"),d(17),l()(),s(18,"div",12)(19,"span",13),d(20),c(21,"translate"),l(),s(22,"span"),E(23,Js,2,1,"ng-container",9)(24,el,2,3,"ng-template",null,2,Ve),l()(),s(26,"div",14)(27,"span",15),d(28),c(29,"translate"),l(),s(30,"div",16)(31,"div",17)(32,"div",18),d(33),c(34,"translate"),l(),s(35,"div",19),d(36),c(37,"translate"),l()(),s(38,"div",17)(39,"div",18),d(40),c(41,"translate"),l(),s(42,"div",19),d(43),c(44,"translate"),l()(),s(45,"div",17)(46,"div",18),d(47),c(48,"translate"),l(),s(49,"div",19),d(50),c(51,"translate"),l()(),s(52,"div",17)(53,"div",18),d(54),c(55,"translate"),l(),s(56,"div",19),d(57),c(58,"translate"),l()(),s(59,"div",17)(60,"div",18),d(61),c(62,"translate"),l(),s(63,"div",19),d(64),c(65,"translate"),l()()()(),s(66,"div",12)(67,"span",13),d(68),c(69,"translate"),l(),s(70,"span"),d(71),c(72,"date"),l()(),s(73,"div",12)(74,"span",13),d(75),c(76,"translate"),l(),s(77,"span"),E(78,tl,2,1,"ng-container",9)(79,il,2,3,"ng-template",null,3,Ve),l()(),s(81,"div",12)(82,"span",13),d(83),c(84,"translate"),l(),s(85,"span"),d(86),l()(),E(87,nl,7,7,"div",20)(88,rl,7,6,"ng-template",null,4,Ve),s(90,"div",21),E(91,ol,3,3,"button",22),l()(),E(92,pl,8,7,"div",23)(93,fl,13,10,"div",23),l()),n&2){let e=Ue(5),t=Ue(25),r=Ue(80),o=Ue(89),p=_();a(),f("src",p.tree.picture||"assets/tree.png",je),a(2),f("ngIf",p.tree.customName)("ngIfElse",e),a(6),g(" ",(p.tree.treeType==null?null:p.tree.treeType.name)||u(10,37,"TREE.ARBOL_SIN_TIPO")," "),a(5),y(u(15,39,"TREE.ID_ARBOL")),a(3),y(p.tree.id),a(3),y(u(21,41,"TREE.SPICE")),a(3),f("ngIf",p.tree.scientificName)("ngIfElse",t),a(5),y(u(29,43,"TREE.CO2_ABSORBIDO")),a(5),y(u(34,45,"TREE_TYPE.CO2_AT_20_LABEL")),a(3),W("",p.tree.co2AbsorptionAt20||0," ",u(37,47,"TREE_TYPE.CO2_UNIT"),""),a(4),y(u(41,49,"TREE_TYPE.CO2_AT_25_LABEL")),a(3),W("",p.tree.co2AbsorptionAt25||0," ",u(44,51,"TREE_TYPE.CO2_UNIT"),""),a(4),y(u(48,53,"TREE_TYPE.CO2_AT_30_LABEL")),a(3),W("",p.tree.co2AbsorptionAt30||0," ",u(51,55,"TREE_TYPE.CO2_UNIT"),""),a(4),y(u(55,57,"TREE_TYPE.CO2_AT_35_LABEL")),a(3),W("",p.tree.co2AbsorptionAt35||0," ",u(58,59,"TREE_TYPE.CO2_UNIT"),""),a(4),y(u(62,61,"TREE_TYPE.CO2_AT_40_LABEL")),a(3),W("",p.tree.co2AbsorptionAt40||0," ",u(65,63,"TREE_TYPE.CO2_UNIT"),""),a(4),y(u(69,65,"TREE.PLANTADO_EL")),a(3),y(Y(72,67,p.tree.plantedAt,"dd/MM/yyyy")),a(4),y(u(76,70,"TREE.TERRENO")),a(3),f("ngIf",p.tree.land)("ngIfElse",r),a(5),y(u(84,72,"TREE.PROPIETARIO")),a(3),y(p.getOwner()),a(),f("ngIf",p.tree.plannedPlantation)("ngIfElse",o),a(4),f("ngIf",p.canEdit),a(),f("ngIf",p.tree.treeType),a(),f("ngIf",p.tree.land)}}var Qr=(()=>{class n{constructor(e,t,r,o){this.route=e,this.treeService=t,this.router=r,this.authService=o,this.loading=!0}ngOnInit(){this.loadTree()}loadTree(){let e=Number(this.route.snapshot.paramMap.get("id"));e&&this.treeService.getTreeById(e).subscribe({next:t=>{this.tree=t,this.loading=!1},error:()=>{this.loading=!1,console.error("Error loading tree")}})}getOwner(){return this.tree?.ownerCompanyName?this.tree.ownerCompanyName:this.tree?.ownerUserName?this.tree.ownerUserName:"Sin propietario"}goToEdit(){this.tree?.id&&this.router.navigate(["/tree/form",this.tree.id])}get canEdit(){return this.authService.currentUserRole!=="COMPANY_USER"}static{this.\u0275fac=function(t){return new(t||n)(x(Re),x(st),x(z),x(oe))}}static{this.\u0275cmp=P({type:n,selectors:[["app-tree"]],standalone:!0,features:[N],decls:1,vars:1,consts:[["noCustomName",""],["noType",""],["noscientificName",""],["noLand",""],["noPlanned",""],["class","rounded-2xl shadow-md p-4 md:p-6 w-full max-w-full",4,"ngIf"],[1,"rounded-2xl","shadow-md","p-4","md:p-6","w-full","max-w-full"],["alt","Tree image",1,"w-24","h-24","rounded-full","shadow-lg","mb-4","object-cover","mx-auto",3,"src"],[1,"text-xl","md:text-2xl","font-semibold","text-left"],[4,"ngIf","ngIfElse"],[1,"text-gray-500","italic","text-left"],[1,"mt-4","w-full","text-left","space-y-1"],[1,"flex","justify-between","border-b","py-1"],[1,"font-medium"],[1,"mb-4"],[1,"font-medium","block","mb-2"],[1,"flex","flex-wrap","gap-4"],[1,"bg-gray-100","p-4","rounded-xl","flex-1","min-w-[120px]","text-center","shadow-sm"],[1,"text-sm","text-gray-500"],[1,"font-medium","text-lg"],["class","flex justify-between border-b py-1",4,"ngIf","ngIfElse"],[1,"flex","gap-4","mt-4","w-full","justify-center","md:justify-start"],["class","flex-1 md:flex-auto bg-green-600 text-white py-3 px-6 rounded-xl hover:bg-green-700 transition",3,"click",4,"ngIf"],["class","mt-6 w-full text-left",4,"ngIf"],[1,"flex-1","md:flex-auto","bg-green-600","text-white","py-3","px-6","rounded-xl","hover:bg-green-700","transition",3,"click"],[1,"mt-6","w-full","text-left"],[1,"text-lg","font-semibold","mb-2"],["class","border-b py-1",4,"ngIf"],["class","flex justify-between border-b py-1",4,"ngIf"],[1,"border-b","py-1"]],template:function(t,r){t&1&&E(0,hl,94,74,"mat-card",5),t&2&&f("ngIf",r.tree)},dependencies:[F,H,wt,L,U,J,ee,Z],encapsulation:2})}}return n})();var _l=(n,i)=>({"border-2 border-green-500 shadow-lg bg-green-50":n,"bg-white":i});function yl(n,i){if(n&1&&(s(0,"span"),d(1),c(2,"translate"),c(3,"date"),l()),n&2){let e=_().$implicit;a(),W(" | ",u(2,2,"PLANNED_PLANTATION.EFFECTIVE_DATE"),": ",Y(3,4,e.effectiveDate,"dd/MM/yyyy")," ")}}function vl(n,i){n&1&&(s(0,"span",21),d(1),c(2,"translate"),l()),n&2&&(a(),g(" ",u(2,1,"PLANNED_PLANTATION.ACTIVE")," "))}function xl(n,i){if(n&1){let e=j();s(0,"div",9)(1,"div",10)(2,"div",11),d(3),l(),s(4,"div",12),d(5),c(6,"translate"),c(7,"date"),E(8,yl,4,7,"span",13),l(),s(9,"div",14),d(10),c(11,"translate"),c(12,"translate"),c(13,"translate"),c(14,"translate"),l()(),s(15,"div",15)(16,"div",16)(17,"button",17),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onView(r))}),s(18,"mat-icon",18),d(19,"visibility"),l()(),s(20,"button",17),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onEdit(r))}),s(21,"mat-icon",18),d(22,"edit"),l()(),s(23,"button",19),T("click",function(){let r=I(e).$implicit,o=_();return w(o.onDelete(r))}),s(24,"mat-icon",18),d(25,"delete"),l()()(),E(26,vl,3,3,"span",20),l()()}if(n&2){let e,t=i.$implicit;f("ngClass",It(26,_l,t.isActive,!t.isActive)),a(3),y(t.landName||"\u2014"),a(2),W(" ",u(6,13,"PLANNED_PLANTATION.PLANNED_DATE"),": ",t.plannedDate?Y(7,15,t.plannedDate,"dd/MM/yyyy"):"\u2014"," "),a(3),f("ngIf",t.effectiveDate),a(2),Gn(" ",u(11,18,"PLANNED_PLANTATION.TREES_TITLE"),": ",u(12,20,"PLANNED_PLANTATION.MIN_TREES"),": ",(e=t.minTrees)!==null&&e!==void 0?e:"\u2014",", ",u(13,22,"PLANNED_PLANTATION.OPTIMAL_TREES"),": ",(e=t.optimalTrees)!==null&&e!==void 0?e:"\u2014",", ",u(14,24,"PLANNED_PLANTATION.MAX_TREES"),": ",(e=t.maxTrees)!==null&&e!==void 0?e:"\u2014"," "),a(16),f("ngIf",t.isActive)}}var Xr=(()=>{class n{constructor(e,t,r,o,p,m){this.plannedPlantationService=e,this.userService=t,this.snackBar=r,this.dialog=o,this.router=p,this.translate=m,this.plannedPlantations=[],this.filteredPlannedPlantations=[],this.currentPage=0,this.pageSize=5,this.totalPages=1,this.filterText=""}ngOnInit(){this.loadPlannedPlantations()}loadPlannedPlantations(){this.plannedPlantationService.getAll().subscribe({next:e=>{this.plannedPlantations=e,this.applyFilter()},error:e=>console.error("\u274C Error al cargar plantaciones",e)})}applyFilter(){let e=this.filterText.trim().toLowerCase();this.filteredPlannedPlantations=this.plannedPlantations.filter(t=>(t.landName||"").toLowerCase().includes(e)||(t.plannedDate||"").toLowerCase().includes(e)||(t.effectiveDate||"").toLowerCase().includes(e)),this.currentPage=0,this.totalPages=Math.ceil(this.filteredPlannedPlantations.length/this.pageSize)}getPagedPlannedPlantations(){let e=this.currentPage*this.pageSize;return this.filteredPlannedPlantations.slice(e,e+this.pageSize)}previousPage(){this.currentPage>0&&this.currentPage--}nextPage(){this.currentPage+1<this.totalPages&&this.currentPage++}addPlannedPlantation(){this.router.navigate(["/admin/planned-plantation-form"])}onEdit(e){this.router.navigate(["/admin/planned-plantation-form",e.id])}onView(e){this.router.navigate(["/planned-plantation",e.id])}onDelete(e){if(!e.id)return;this.dialog.open(tt,{width:"400px",data:{title:this.translate.instant("COMMON.CONFIRM_DELETE"),message:this.translate.instant("COMMON.CONFIRM_DELETE_MESSAGE",{name:e.landName||""})}}).afterClosed().subscribe(r=>{r&&e.id!==void 0&&this.plannedPlantationService.delete(e.id).subscribe({next:()=>{this.snackBar.open(this.translate.instant("ADMIN_PLANNED_PLANTATION.DELETED"),this.translate.instant("COMMON.CLOSE"),{duration:3e3}),this.loadPlannedPlantations()},error:o=>{console.error("Error al eliminar plantaci\xF3n",o),this.snackBar.open(this.translate.instant("ADMIN_PLANNED_PLANTATION.DELETE_ERROR"),this.translate.instant("COMMON.CLOSE"),{duration:3e3})}})})}static{this.\u0275fac=function(t){return new(t||n)(x(ui),x(ae),x(Me),x(ze),x(z),x(ge))}}static{this.\u0275cmp=P({type:n,selectors:[["app-admin-planned-plantations"]],standalone:!0,features:[N],decls:24,vars:18,consts:[[1,"p-4"],[1,"flex","justify-between","items-center","mb-4"],["type","text",1,"w-64","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"ngModelChange","keyup","placeholder","ngModel"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-3","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click"],[1,"flex","flex-col","gap-4"],["class","border rounded p-4 shadow-sm flex justify-between items-start w-full",3,"ngClass",4,"ngFor","ngForOf"],[1,"mt-6","flex","justify-center","items-center","gap-4"],[1,"flex","items-center","justify-center","gap-2","bg-green-600","text-white","py-2","px-4","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition",3,"click","disabled"],[1,"text-gray-700","font-medium"],[1,"border","rounded","p-4","shadow-sm","flex","justify-between","items-start","w-full",3,"ngClass"],[1,"flex","flex-col","text-left"],[1,"font-semibold","text-lg"],[1,"text-gray-500","text-sm"],[4,"ngIf"],[1,"text-gray-600","text-sm","mt-1"],[1,"flex","flex-col","items-end","gap-2"],[1,"flex","gap-2"],[1,"bg-green-600","hover:bg-green-700","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"],[1,"text-white",2,"font-size","20px"],[1,"bg-red-500","hover:bg-red-600","text-white","rounded-full","p-2","flex","items-center","justify-center",3,"click"],["class","bg-green-500 text-white text-xs font-semibold px-4 py-1 rounded-full shadow-md",4,"ngIf"],[1,"bg-green-500","text-white","text-xs","font-semibold","px-4","py-1","rounded-full","shadow-md"]],template:function(t,r){t&1&&(s(0,"mat-card",0)(1,"div",1)(2,"input",2),c(3,"translate"),be("ngModelChange",function(p){return Se(r.filterText,p)||(r.filterText=p),p}),T("keyup",function(){return r.applyFilter()}),l(),s(4,"button",3),T("click",function(){return r.addPlannedPlantation()}),s(5,"mat-icon"),d(6,"add"),l(),d(7),c(8,"translate"),l()(),s(9,"div",4),E(10,xl,27,29,"div",5),l(),s(11,"div",6)(12,"button",7),T("click",function(){return r.previousPage()}),s(13,"mat-icon"),d(14,"chevron_left"),l(),d(15),c(16,"translate"),l(),s(17,"span",8),d(18),l(),s(19,"button",7),T("click",function(){return r.nextPage()}),d(20),c(21,"translate"),s(22,"mat-icon"),d(23,"chevron_right"),l()()()()),t&2&&(a(2),te("placeholder",u(3,10,"PLANNED_PLANTATION.SEARCH_PLACEHOLDER")),Te("ngModel",r.filterText),a(5),g(" ",u(8,12,"PLANNED_PLANTATION.NEW")," "),a(3),f("ngForOf",r.getPagedPlannedPlantations()),a(2),f("disabled",r.currentPage===0),a(3),g(" ",u(16,14,"PLANNED_PLANTATION.PREVIOUS")," "),a(3),W("",r.currentPage+1," / ",r.totalPages,""),a(),f("disabled",r.currentPage+1>=r.totalPages),a(),g(" ",u(21,16,"PLANNED_PLANTATION.NEXT")," "))},dependencies:[F,at,ne,H,wt,Z,J,ee,X,Q,re,De,_e,ye,Ye,L,U]})}}return n})();function El(n,i){if(n&1&&(s(0,"p",16),d(1),c(2,"translate"),s(3,"strong"),d(4),c(5,"date"),l()()),n&2){let e=_(2);a(),g(" ",u(2,2,"PLANNED_PLANTATION.EFFECTIVE_DATE"),": "),a(3),y(Y(5,4,e.plannedPlantation.effectiveDate,"dd/MM/yyyy"))}}function Tl(n,i){if(n&1){let e=j();s(0,"div",17)(1,"button",18),T("click",function(){I(e);let r=_(2);return w(r.goToEditForm())}),d(2),c(3,"translate"),l()()}n&2&&(a(2),g(" ",u(3,1,"PLANNED_PLANTATION.EDIT_BUTTON")," "))}function Sl(n,i){if(n&1&&(s(0,"mat-card",1)(1,"div",2)(2,"mat-icon",3),d(3),l(),s(4,"span"),d(5),l()(),s(6,"div",4)(7,"mat-icon",5),d(8,"event"),l()(),s(9,"h2",6),d(10),c(11,"translate"),l(),s(12,"p",7),d(13),c(14,"translate"),s(15,"strong"),d(16),c(17,"date"),l()(),E(18,El,6,7,"p",8),s(19,"div",9)(20,"p",10),d(21),c(22,"translate"),l(),s(23,"div",11)(24,"div",12)(25,"p",13),d(26),c(27,"translate"),l(),s(28,"p",14),d(29),l()(),s(30,"div",12)(31,"p",13),d(32),c(33,"translate"),l(),s(34,"p",14),d(35),l()(),s(36,"div",12)(37,"p",13),d(38),c(39,"translate"),l(),s(40,"p",14),d(41),l()()()(),E(42,Tl,4,3,"div",15),l()),n&2){let e,t,r,o=_();a(2),f("ngClass",o.plannedPlantation.isActive?"text-green-600":"text-gray-400"),a(),g(" ",o.plannedPlantation.isActive?"check_circle":"cancel"," "),a(2),y(o.plannedPlantation.isActive?"Activa":"Inactiva"),a(5),g(" ",o.plannedPlantation.landName||u(11,15,"PLANNED_PLANTATION.NO_LAND")," "),a(3),g(" ",u(14,17,"PLANNED_PLANTATION.PLANNED_DATE"),": "),a(3),y(o.plannedPlantation.plannedDate?Y(17,19,o.plannedPlantation.plannedDate,"dd/MM/yyyy"):"\u2014"),a(2),f("ngIf",o.plannedPlantation.effectiveDate),a(3),g(" ",u(22,22,"PLANNED_PLANTATION.TREES_TITLE")," "),a(5),g(" ",u(27,24,"PLANNED_PLANTATION.MIN_TREES")," "),a(3),g(" ",(e=o.plannedPlantation.minTrees)!==null&&e!==void 0?e:"\u2014"," "),a(3),g(" ",u(33,26,"PLANNED_PLANTATION.OPTIMAL_TREES")," "),a(3),g(" ",(t=o.plannedPlantation.optimalTrees)!==null&&t!==void 0?t:"\u2014"," "),a(3),g(" ",u(39,28,"PLANNED_PLANTATION.MAX_TREES")," "),a(3),g(" ",(r=o.plannedPlantation.maxTrees)!==null&&r!==void 0?r:"\u2014"," "),a(),f("ngIf",o.isEditable)}}var Zr=(()=>{class n{constructor(e,t,r,o,p){this.route=e,this.router=t,this.plannedPlantationService=r,this.snackBar=o,this.userService=p,this.user=null,this.isEditable=!1}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");this.user=this.userService.getCurrentUser(),e&&this.plannedPlantationService.getById(+e).subscribe({next:t=>{this.plannedPlantation=t,this.isEditable=this.user?.role===M.ADMIN||this.user?.role===M.COMPANY_ADMIN},error:t=>{console.error("\u274C Error al cargar la plantaci\xF3n prevista",t),this.snackBar.open("Error al cargar la plantaci\xF3n prevista","Cerrar",{duration:3e3})}})}goToEditForm(){this.plannedPlantation?.id&&this.router.navigate(["/admin/planned-plantation-form",this.plannedPlantation.id])}static{this.\u0275fac=function(t){return new(t||n)(x(Re),x(z),x(ui),x(Me),x(ae))}}static{this.\u0275cmp=P({type:n,selectors:[["app-planned-plantation"]],standalone:!0,features:[N],decls:1,vars:1,consts:[["class","rounded-2xl shadow-md p-4 md:p-6 flex flex-col items-center text-center w-full max-w-full",4,"ngIf"],[1,"rounded-2xl","shadow-md","p-4","md:p-6","flex","flex-col","items-center","text-center","w-full","max-w-full"],[1,"flex","items-center","gap-2","mt-2"],[3,"ngClass"],[1,"w-24","h-24","rounded-full","bg-green-100","flex","items-center","justify-center","shadow-lg","mb-4"],[1,"text-green-600",2,"font-size","48px"],[1,"text-xl","md:text-2xl","font-semibold"],[1,"text-gray-500","mt-1"],["class","text-gray-500",4,"ngIf"],[1,"w-full","mt-6","text-left"],[1,"font-semibold","text-gray-700","mb-2"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-4","w-full"],[1,"bg-white","shadow-md","rounded-lg","p-4","flex","flex-col","items-center"],[1,"font-semibold","text-gray-700","mb-1"],[1,"text-lg","font-bold","text-gray-800"],["class","flex gap-4 mt-6 justify-center",4,"ngIf"],[1,"text-gray-500"],[1,"flex","gap-4","mt-6","justify-center"],[1,"bg-green-600","text-white","py-3","px-6","rounded-xl","hover:bg-green-700","transition",3,"click"]],template:function(t,r){t&1&&E(0,Sl,43,30,"mat-card",0),t&2&&f("ngIf",r.plannedPlantation)},dependencies:[F,at,H,wt,J,ee,X,Q,re,L,U]})}}return n})();var Jr=[{path:"login",component:Nr},{path:"register",component:Pr},{path:"verify-email",component:Or},{path:"reset-password",component:Rr},{path:"",component:Ir,canActivate:[et],children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:Mr},{path:"my-trees",component:Gr},{path:"profile",component:Vi},{path:"buy-tree",component:Wr},{path:"profile/:id",component:Vi,canActivate:[et]},{path:"profile/edit/:id",loadComponent:()=>import("./chunk-LOSF7LOR.js").then(n=>n.UserFormComponent),canActivate:[et]},{path:"company",component:Yi},{path:"company/:id",component:Yi,canActivate:[et]},{path:"tree-type/:id",component:Yr,canActivate:[et]},{path:"planned-plantation/:id",component:Zr,canActivate:[et]},{path:"tree/:id",component:Qr,canActivate:[et]},{path:"land/:id",loadComponent:()=>import("./chunk-QAB34RK4.js").then(n=>n.LandComponent),canActivate:[et]},{path:"land/edit-trees/:landId/:treeTypeId",loadComponent:()=>import("./chunk-2D44U2C7.js").then(n=>n.EditTreesComponent),canActivate:[xe],data:{roles:[M.ADMIN]}},{path:"company/form/:id",loadComponent:()=>import("./chunk-G7KSLRMN.js").then(n=>n.CompanyFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"tree/form/:id",loadComponent:()=>import("./chunk-GMY434WY.js").then(n=>n.TreeFormComponent)},{path:"settings",component:Ar},{path:"admin",component:kr,canActivate:[et],children:[{path:"users",component:Fr,canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"user-form",loadComponent:()=>import("./chunk-LOSF7LOR.js").then(n=>n.UserFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"user-form/:id",loadComponent:()=>import("./chunk-LOSF7LOR.js").then(n=>n.UserFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"companies",component:Br,canActivate:[xe],data:{roles:[M.ADMIN]}},{path:"company-form",loadComponent:()=>import("./chunk-G7KSLRMN.js").then(n=>n.CompanyFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"company-form/:id",loadComponent:()=>import("./chunk-G7KSLRMN.js").then(n=>n.CompanyFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"lands",component:zr,canActivate:[xe],data:{roles:[M.ADMIN]}},{path:"land-form",loadComponent:()=>import("./chunk-B5KT3R53.js").then(n=>n.LandFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"land-form/:id",loadComponent:()=>import("./chunk-B5KT3R53.js").then(n=>n.LandFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"tree-types",component:Vr,canActivate:[xe],data:{roles:[M.ADMIN]}},{path:"tree-type-form",loadComponent:()=>import("./chunk-BZY6LY6X.js").then(n=>n.TreeTypesFormComponent),canActivate:[xe],data:{roles:[M.ADMIN]}},{path:"tree-type-form/:id",loadComponent:()=>import("./chunk-BZY6LY6X.js").then(n=>n.TreeTypesFormComponent),canActivate:[xe],data:{roles:[M.ADMIN]}},{path:"planned-plantations",component:Xr,canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"planned-plantation-form",loadComponent:()=>import("./chunk-253AWM5O.js").then(n=>n.PlannedPlantationFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}},{path:"planned-plantation-form/:id",loadComponent:()=>import("./chunk-253AWM5O.js").then(n=>n.PlannedPlantationFormComponent),canActivate:[xe],data:{roles:[M.ADMIN,M.COMPANY_ADMIN]}}]}]},{path:"**",redirectTo:"login"}];function eo(n){return new q(3e3,!1)}function bl(){return new q(3100,!1)}function Cl(){return new q(3101,!1)}function Il(n){return new q(3001,!1)}function wl(n){return new q(3003,!1)}function Ml(n){return new q(3004,!1)}function Al(n,i){return new q(3005,!1)}function Pl(){return new q(3006,!1)}function Nl(){return new q(3007,!1)}function Ol(n,i){return new q(3008,!1)}function Rl(n){return new q(3002,!1)}function Dl(n,i,e,t,r){return new q(3010,!1)}function Ll(){return new q(3011,!1)}function kl(){return new q(3012,!1)}function Fl(){return new q(3200,!1)}function Bl(){return new q(3202,!1)}function jl(){return new q(3013,!1)}function Ul(n){return new q(3014,!1)}function Vl(n){return new q(3015,!1)}function Yl(n){return new q(3016,!1)}function zl(n,i){return new q(3404,!1)}function Gl(n){return new q(3502,!1)}function Kl(n){return new q(3503,!1)}function ql(){return new q(3300,!1)}function $l(n){return new q(3504,!1)}function Hl(n){return new q(3301,!1)}function Wl(n,i){return new q(3302,!1)}function Ql(n){return new q(3303,!1)}function Xl(n,i){return new q(3400,!1)}function Zl(n){return new q(3401,!1)}function Jl(n){return new q(3402,!1)}function ed(n,i){return new q(3505,!1)}function pt(n){switch(n.length){case 0:return new kt;case 1:return n[0];default:return new Bi(n)}}function ho(n,i,e=new Map,t=new Map){let r=[],o=[],p=-1,m=null;if(i.forEach(h=>{let v=h.get("offset"),b=v==p,S=b&&m||new Map;h.forEach((V,k)=>{let O=k,B=V;if(k!=="offset")switch(O=n.normalizePropertyName(O,r),B){case li:B=e.get(k);break;case Ze:B=t.get(k);break;default:B=n.normalizeStyleValue(k,O,B,r);break}S.set(O,B)}),b||o.push(S),m=S,p=v}),r.length)throw Gl(r);return o}function mn(n,i,e,t){switch(i){case"start":n.onStart(()=>t(e&&zi(e,"start",n)));break;case"done":n.onDone(()=>t(e&&zi(e,"done",n)));break;case"destroy":n.onDestroy(()=>t(e&&zi(e,"destroy",n)));break}}function zi(n,i,e){let t=e.totalTime,r=!!e.disabled,o=un(n.element,n.triggerName,n.fromState,n.toState,i||n.phaseName,t??n.totalTime,r),p=n._data;return p!=null&&(o._data=p),o}function un(n,i,e,t,r="",o=0,p){return{element:n,triggerName:i,fromState:e,toState:t,phaseName:r,totalTime:o,disabled:!!p}}function Fe(n,i,e){let t=n.get(i);return t||n.set(i,t=e),t}function to(n){let i=n.indexOf(":"),e=n.substring(1,i),t=n.slice(i+1);return[e,t]}var td=typeof document>"u"?null:document.documentElement;function fn(n){let i=n.parentNode||n.host||null;return i===td?null:i}function id(n){return n.substring(1,6)=="ebkit"}var gt=null,io=!1;function nd(n){gt||(gt=rd()||{},io=gt.style?"WebkitAppearance"in gt.style:!1);let i=!0;return gt.style&&!id(n)&&(i=n in gt.style,!i&&io&&(i="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in gt.style)),i}function rd(){return typeof document<"u"?document.body:null}function go(n,i){for(;i;){if(i===n)return!0;i=fn(i)}return!1}function _o(n,i,e){if(e)return Array.from(n.querySelectorAll(i));let t=n.querySelector(i);return t?[t]:[]}var hn=(()=>{class n{validateStyleProperty(e){return nd(e)}containsElement(e,t){return go(e,t)}getParentElement(e){return fn(e)}query(e,t,r){return _o(e,t,r)}computeStyle(e,t,r){return r||""}animate(e,t,r,o,p,m=[],h){return new kt(r,o)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac})}}return n})(),vt=class{static{this.NOOP=new hn}},xt=class{};var od=1e3,yo="{{",ad="}}",vo="ng-enter",Wi="ng-leave",hi="ng-trigger",xi=".ng-trigger",no="ng-animating",Qi=".ng-animating";function nt(n){if(typeof n=="number")return n;let i=n.match(/^(-?[\.\d]+)(m?s)/);return!i||i.length<2?0:Xi(parseFloat(i[1]),i[2])}function Xi(n,i){switch(i){case"s":return n*od;default:return n}}function Ei(n,i,e){return n.hasOwnProperty("duration")?n:sd(n,i,e)}function sd(n,i,e){let t=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,r,o=0,p="";if(typeof n=="string"){let m=n.match(t);if(m===null)return i.push(eo(n)),{duration:0,delay:0,easing:""};r=Xi(parseFloat(m[1]),m[2]);let h=m[3];h!=null&&(o=Xi(parseFloat(h),m[4]));let v=m[5];v&&(p=v)}else r=n;if(!e){let m=!1,h=i.length;r<0&&(i.push(bl()),m=!0),o<0&&(i.push(Cl()),m=!0),m&&i.splice(h,0,eo(n))}return{duration:r,delay:o,easing:p}}function ld(n){return n.length?n[0]instanceof Map?n:n.map(i=>new Map(Object.entries(i))):[]}function it(n,i,e){i.forEach((t,r)=>{let o=gn(r);e&&!e.has(r)&&e.set(r,n.style[o]),n.style[o]=t})}function yt(n,i){i.forEach((e,t)=>{let r=gn(t);n.style[r]=""})}function Ht(n){return Array.isArray(n)?n.length==1?n[0]:fr(n):n}function dd(n,i,e){let t=i.params||{},r=xo(n);r.length&&r.forEach(o=>{t.hasOwnProperty(o)||e.push(Il(o))})}var Zi=new RegExp(`${yo}\\s*(.+?)\\s*${ad}`,"g");function xo(n){let i=[];if(typeof n=="string"){let e;for(;e=Zi.exec(n);)i.push(e[1]);Zi.lastIndex=0}return i}function Qt(n,i,e){let t=`${n}`,r=t.replace(Zi,(o,p)=>{let m=i[p];return m==null&&(e.push(wl(p)),m=""),m.toString()});return r==t?n:r}var pd=/-+([a-z0-9])/g;function gn(n){return n.replace(pd,(...i)=>i[1].toUpperCase())}function cd(n,i){return n===0||i===0}function md(n,i,e){if(e.size&&i.length){let t=i[0],r=[];if(e.forEach((o,p)=>{t.has(p)||r.push(p),t.set(p,o)}),r.length)for(let o=1;o<i.length;o++){let p=i[o];r.forEach(m=>p.set(m,_n(n,m)))}}return i}function ke(n,i,e){switch(i.type){case G.Trigger:return n.visitTrigger(i,e);case G.State:return n.visitState(i,e);case G.Transition:return n.visitTransition(i,e);case G.Sequence:return n.visitSequence(i,e);case G.Group:return n.visitGroup(i,e);case G.Animate:return n.visitAnimate(i,e);case G.Keyframes:return n.visitKeyframes(i,e);case G.Style:return n.visitStyle(i,e);case G.Reference:return n.visitReference(i,e);case G.AnimateChild:return n.visitAnimateChild(i,e);case G.AnimateRef:return n.visitAnimateRef(i,e);case G.Query:return n.visitQuery(i,e);case G.Stagger:return n.visitStagger(i,e);default:throw Ml(i.type)}}function _n(n,i){return window.getComputedStyle(n)[i]}var ud=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),Ti=class extends xt{normalizePropertyName(i,e){return gn(i)}normalizeStyleValue(i,e,t,r){let o="",p=t.toString().trim();if(ud.has(e)&&t!==0&&t!=="0")if(typeof t=="number")o="px";else{let m=t.match(/^[+-]?[\d\.]+([a-z]*)$/);m&&m[1].length==0&&r.push(Al(i,t))}return p+o}};var Si="*";function fd(n,i){let e=[];return typeof n=="string"?n.split(/\s*,\s*/).forEach(t=>hd(t,e,i)):e.push(n),e}function hd(n,i,e){if(n[0]==":"){let h=gd(n,e);if(typeof h=="function"){i.push(h);return}n=h}let t=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(t==null||t.length<4)return e.push(Vl(n)),i;let r=t[1],o=t[2],p=t[3];i.push(ro(r,p));let m=r==Si&&p==Si;o[0]=="<"&&!m&&i.push(ro(p,r))}function gd(n,i){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,t)=>parseFloat(t)>parseFloat(e);case":decrement":return(e,t)=>parseFloat(t)<parseFloat(e);default:return i.push(Yl(n)),"* => *"}}var gi=new Set(["true","1"]),_i=new Set(["false","0"]);function ro(n,i){let e=gi.has(n)||_i.has(n),t=gi.has(i)||_i.has(i);return(r,o)=>{let p=n==Si||n==r,m=i==Si||i==o;return!p&&e&&typeof r=="boolean"&&(p=r?gi.has(n):_i.has(n)),!m&&t&&typeof o=="boolean"&&(m=o?gi.has(i):_i.has(i)),p&&m}}var Eo=":self",_d=new RegExp(`s*${Eo}s*,?`,"g");function To(n,i,e,t){return new Ji(n).build(i,e,t)}var oo="",Ji=class{constructor(i){this._driver=i}build(i,e,t){let r=new en(e);return this._resetContextStyleTimingState(r),ke(this,Ht(i),r)}_resetContextStyleTimingState(i){i.currentQuerySelector=oo,i.collectedStyles=new Map,i.collectedStyles.set(oo,new Map),i.currentTime=0}visitTrigger(i,e){let t=e.queryCount=0,r=e.depCount=0,o=[],p=[];return i.name.charAt(0)=="@"&&e.errors.push(Pl()),i.definitions.forEach(m=>{if(this._resetContextStyleTimingState(e),m.type==G.State){let h=m,v=h.name;v.toString().split(/\s*,\s*/).forEach(b=>{h.name=b,o.push(this.visitState(h,e))}),h.name=v}else if(m.type==G.Transition){let h=this.visitTransition(m,e);t+=h.queryCount,r+=h.depCount,p.push(h)}else e.errors.push(Nl())}),{type:G.Trigger,name:i.name,states:o,transitions:p,queryCount:t,depCount:r,options:null}}visitState(i,e){let t=this.visitStyle(i.styles,e),r=i.options&&i.options.params||null;if(t.containsDynamicStyles){let o=new Set,p=r||{};t.styles.forEach(m=>{m instanceof Map&&m.forEach(h=>{xo(h).forEach(v=>{p.hasOwnProperty(v)||o.add(v)})})}),o.size&&e.errors.push(Ol(i.name,[...o.values()]))}return{type:G.State,name:i.name,style:t,options:r?{params:r}:null}}visitTransition(i,e){e.queryCount=0,e.depCount=0;let t=ke(this,Ht(i.animation),e),r=fd(i.expr,e.errors);return{type:G.Transition,matchers:r,animation:t,queryCount:e.queryCount,depCount:e.depCount,options:_t(i.options)}}visitSequence(i,e){return{type:G.Sequence,steps:i.steps.map(t=>ke(this,t,e)),options:_t(i.options)}}visitGroup(i,e){let t=e.currentTime,r=0,o=i.steps.map(p=>{e.currentTime=t;let m=ke(this,p,e);return r=Math.max(r,e.currentTime),m});return e.currentTime=r,{type:G.Group,steps:o,options:_t(i.options)}}visitAnimate(i,e){let t=Ed(i.timings,e.errors);e.currentAnimateTimings=t;let r,o=i.styles?i.styles:Fi({});if(o.type==G.Keyframes)r=this.visitKeyframes(o,e);else{let p=i.styles,m=!1;if(!p){m=!0;let v={};t.easing&&(v.easing=t.easing),p=Fi(v)}e.currentTime+=t.duration+t.delay;let h=this.visitStyle(p,e);h.isEmptyStep=m,r=h}return e.currentAnimateTimings=null,{type:G.Animate,timings:t,style:r,options:null}}visitStyle(i,e){let t=this._makeStyleAst(i,e);return this._validateStyleAst(t,e),t}_makeStyleAst(i,e){let t=[],r=Array.isArray(i.styles)?i.styles:[i.styles];for(let m of r)typeof m=="string"?m===Ze?t.push(m):e.errors.push(Rl(m)):t.push(new Map(Object.entries(m)));let o=!1,p=null;return t.forEach(m=>{if(m instanceof Map&&(m.has("easing")&&(p=m.get("easing"),m.delete("easing")),!o)){for(let h of m.values())if(h.toString().indexOf(yo)>=0){o=!0;break}}}),{type:G.Style,styles:t,easing:p,offset:i.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(i,e){let t=e.currentAnimateTimings,r=e.currentTime,o=e.currentTime;t&&o>0&&(o-=t.duration+t.delay),i.styles.forEach(p=>{typeof p!="string"&&p.forEach((m,h)=>{let v=e.collectedStyles.get(e.currentQuerySelector),b=v.get(h),S=!0;b&&(o!=r&&o>=b.startTime&&r<=b.endTime&&(e.errors.push(Dl(h,b.startTime,b.endTime,o,r)),S=!1),o=b.startTime),S&&v.set(h,{startTime:o,endTime:r}),e.options&&dd(m,e.options,e.errors)})})}visitKeyframes(i,e){let t={type:G.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(Ll()),t;let r=1,o=0,p=[],m=!1,h=!1,v=0,b=i.steps.map(ue=>{let fe=this._makeStyleAst(ue,e),Ae=fe.offset!=null?fe.offset:xd(fe.styles),Ee=0;return Ae!=null&&(o++,Ee=fe.offset=Ae),h=h||Ee<0||Ee>1,m=m||Ee<v,v=Ee,p.push(Ee),fe});h&&e.errors.push(kl()),m&&e.errors.push(Fl());let S=i.steps.length,V=0;o>0&&o<S?e.errors.push(Bl()):o==0&&(V=r/(S-1));let k=S-1,O=e.currentTime,B=e.currentAnimateTimings,ie=B.duration;return b.forEach((ue,fe)=>{let Ae=V>0?fe==k?1:V*fe:p[fe],Ee=Ae*ie;e.currentTime=O+B.delay+Ee,B.duration=Ee,this._validateStyleAst(ue,e),ue.offset=Ae,t.styles.push(ue)}),t}visitReference(i,e){return{type:G.Reference,animation:ke(this,Ht(i.animation),e),options:_t(i.options)}}visitAnimateChild(i,e){return e.depCount++,{type:G.AnimateChild,options:_t(i.options)}}visitAnimateRef(i,e){return{type:G.AnimateRef,animation:this.visitReference(i.animation,e),options:_t(i.options)}}visitQuery(i,e){let t=e.currentQuerySelector,r=i.options||{};e.queryCount++,e.currentQuery=i;let[o,p]=yd(i.selector);e.currentQuerySelector=t.length?t+" "+o:o,Fe(e.collectedStyles,e.currentQuerySelector,new Map);let m=ke(this,Ht(i.animation),e);return e.currentQuery=null,e.currentQuerySelector=t,{type:G.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:p,animation:m,originalSelector:i.selector,options:_t(i.options)}}visitStagger(i,e){e.currentQuery||e.errors.push(jl());let t=i.timings==="full"?{duration:0,delay:0,easing:"full"}:Ei(i.timings,e.errors,!0);return{type:G.Stagger,animation:ke(this,Ht(i.animation),e),timings:t,options:null}}};function yd(n){let i=!!n.split(/\s*,\s*/).find(e=>e==Eo);return i&&(n=n.replace(_d,"")),n=n.replace(/@\*/g,xi).replace(/@\w+/g,e=>xi+"-"+e.slice(1)).replace(/:animating/g,Qi),[n,i]}function vd(n){return n?St({},n):null}var en=class{constructor(i){this.errors=i,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function xd(n){if(typeof n=="string")return null;let i=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){let t=e;i=parseFloat(t.get("offset")),t.delete("offset")}});else if(n instanceof Map&&n.has("offset")){let e=n;i=parseFloat(e.get("offset")),e.delete("offset")}return i}function Ed(n,i){if(n.hasOwnProperty("duration"))return n;if(typeof n=="number"){let o=Ei(n,i).duration;return Gi(o,0,"")}let e=n;if(e.split(/\s+/).some(o=>o.charAt(0)=="{"&&o.charAt(1)=="{")){let o=Gi(0,0,"");return o.dynamic=!0,o.strValue=e,o}let r=Ei(e,i);return Gi(r.duration,r.delay,r.easing)}function _t(n){return n?(n=St({},n),n.params&&(n.params=vd(n.params))):n={},n}function Gi(n,i,e){return{duration:n,delay:i,easing:e}}function yn(n,i,e,t,r,o,p=null,m=!1){return{type:1,element:n,keyframes:i,preStyleProps:e,postStyleProps:t,duration:r,delay:o,totalTime:r+o,easing:p,subTimeline:m}}var Xt=class{constructor(){this._map=new Map}get(i){return this._map.get(i)||[]}append(i,e){let t=this._map.get(i);t||this._map.set(i,t=[]),t.push(...e)}has(i){return this._map.has(i)}clear(){this._map.clear()}},Td=1,Sd=":enter",bd=new RegExp(Sd,"g"),Cd=":leave",Id=new RegExp(Cd,"g");function So(n,i,e,t,r,o=new Map,p=new Map,m,h,v=[]){return new tn().buildKeyframes(n,i,e,t,r,o,p,m,h,v)}var tn=class{buildKeyframes(i,e,t,r,o,p,m,h,v,b=[]){v=v||new Xt;let S=new nn(i,e,v,r,o,b,[]);S.options=h;let V=h.delay?nt(h.delay):0;S.currentTimeline.delayNextStep(V),S.currentTimeline.setStyles([p],null,S.errors,h),ke(this,t,S);let k=S.timelines.filter(O=>O.containsAnimation());if(k.length&&m.size){let O;for(let B=k.length-1;B>=0;B--){let ie=k[B];if(ie.element===e){O=ie;break}}O&&!O.allowOnlyTimelineStyles()&&O.setStyles([m],null,S.errors,h)}return k.length?k.map(O=>O.buildKeyframes()):[yn(e,[],[],[],0,V,"",!1)]}visitTrigger(i,e){}visitState(i,e){}visitTransition(i,e){}visitAnimateChild(i,e){let t=e.subInstructions.get(e.element);if(t){let r=e.createSubContext(i.options),o=e.currentTimeline.currentTime,p=this._visitSubInstructions(t,r,r.options);o!=p&&e.transformIntoNewTimeline(p)}e.previousNode=i}visitAnimateRef(i,e){let t=e.createSubContext(i.options);t.transformIntoNewTimeline(),this._applyAnimationRefDelays([i.options,i.animation.options],e,t),this.visitReference(i.animation,t),e.transformIntoNewTimeline(t.currentTimeline.currentTime),e.previousNode=i}_applyAnimationRefDelays(i,e,t){for(let r of i){let o=r?.delay;if(o){let p=typeof o=="number"?o:nt(Qt(o,r?.params??{},e.errors));t.delayNextStep(p)}}}_visitSubInstructions(i,e,t){let o=e.currentTimeline.currentTime,p=t.duration!=null?nt(t.duration):null,m=t.delay!=null?nt(t.delay):null;return p!==0&&i.forEach(h=>{let v=e.appendInstructionToTimeline(h,p,m);o=Math.max(o,v.duration+v.delay)}),o}visitReference(i,e){e.updateOptions(i.options,!0),ke(this,i.animation,e),e.previousNode=i}visitSequence(i,e){let t=e.subContextCount,r=e,o=i.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),o.delay!=null)){r.previousNode.type==G.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=bi);let p=nt(o.delay);r.delayNextStep(p)}i.steps.length&&(i.steps.forEach(p=>ke(this,p,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>t&&r.transformIntoNewTimeline()),e.previousNode=i}visitGroup(i,e){let t=[],r=e.currentTimeline.currentTime,o=i.options&&i.options.delay?nt(i.options.delay):0;i.steps.forEach(p=>{let m=e.createSubContext(i.options);o&&m.delayNextStep(o),ke(this,p,m),r=Math.max(r,m.currentTimeline.currentTime),t.push(m.currentTimeline)}),t.forEach(p=>e.currentTimeline.mergeTimelineCollectedStyles(p)),e.transformIntoNewTimeline(r),e.previousNode=i}_visitTiming(i,e){if(i.dynamic){let t=i.strValue,r=e.params?Qt(t,e.params,e.errors):t;return Ei(r,e.errors)}else return{duration:i.duration,delay:i.delay,easing:i.easing}}visitAnimate(i,e){let t=e.currentAnimateTimings=this._visitTiming(i.timings,e),r=e.currentTimeline;t.delay&&(e.incrementTime(t.delay),r.snapshotCurrentStyles());let o=i.style;o.type==G.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(t.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=i}visitStyle(i,e){let t=e.currentTimeline,r=e.currentAnimateTimings;!r&&t.hasCurrentStyleProperties()&&t.forwardFrame();let o=r&&r.easing||i.easing;i.isEmptyStep?t.applyEmptyStep(o):t.setStyles(i.styles,o,e.errors,e.options),e.previousNode=i}visitKeyframes(i,e){let t=e.currentAnimateTimings,r=e.currentTimeline.duration,o=t.duration,m=e.createSubContext().currentTimeline;m.easing=t.easing,i.styles.forEach(h=>{let v=h.offset||0;m.forwardTime(v*o),m.setStyles(h.styles,h.easing,e.errors,e.options),m.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(m),e.transformIntoNewTimeline(r+o),e.previousNode=i}visitQuery(i,e){let t=e.currentTimeline.currentTime,r=i.options||{},o=r.delay?nt(r.delay):0;o&&(e.previousNode.type===G.Style||t==0&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=bi);let p=t,m=e.invokeQuery(i.selector,i.originalSelector,i.limit,i.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=m.length;let h=null;m.forEach((v,b)=>{e.currentQueryIndex=b;let S=e.createSubContext(i.options,v);o&&S.delayNextStep(o),v===e.element&&(h=S.currentTimeline),ke(this,i.animation,S),S.currentTimeline.applyStylesToKeyframe();let V=S.currentTimeline.currentTime;p=Math.max(p,V)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(p),h&&(e.currentTimeline.mergeTimelineCollectedStyles(h),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=i}visitStagger(i,e){let t=e.parentContext,r=e.currentTimeline,o=i.timings,p=Math.abs(o.duration),m=p*(e.currentQueryTotal-1),h=p*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":h=m-h;break;case"full":h=t.currentStaggerTime;break}let b=e.currentTimeline;h&&b.delayNextStep(h);let S=b.currentTime;ke(this,i.animation,e),e.previousNode=i,t.currentStaggerTime=r.currentTime-S+(r.startTime-t.currentTimeline.startTime)}},bi={},nn=class n{constructor(i,e,t,r,o,p,m,h){this._driver=i,this.element=e,this.subInstructions=t,this._enterClassName=r,this._leaveClassName=o,this.errors=p,this.timelines=m,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=bi,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=h||new Ci(this._driver,e,0),m.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(i,e){if(!i)return;let t=i,r=this.options;t.duration!=null&&(r.duration=nt(t.duration)),t.delay!=null&&(r.delay=nt(t.delay));let o=t.params;if(o){let p=r.params;p||(p=this.options.params={}),Object.keys(o).forEach(m=>{(!e||!p.hasOwnProperty(m))&&(p[m]=Qt(o[m],p,this.errors))})}}_copyOptions(){let i={};if(this.options){let e=this.options.params;if(e){let t=i.params={};Object.keys(e).forEach(r=>{t[r]=e[r]})}}return i}createSubContext(i=null,e,t){let r=e||this.element,o=new n(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,t||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(i),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(i){return this.previousNode=bi,this.currentTimeline=this.currentTimeline.fork(this.element,i),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(i,e,t){let r={duration:e??i.duration,delay:this.currentTimeline.currentTime+(t??0)+i.delay,easing:""},o=new rn(this._driver,i.element,i.keyframes,i.preStyleProps,i.postStyleProps,r,i.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(i){this.currentTimeline.forwardTime(this.currentTimeline.duration+i)}delayNextStep(i){i>0&&this.currentTimeline.delayNextStep(i)}invokeQuery(i,e,t,r,o,p){let m=[];if(r&&m.push(this.element),i.length>0){i=i.replace(bd,"."+this._enterClassName),i=i.replace(Id,"."+this._leaveClassName);let h=t!=1,v=this._driver.query(this.element,i,h);t!==0&&(v=t<0?v.slice(v.length+t,v.length):v.slice(0,t)),m.push(...v)}return!o&&m.length==0&&p.push(Ul(e)),m}},Ci=class n{constructor(i,e,t,r){this._driver=i,this.element=e,this.startTime=t,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(i){let e=this._keyframes.size===1&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+i),e&&this.snapshotCurrentStyles()):this.startTime+=i}fork(i,e){return this.applyStylesToKeyframe(),new n(this._driver,i,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=Td,this._loadKeyframe()}forwardTime(i){this.applyStylesToKeyframe(),this.duration=i,this._loadKeyframe()}_updateStyle(i,e){this._localTimelineStyles.set(i,e),this._globalTimelineStyles.set(i,e),this._styleSummary.set(i,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(i){i&&this._previousKeyframe.set("easing",i);for(let[e,t]of this._globalTimelineStyles)this._backFill.set(e,t||Ze),this._currentKeyframe.set(e,Ze);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(i,e,t,r){e&&this._previousKeyframe.set("easing",e);let o=r&&r.params||{},p=wd(i,this._globalTimelineStyles);for(let[m,h]of p){let v=Qt(h,o,t);this._pendingStyles.set(m,v),this._localTimelineStyles.has(m)||this._backFill.set(m,this._globalTimelineStyles.get(m)??Ze),this._updateStyle(m,v)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((i,e)=>{this._currentKeyframe.set(e,i)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((i,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,i)}))}snapshotCurrentStyles(){for(let[i,e]of this._localTimelineStyles)this._pendingStyles.set(i,e),this._updateStyle(i,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let i=[];for(let e in this._currentKeyframe)i.push(e);return i}mergeTimelineCollectedStyles(i){i._styleSummary.forEach((e,t)=>{let r=this._styleSummary.get(t);(!r||e.time>r.time)&&this._updateStyle(t,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();let i=new Set,e=new Set,t=this._keyframes.size===1&&this.duration===0,r=[];this._keyframes.forEach((m,h)=>{let v=new Map([...this._backFill,...m]);v.forEach((b,S)=>{b===li?i.add(S):b===Ze&&e.add(S)}),t||v.set("offset",h/this.duration),r.push(v)});let o=[...i.values()],p=[...e.values()];if(t){let m=r[0],h=new Map(m);m.set("offset",0),h.set("offset",1),r=[m,h]}return yn(this.element,r,o,p,this.duration,this.startTime,this.easing,!1)}},rn=class extends Ci{constructor(i,e,t,r,o,p,m=!1){super(i,e,p.delay),this.keyframes=t,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=m,this.timings={duration:p.duration,delay:p.delay,easing:p.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let i=this.keyframes,{delay:e,duration:t,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){let o=[],p=t+e,m=e/p,h=new Map(i[0]);h.set("offset",0),o.push(h);let v=new Map(i[0]);v.set("offset",ao(m)),o.push(v);let b=i.length-1;for(let S=1;S<=b;S++){let V=new Map(i[S]),k=V.get("offset"),O=e+k*t;V.set("offset",ao(O/p)),o.push(V)}t=p,e=0,r="",i=o}return yn(this.element,i,this.preStyleProps,this.postStyleProps,t,e,r,!0)}};function ao(n,i=3){let e=Math.pow(10,i-1);return Math.round(n*e)/e}function wd(n,i){let e=new Map,t;return n.forEach(r=>{if(r==="*"){t??=i.keys();for(let o of t)e.set(o,Ze)}else for(let[o,p]of r)e.set(o,p)}),e}function so(n,i,e,t,r,o,p,m,h,v,b,S,V){return{type:0,element:n,triggerName:i,isRemovalTransition:r,fromState:e,fromStyles:o,toState:t,toStyles:p,timelines:m,queriedElements:h,preStyleProps:v,postStyleProps:b,totalTime:S,errors:V}}var Ki={},Ii=class{constructor(i,e,t){this._triggerName=i,this.ast=e,this._stateStyles=t}match(i,e,t,r){return Md(this.ast.matchers,i,e,t,r)}buildStyles(i,e,t){let r=this._stateStyles.get("*");return i!==void 0&&(r=this._stateStyles.get(i?.toString())||r),r?r.buildStyles(e,t):new Map}build(i,e,t,r,o,p,m,h,v,b){let S=[],V=this.ast.options&&this.ast.options.params||Ki,k=m&&m.params||Ki,O=this.buildStyles(t,k,S),B=h&&h.params||Ki,ie=this.buildStyles(r,B,S),ue=new Set,fe=new Map,Ae=new Map,Ee=r==="void",Et={params:bo(B,V),delay:this.ast.options?.delay},We=b?[]:So(i,e,this.ast.animation,o,p,O,ie,Et,v,S),Pe=0;return We.forEach(Ne=>{Pe=Math.max(Ne.duration+Ne.delay,Pe)}),S.length?so(e,this._triggerName,t,r,Ee,O,ie,[],[],fe,Ae,Pe,S):(We.forEach(Ne=>{let ct=Ne.element,Tt=Fe(fe,ct,new Set);Ne.preStyleProps.forEach(mt=>Tt.add(mt));let vn=Fe(Ae,ct,new Set);Ne.postStyleProps.forEach(mt=>vn.add(mt)),ct!==e&&ue.add(ct)}),so(e,this._triggerName,t,r,Ee,O,ie,We,[...ue.values()],fe,Ae,Pe))}};function Md(n,i,e,t,r){return n.some(o=>o(i,e,t,r))}function bo(n,i){let e=St({},i);return Object.entries(n).forEach(([t,r])=>{r!=null&&(e[t]=r)}),e}var on=class{constructor(i,e,t){this.styles=i,this.defaultParams=e,this.normalizer=t}buildStyles(i,e){let t=new Map,r=bo(i,this.defaultParams);return this.styles.styles.forEach(o=>{typeof o!="string"&&o.forEach((p,m)=>{p&&(p=Qt(p,r,e));let h=this.normalizer.normalizePropertyName(m,e);p=this.normalizer.normalizeStyleValue(m,h,p,e),t.set(m,p)})}),t}};function Ad(n,i,e){return new an(n,i,e)}var an=class{constructor(i,e,t){this.name=i,this.ast=e,this._normalizer=t,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{let o=r.options&&r.options.params||{};this.states.set(r.name,new on(r.style,o,t))}),lo(this.states,"true","1"),lo(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new Ii(i,r,this.states))}),this.fallbackTransition=Pd(i,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(i,e,t,r){return this.transitionFactories.find(p=>p.match(i,e,t,r))||null}matchStyles(i,e,t){return this.fallbackTransition.buildStyles(i,e,t)}};function Pd(n,i,e){let t=[(p,m)=>!0],r={type:G.Sequence,steps:[],options:null},o={type:G.Transition,animation:r,matchers:t,options:null,queryCount:0,depCount:0};return new Ii(n,o,i)}function lo(n,i,e){n.has(i)?n.has(e)||n.set(e,n.get(i)):n.has(e)&&n.set(i,n.get(e))}var Nd=new Xt,sn=class{constructor(i,e,t){this.bodyNode=i,this._driver=e,this._normalizer=t,this._animations=new Map,this._playersById=new Map,this.players=[]}register(i,e){let t=[],r=[],o=To(this._driver,e,t,r);if(t.length)throw Kl(t);r.length&&void 0,this._animations.set(i,o)}_buildPlayer(i,e,t){let r=i.element,o=ho(this._normalizer,i.keyframes,e,t);return this._driver.animate(r,o,i.duration,i.delay,i.easing,[],!0)}create(i,e,t={}){let r=[],o=this._animations.get(i),p,m=new Map;if(o?(p=So(this._driver,e,o,vo,Wi,new Map,new Map,t,Nd,r),p.forEach(b=>{let S=Fe(m,b.element,new Map);b.postStyleProps.forEach(V=>S.set(V,null))})):(r.push(ql()),p=[]),r.length)throw $l(r);m.forEach((b,S)=>{b.forEach((V,k)=>{b.set(k,this._driver.computeStyle(S,k,Ze))})});let h=p.map(b=>{let S=m.get(b.element);return this._buildPlayer(b,new Map,S)}),v=pt(h);return this._playersById.set(i,v),v.onDestroy(()=>this.destroy(i)),this.players.push(v),v}destroy(i){let e=this._getPlayer(i);e.destroy(),this._playersById.delete(i);let t=this.players.indexOf(e);t>=0&&this.players.splice(t,1)}_getPlayer(i){let e=this._playersById.get(i);if(!e)throw Hl(i);return e}listen(i,e,t,r){let o=un(e,"","","");return mn(this._getPlayer(i),t,o,r),()=>{}}command(i,e,t,r){if(t=="register"){this.register(i,r[0]);return}if(t=="create"){let p=r[0]||{};this.create(i,e,p);return}let o=this._getPlayer(i);switch(t){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(i);break}}},po="ng-animate-queued",Od=".ng-animate-queued",qi="ng-animate-disabled",Rd=".ng-animate-disabled",Dd="ng-star-inserted",Ld=".ng-star-inserted",kd=[],Co={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Fd={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},He="__ng_removed",Zt=class{get params(){return this.options.params}constructor(i,e=""){this.namespaceId=e;let t=i&&i.hasOwnProperty("value"),r=t?i.value:i;if(this.value=jd(r),t){let o=i,{value:p}=o,m=bn(o,["value"]);this.options=m}else this.options={};this.options.params||(this.options.params={})}absorbOptions(i){let e=i.params;if(e){let t=this.options.params;Object.keys(e).forEach(r=>{t[r]==null&&(t[r]=e[r])})}}},Wt="void",$i=new Zt(Wt),ln=class{constructor(i,e,t){this.id=i,this.hostElement=e,this._engine=t,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+i,Ke(e,this._hostClassName)}listen(i,e,t,r){if(!this._triggers.has(e))throw Wl(t,e);if(t==null||t.length==0)throw Ql(e);if(!Ud(t))throw Xl(t,e);let o=Fe(this._elementListeners,i,[]),p={name:e,phase:t,callback:r};o.push(p);let m=Fe(this._engine.statesByElement,i,new Map);return m.has(e)||(Ke(i,hi),Ke(i,hi+"-"+e),m.set(e,$i)),()=>{this._engine.afterFlush(()=>{let h=o.indexOf(p);h>=0&&o.splice(h,1),this._triggers.has(e)||m.delete(e)})}}register(i,e){return this._triggers.has(i)?!1:(this._triggers.set(i,e),!0)}_getTrigger(i){let e=this._triggers.get(i);if(!e)throw Zl(i);return e}trigger(i,e,t,r=!0){let o=this._getTrigger(e),p=new Jt(this.id,e,i),m=this._engine.statesByElement.get(i);m||(Ke(i,hi),Ke(i,hi+"-"+e),this._engine.statesByElement.set(i,m=new Map));let h=m.get(e),v=new Zt(t,this.id);if(!(t&&t.hasOwnProperty("value"))&&h&&v.absorbOptions(h.options),m.set(e,v),h||(h=$i),!(v.value===Wt)&&h.value===v.value){if(!zd(h.params,v.params)){let B=[],ie=o.matchStyles(h.value,h.params,B),ue=o.matchStyles(v.value,v.params,B);B.length?this._engine.reportError(B):this._engine.afterFlush(()=>{yt(i,ie),it(i,ue)})}return}let V=Fe(this._engine.playersByElement,i,[]);V.forEach(B=>{B.namespaceId==this.id&&B.triggerName==e&&B.queued&&B.destroy()});let k=o.matchTransition(h.value,v.value,i,v.params),O=!1;if(!k){if(!r)return;k=o.fallbackTransition,O=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:i,triggerName:e,transition:k,fromState:h,toState:v,player:p,isFallbackTransition:O}),O||(Ke(i,po),p.onStart(()=>{zt(i,po)})),p.onDone(()=>{let B=this.players.indexOf(p);B>=0&&this.players.splice(B,1);let ie=this._engine.playersByElement.get(i);if(ie){let ue=ie.indexOf(p);ue>=0&&ie.splice(ue,1)}}),this.players.push(p),V.push(p),p}deregister(i){this._triggers.delete(i),this._engine.statesByElement.forEach(e=>e.delete(i)),this._elementListeners.forEach((e,t)=>{this._elementListeners.set(t,e.filter(r=>r.name!=i))})}clearElementCache(i){this._engine.statesByElement.delete(i),this._elementListeners.delete(i);let e=this._engine.playersByElement.get(i);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(i))}_signalRemovalForInnerTriggers(i,e){let t=this._engine.driver.query(i,xi,!0);t.forEach(r=>{if(r[He])return;let o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(p=>p.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>t.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(i,e,t,r){let o=this._engine.statesByElement.get(i),p=new Map;if(o){let m=[];if(o.forEach((h,v)=>{if(p.set(v,h.value),this._triggers.has(v)){let b=this.trigger(i,v,Wt,r);b&&m.push(b)}}),m.length)return this._engine.markElementAsRemoved(this.id,i,!0,e,p),t&&pt(m).onDone(()=>this._engine.processLeaveNode(i)),!0}return!1}prepareLeaveAnimationListeners(i){let e=this._elementListeners.get(i),t=this._engine.statesByElement.get(i);if(e&&t){let r=new Set;e.forEach(o=>{let p=o.name;if(r.has(p))return;r.add(p);let h=this._triggers.get(p).fallbackTransition,v=t.get(p)||$i,b=new Zt(Wt),S=new Jt(this.id,p,i);this._engine.totalQueuedPlayers++,this._queue.push({element:i,triggerName:p,transition:h,fromState:v,toState:b,player:S,isFallbackTransition:!0})})}}removeNode(i,e){let t=this._engine;if(i.childElementCount&&this._signalRemovalForInnerTriggers(i,e),this.triggerLeaveAnimation(i,e,!0))return;let r=!1;if(t.totalAnimations){let o=t.players.length?t.playersByQueriedElement.get(i):[];if(o&&o.length)r=!0;else{let p=i;for(;p=p.parentNode;)if(t.statesByElement.get(p)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(i),r)t.markElementAsRemoved(this.id,i,!1,e);else{let o=i[He];(!o||o===Co)&&(t.afterFlush(()=>this.clearElementCache(i)),t.destroyInnerAnimations(i),t._onRemovalComplete(i,e))}}insertNode(i,e){Ke(i,this._hostClassName)}drainQueuedTransitions(i){let e=[];return this._queue.forEach(t=>{let r=t.player;if(r.destroyed)return;let o=t.element,p=this._elementListeners.get(o);p&&p.forEach(m=>{if(m.name==t.triggerName){let h=un(o,t.triggerName,t.fromState.value,t.toState.value);h._data=i,mn(t.player,m.phase,h,m.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(t)}),this._queue=[],e.sort((t,r)=>{let o=t.transition.ast.depCount,p=r.transition.ast.depCount;return o==0||p==0?o-p:this._engine.driver.containsElement(t.element,r.element)?1:-1})}destroy(i){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,i)}},dn=class{_onRemovalComplete(i,e){this.onRemovalComplete(i,e)}constructor(i,e,t){this.bodyNode=i,this.driver=e,this._normalizer=t,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}get queuedPlayers(){let i=[];return this._namespaceList.forEach(e=>{e.players.forEach(t=>{t.queued&&i.push(t)})}),i}createNamespace(i,e){let t=new ln(i,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(t,e):(this.newHostElements.set(e,t),this.collectEnterElement(e)),this._namespaceLookup[i]=t}_balanceNamespaceList(i,e){let t=this._namespaceList,r=this.namespacesByHostElement;if(t.length-1>=0){let p=!1,m=this.driver.getParentElement(e);for(;m;){let h=r.get(m);if(h){let v=t.indexOf(h);t.splice(v+1,0,i),p=!0;break}m=this.driver.getParentElement(m)}p||t.unshift(i)}else t.push(i);return r.set(e,i),i}register(i,e){let t=this._namespaceLookup[i];return t||(t=this.createNamespace(i,e)),t}registerTrigger(i,e,t){let r=this._namespaceLookup[i];r&&r.register(e,t)&&this.totalAnimations++}destroy(i,e){i&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let t=this._fetchNamespace(i);this.namespacesByHostElement.delete(t.hostElement);let r=this._namespaceList.indexOf(t);r>=0&&this._namespaceList.splice(r,1),t.destroy(e),delete this._namespaceLookup[i]}))}_fetchNamespace(i){return this._namespaceLookup[i]}fetchNamespacesByElement(i){let e=new Set,t=this.statesByElement.get(i);if(t){for(let r of t.values())if(r.namespaceId){let o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}}return e}trigger(i,e,t,r){if(yi(e)){let o=this._fetchNamespace(i);if(o)return o.trigger(e,t,r),!0}return!1}insertNode(i,e,t,r){if(!yi(e))return;let o=e[He];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;let p=this.collectedLeaveElements.indexOf(e);p>=0&&this.collectedLeaveElements.splice(p,1)}if(i){let p=this._fetchNamespace(i);p&&p.insertNode(e,t)}r&&this.collectEnterElement(e)}collectEnterElement(i){this.collectedEnterElements.push(i)}markElementAsDisabled(i,e){e?this.disabledNodes.has(i)||(this.disabledNodes.add(i),Ke(i,qi)):this.disabledNodes.has(i)&&(this.disabledNodes.delete(i),zt(i,qi))}removeNode(i,e,t){if(yi(e)){let r=i?this._fetchNamespace(i):null;r?r.removeNode(e,t):this.markElementAsRemoved(i,e,!1,t);let o=this.namespacesByHostElement.get(e);o&&o.id!==i&&o.removeNode(e,t)}else this._onRemovalComplete(e,t)}markElementAsRemoved(i,e,t,r,o){this.collectedLeaveElements.push(e),e[He]={namespaceId:i,setForRemoval:r,hasAnimation:t,removedBeforeQueried:!1,previousTriggersValues:o}}listen(i,e,t,r,o){return yi(e)?this._fetchNamespace(i).listen(e,t,r,o):()=>{}}_buildInstruction(i,e,t,r,o){return i.transition.build(this.driver,i.element,i.fromState.value,i.toState.value,t,r,i.fromState.options,i.toState.options,e,o)}destroyInnerAnimations(i){let e=this.driver.query(i,xi,!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),this.playersByQueriedElement.size!=0&&(e=this.driver.query(i,Qi,!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(i){let e=this.playersByElement.get(i);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(i){let e=this.playersByQueriedElement.get(i);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(i=>{if(this.players.length)return pt(this.players).onDone(()=>i());i()})}processLeaveNode(i){let e=i[He];if(e&&e.setForRemoval){if(i[He]=Co,e.namespaceId){this.destroyInnerAnimations(i);let t=this._fetchNamespace(e.namespaceId);t&&t.clearElementCache(i)}this._onRemovalComplete(i,e.setForRemoval)}i.classList?.contains(qi)&&this.markElementAsDisabled(i,!1),this.driver.query(i,Rd,!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(i=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,r)=>this._balanceNamespaceList(t,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let t=0;t<this.collectedEnterElements.length;t++){let r=this.collectedEnterElements[t];Ke(r,Dd)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let t=[];try{e=this._flushAnimations(t,i)}finally{for(let r=0;r<t.length;r++)t[r]()}}else for(let t=0;t<this.collectedLeaveElements.length;t++){let r=this.collectedLeaveElements[t];this.processLeaveNode(r)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){let t=this._whenQuietFns;this._whenQuietFns=[],e.length?pt(e).onDone(()=>{t.forEach(r=>r())}):t.forEach(r=>r())}}reportError(i){throw Jl(i)}_flushAnimations(i,e){let t=new Xt,r=[],o=new Map,p=[],m=new Map,h=new Map,v=new Map,b=new Set;this.disabledNodes.forEach(C=>{b.add(C);let R=this.driver.query(C,Od,!0);for(let D=0;D<R.length;D++)b.add(R[D])});let S=this.bodyNode,V=Array.from(this.statesByElement.keys()),k=uo(V,this.collectedEnterElements),O=new Map,B=0;k.forEach((C,R)=>{let D=vo+B++;O.set(R,D),C.forEach(K=>Ke(K,D))});let ie=[],ue=new Set,fe=new Set;for(let C=0;C<this.collectedLeaveElements.length;C++){let R=this.collectedLeaveElements[C],D=R[He];D&&D.setForRemoval&&(ie.push(R),ue.add(R),D.hasAnimation?this.driver.query(R,Ld,!0).forEach(K=>ue.add(K)):fe.add(R))}let Ae=new Map,Ee=uo(V,Array.from(ue));Ee.forEach((C,R)=>{let D=Wi+B++;Ae.set(R,D),C.forEach(K=>Ke(K,D))}),i.push(()=>{k.forEach((C,R)=>{let D=O.get(R);C.forEach(K=>zt(K,D))}),Ee.forEach((C,R)=>{let D=Ae.get(R);C.forEach(K=>zt(K,D))}),ie.forEach(C=>{this.processLeaveNode(C)})});let Et=[],We=[];for(let C=this._namespaceList.length-1;C>=0;C--)this._namespaceList[C].drainQueuedTransitions(e).forEach(D=>{let K=D.player,he=D.element;if(Et.push(K),this.collectedEnterElements.length){let Ie=he[He];if(Ie&&Ie.setForMove){if(Ie.previousTriggersValues&&Ie.previousTriggersValues.has(D.triggerName)){let ut=Ie.previousTriggersValues.get(D.triggerName),Be=this.statesByElement.get(D.element);if(Be&&Be.has(D.triggerName)){let ei=Be.get(D.triggerName);ei.value=ut,Be.set(D.triggerName,ei)}}K.destroy();return}}let Qe=!S||!this.driver.containsElement(S,he),Le=Ae.get(he),rt=O.get(he),se=this._buildInstruction(D,t,rt,Le,Qe);if(se.errors&&se.errors.length){We.push(se);return}if(Qe){K.onStart(()=>yt(he,se.fromStyles)),K.onDestroy(()=>it(he,se.toStyles)),r.push(K);return}if(D.isFallbackTransition){K.onStart(()=>yt(he,se.fromStyles)),K.onDestroy(()=>it(he,se.toStyles)),r.push(K);return}let Tn=[];se.timelines.forEach(Ie=>{Ie.stretchStartingKeyframe=!0,this.disabledNodes.has(Ie.element)||Tn.push(Ie)}),se.timelines=Tn,t.append(he,se.timelines);let Oo={instruction:se,player:K,element:he};p.push(Oo),se.queriedElements.forEach(Ie=>Fe(m,Ie,[]).push(K)),se.preStyleProps.forEach((Ie,ut)=>{if(Ie.size){let Be=h.get(ut);Be||h.set(ut,Be=new Set),Ie.forEach((ei,Oi)=>Be.add(Oi))}}),se.postStyleProps.forEach((Ie,ut)=>{let Be=v.get(ut);Be||v.set(ut,Be=new Set),Ie.forEach((ei,Oi)=>Be.add(Oi))})});if(We.length){let C=[];We.forEach(R=>{C.push(ed(R.triggerName,R.errors))}),Et.forEach(R=>R.destroy()),this.reportError(C)}let Pe=new Map,Ne=new Map;p.forEach(C=>{let R=C.element;t.has(R)&&(Ne.set(R,R),this._beforeAnimationBuild(C.player.namespaceId,C.instruction,Pe))}),r.forEach(C=>{let R=C.element;this._getPreviousPlayers(R,!1,C.namespaceId,C.triggerName,null).forEach(K=>{Fe(Pe,R,[]).push(K),K.destroy()})});let ct=ie.filter(C=>fo(C,h,v)),Tt=new Map;mo(Tt,this.driver,fe,v,Ze).forEach(C=>{fo(C,h,v)&&ct.push(C)});let mt=new Map;k.forEach((C,R)=>{mo(mt,this.driver,new Set(C),h,li)}),ct.forEach(C=>{let R=Tt.get(C),D=mt.get(C);Tt.set(C,new Map([...R?.entries()??[],...D?.entries()??[]]))});let Ni=[],xn=[],En={};p.forEach(C=>{let{element:R,player:D,instruction:K}=C;if(t.has(R)){if(b.has(R)){D.onDestroy(()=>it(R,K.toStyles)),D.disabled=!0,D.overrideTotalTime(K.totalTime),r.push(D);return}let he=En;if(Ne.size>1){let Le=R,rt=[];for(;Le=Le.parentNode;){let se=Ne.get(Le);if(se){he=se;break}rt.push(Le)}rt.forEach(se=>Ne.set(se,he))}let Qe=this._buildAnimation(D.namespaceId,K,Pe,o,mt,Tt);if(D.setRealPlayer(Qe),he===En)Ni.push(D);else{let Le=this.playersByElement.get(he);Le&&Le.length&&(D.parentPlayer=pt(Le)),r.push(D)}}else yt(R,K.fromStyles),D.onDestroy(()=>it(R,K.toStyles)),xn.push(D),b.has(R)&&r.push(D)}),xn.forEach(C=>{let R=o.get(C.element);if(R&&R.length){let D=pt(R);C.setRealPlayer(D)}}),r.forEach(C=>{C.parentPlayer?C.syncPlayerEvents(C.parentPlayer):C.destroy()});for(let C=0;C<ie.length;C++){let R=ie[C],D=R[He];if(zt(R,Wi),D&&D.hasAnimation)continue;let K=[];if(m.size){let Qe=m.get(R);Qe&&Qe.length&&K.push(...Qe);let Le=this.driver.query(R,Qi,!0);for(let rt=0;rt<Le.length;rt++){let se=m.get(Le[rt]);se&&se.length&&K.push(...se)}}let he=K.filter(Qe=>!Qe.destroyed);he.length?Vd(this,R,he):this.processLeaveNode(R)}return ie.length=0,Ni.forEach(C=>{this.players.push(C),C.onDone(()=>{C.destroy();let R=this.players.indexOf(C);this.players.splice(R,1)}),C.play()}),Ni}afterFlush(i){this._flushFns.push(i)}afterFlushAnimationsDone(i){this._whenQuietFns.push(i)}_getPreviousPlayers(i,e,t,r,o){let p=[];if(e){let m=this.playersByQueriedElement.get(i);m&&(p=m)}else{let m=this.playersByElement.get(i);if(m){let h=!o||o==Wt;m.forEach(v=>{v.queued||!h&&v.triggerName!=r||p.push(v)})}}return(t||r)&&(p=p.filter(m=>!(t&&t!=m.namespaceId||r&&r!=m.triggerName))),p}_beforeAnimationBuild(i,e,t){let r=e.triggerName,o=e.element,p=e.isRemovalTransition?void 0:i,m=e.isRemovalTransition?void 0:r;for(let h of e.timelines){let v=h.element,b=v!==o,S=Fe(t,v,[]);this._getPreviousPlayers(v,b,p,m,e.toState).forEach(k=>{let O=k.getRealPlayer();O.beforeDestroy&&O.beforeDestroy(),k.destroy(),S.push(k)})}yt(o,e.fromStyles)}_buildAnimation(i,e,t,r,o,p){let m=e.triggerName,h=e.element,v=[],b=new Set,S=new Set,V=e.timelines.map(O=>{let B=O.element;b.add(B);let ie=B[He];if(ie&&ie.removedBeforeQueried)return new kt(O.duration,O.delay);let ue=B!==h,fe=Yd((t.get(B)||kd).map(Pe=>Pe.getRealPlayer())).filter(Pe=>{let Ne=Pe;return Ne.element?Ne.element===B:!1}),Ae=o.get(B),Ee=p.get(B),Et=ho(this._normalizer,O.keyframes,Ae,Ee),We=this._buildPlayer(O,Et,fe);if(O.subTimeline&&r&&S.add(B),ue){let Pe=new Jt(i,m,B);Pe.setRealPlayer(We),v.push(Pe)}return We});v.forEach(O=>{Fe(this.playersByQueriedElement,O.element,[]).push(O),O.onDone(()=>Bd(this.playersByQueriedElement,O.element,O))}),b.forEach(O=>Ke(O,no));let k=pt(V);return k.onDestroy(()=>{b.forEach(O=>zt(O,no)),it(h,e.toStyles)}),S.forEach(O=>{Fe(r,O,[]).push(k)}),k}_buildPlayer(i,e,t){return e.length>0?this.driver.animate(i.element,e,i.duration,i.delay,i.easing,t):new kt(i.duration,i.delay)}},Jt=class{constructor(i,e,t){this.namespaceId=i,this.triggerName=e,this.element=t,this._player=new kt,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(i){this._containsRealPlayer||(this._player=i,this._queuedCallbacks.forEach((e,t)=>{e.forEach(r=>mn(i,t,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(i.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(i){this.totalTime=i}syncPlayerEvents(i){let e=this._player;e.triggerCallback&&i.onStart(()=>e.triggerCallback("start")),i.onDone(()=>this.finish()),i.onDestroy(()=>this.destroy())}_queueEvent(i,e){Fe(this._queuedCallbacks,i,[]).push(e)}onDone(i){this.queued&&this._queueEvent("done",i),this._player.onDone(i)}onStart(i){this.queued&&this._queueEvent("start",i),this._player.onStart(i)}onDestroy(i){this.queued&&this._queueEvent("destroy",i),this._player.onDestroy(i)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(i){this.queued||this._player.setPosition(i)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(i){let e=this._player;e.triggerCallback&&e.triggerCallback(i)}};function Bd(n,i,e){let t=n.get(i);if(t){if(t.length){let r=t.indexOf(e);t.splice(r,1)}t.length==0&&n.delete(i)}return t}function jd(n){return n??null}function yi(n){return n&&n.nodeType===1}function Ud(n){return n=="start"||n=="done"}function co(n,i){let e=n.style.display;return n.style.display=i??"none",e}function mo(n,i,e,t,r){let o=[];e.forEach(h=>o.push(co(h)));let p=[];t.forEach((h,v)=>{let b=new Map;h.forEach(S=>{let V=i.computeStyle(v,S,r);b.set(S,V),(!V||V.length==0)&&(v[He]=Fd,p.push(v))}),n.set(v,b)});let m=0;return e.forEach(h=>co(h,o[m++])),p}function uo(n,i){let e=new Map;if(n.forEach(m=>e.set(m,[])),i.length==0)return e;let t=1,r=new Set(i),o=new Map;function p(m){if(!m)return t;let h=o.get(m);if(h)return h;let v=m.parentNode;return e.has(v)?h=v:r.has(v)?h=t:h=p(v),o.set(m,h),h}return i.forEach(m=>{let h=p(m);h!==t&&e.get(h).push(m)}),e}function Ke(n,i){n.classList?.add(i)}function zt(n,i){n.classList?.remove(i)}function Vd(n,i,e){pt(e).onDone(()=>n.processLeaveNode(i))}function Yd(n){let i=[];return Io(n,i),i}function Io(n,i){for(let e=0;e<n.length;e++){let t=n[e];t instanceof Bi?Io(t.players,i):i.push(t)}}function zd(n,i){let e=Object.keys(n),t=Object.keys(i);if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let o=e[r];if(!i.hasOwnProperty(o)||n[o]!==i[o])return!1}return!0}function fo(n,i,e){let t=e.get(n);if(!t)return!1;let r=i.get(n);return r?t.forEach(o=>r.add(o)):i.set(n,t),e.delete(n),!0}var Gt=class{constructor(i,e,t){this._driver=e,this._normalizer=t,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new dn(i.body,e,t),this._timelineEngine=new sn(i.body,e,t),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(i,e,t,r,o){let p=i+"-"+r,m=this._triggerCache[p];if(!m){let h=[],v=[],b=To(this._driver,o,h,v);if(h.length)throw zl(r,h);v.length&&void 0,m=Ad(r,b,this._normalizer),this._triggerCache[p]=m}this._transitionEngine.registerTrigger(e,r,m)}register(i,e){this._transitionEngine.register(i,e)}destroy(i,e){this._transitionEngine.destroy(i,e)}onInsert(i,e,t,r){this._transitionEngine.insertNode(i,e,t,r)}onRemove(i,e,t){this._transitionEngine.removeNode(i,e,t)}disableAnimations(i,e){this._transitionEngine.markElementAsDisabled(i,e)}process(i,e,t,r){if(t.charAt(0)=="@"){let[o,p]=to(t),m=r;this._timelineEngine.command(o,e,p,m)}else this._transitionEngine.trigger(i,e,t,r)}listen(i,e,t,r,o){if(t.charAt(0)=="@"){let[p,m]=to(t);return this._timelineEngine.listen(p,e,m,o)}return this._transitionEngine.listen(i,e,t,r,o)}flush(i=-1){this._transitionEngine.flush(i)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(i){this._transitionEngine.afterFlushAnimationsDone(i)}};function Gd(n,i){let e=null,t=null;return Array.isArray(i)&&i.length?(e=Hi(i[0]),i.length>1&&(t=Hi(i[i.length-1]))):i instanceof Map&&(e=Hi(i)),e||t?new pn(n,e,t):null}var pn=class n{static{this.initialStylesByElement=new WeakMap}constructor(i,e,t){this._element=i,this._startStyles=e,this._endStyles=t,this._state=0;let r=n.initialStylesByElement.get(i);r||n.initialStylesByElement.set(i,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&it(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(it(this._element,this._initialStyles),this._endStyles&&(it(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(yt(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(yt(this._element,this._endStyles),this._endStyles=null),it(this._element,this._initialStyles),this._state=3)}};function Hi(n){let i=null;return n.forEach((e,t)=>{Kd(t)&&(i=i||new Map,i.set(t,e))}),i}function Kd(n){return n==="display"||n==="position"}var wi=class{constructor(i,e,t,r){this.element=i,this.keyframes=e,this.options=t,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=t.duration,this._delay=t.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(i=>i()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let i=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,i,this.options),this._finalKeyframe=i.length?i[i.length-1]:new Map;let e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(i){let e=[];return i.forEach(t=>{e.push(Object.fromEntries(t))}),e}_triggerWebAnimation(i,e,t){return i.animate(this._convertKeyframesToObject(e),t)}onStart(i){this._originalOnStartFns.push(i),this._onStartFns.push(i)}onDone(i){this._originalOnDoneFns.push(i),this._onDoneFns.push(i)}onDestroy(i){this._onDestroyFns.push(i)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(i=>i()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(i=>i()),this._onDestroyFns=[])}setPosition(i){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=i*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let i=new Map;this.hasStarted()&&this._finalKeyframe.forEach((t,r)=>{r!=="offset"&&i.set(r,this._finished?t:_n(this.element,r))}),this.currentSnapshot=i}triggerCallback(i){let e=i==="start"?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}},Mi=class{validateStyleProperty(i){return!0}validateAnimatableStyleProperty(i){return!0}containsElement(i,e){return go(i,e)}getParentElement(i){return fn(i)}query(i,e,t){return _o(i,e,t)}computeStyle(i,e,t){return _n(i,e)}animate(i,e,t,r,o,p=[]){let m=r==0?"both":"forwards",h={duration:t,delay:r,fill:m};o&&(h.easing=o);let v=new Map,b=p.filter(k=>k instanceof wi);cd(t,r)&&b.forEach(k=>{k.currentSnapshot.forEach((O,B)=>v.set(B,O))});let S=ld(e).map(k=>new Map(k));S=md(i,S,v);let V=Gd(i,S);return new wi(i,S,h,V)}};var vi="@",wo="@.disabled",Ai=class{constructor(i,e,t,r){this.namespaceId=i,this.delegate=e,this.engine=t,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(i){this.delegate.destroyNode?.(i)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(i,e){return this.delegate.createElement(i,e)}createComment(i){return this.delegate.createComment(i)}createText(i){return this.delegate.createText(i)}appendChild(i,e){this.delegate.appendChild(i,e),this.engine.onInsert(this.namespaceId,e,i,!1)}insertBefore(i,e,t,r=!0){this.delegate.insertBefore(i,e,t),this.engine.onInsert(this.namespaceId,e,i,r)}removeChild(i,e,t){this.parentNode(e)&&this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(i,e){return this.delegate.selectRootElement(i,e)}parentNode(i){return this.delegate.parentNode(i)}nextSibling(i){return this.delegate.nextSibling(i)}setAttribute(i,e,t,r){this.delegate.setAttribute(i,e,t,r)}removeAttribute(i,e,t){this.delegate.removeAttribute(i,e,t)}addClass(i,e){this.delegate.addClass(i,e)}removeClass(i,e){this.delegate.removeClass(i,e)}setStyle(i,e,t,r){this.delegate.setStyle(i,e,t,r)}removeStyle(i,e,t){this.delegate.removeStyle(i,e,t)}setProperty(i,e,t){e.charAt(0)==vi&&e==wo?this.disableAnimations(i,!!t):this.delegate.setProperty(i,e,t)}setValue(i,e){this.delegate.setValue(i,e)}listen(i,e,t){return this.delegate.listen(i,e,t)}disableAnimations(i,e){this.engine.disableAnimations(i,e)}},cn=class extends Ai{constructor(i,e,t,r,o){super(e,t,r,o),this.factory=i,this.namespaceId=e}setProperty(i,e,t){e.charAt(0)==vi?e.charAt(1)=="."&&e==wo?(t=t===void 0?!0:!!t,this.disableAnimations(i,t)):this.engine.process(this.namespaceId,i,e.slice(1),t):this.delegate.setProperty(i,e,t)}listen(i,e,t){if(e.charAt(0)==vi){let r=qd(i),o=e.slice(1),p="";return o.charAt(0)!=vi&&([o,p]=$d(o)),this.engine.listen(this.namespaceId,r,o,p,m=>{let h=m._data||-1;this.factory.scheduleListenerCallback(h,t,m)})}return this.delegate.listen(i,e,t)}};function qd(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}function $d(n){let i=n.indexOf("."),e=n.substring(0,i),t=n.slice(i+1);return[e,t]}var Pi=class{constructor(i,e,t){this.delegate=i,this.engine=e,this._zone=t,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(r,o)=>{o?.removeChild(null,r)}}createRenderer(i,e){let t="",r=this.delegate.createRenderer(i,e);if(!i||!e?.data?.animation){let v=this._rendererCache,b=v.get(r);if(!b){let S=()=>v.delete(r);b=new Ai(t,r,this.engine,S),v.set(r,b)}return b}let o=e.id,p=e.id+"-"+this._currentId;this._currentId++,this.engine.register(p,i);let m=v=>{Array.isArray(v)?v.forEach(m):this.engine.registerTrigger(o,p,i,v.name,v)};return e.data.animation.forEach(m),new cn(this,p,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(i,e,t){if(i>=0&&i<this._microtaskId){this._zone.run(()=>e(t));return}let r=this._animationCallbacksBuffer;r.length==0&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{let[p,m]=o;p(m)}),this._animationCallbacksBuffer=[]})}),r.push([e,t])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var Wd=(()=>{class n extends Gt{constructor(e,t,r){super(e,t,r)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(t){return new(t||n)(we(si),we(vt),we(xt))}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac})}}return n})();function Qd(){return new Ti}function Xd(n,i,e){return new Pi(n,i,e)}var Ao=[{provide:xt,useFactory:Qd},{provide:Gt,useClass:Wd},{provide:Fn,useFactory:Xd,deps:[Xn,Gt,Dn]}],Mo=[{provide:vt,useFactory:()=>new Mi},{provide:Di,useValue:"BrowserAnimations"},...Ao],Zd=[{provide:vt,useClass:hn},{provide:Di,useValue:"NoopAnimations"},...Ao],Po=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?Zd:Mo}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=ai({type:n})}static{this.\u0275inj=ri({providers:Mo,imports:[Jn]})}}return n})();var No=(n,i)=>{let e=oi(ar);return e.show(),i(n).pipe(ni(()=>e.hide()))};function Jd(n){return new fi(n,"/assets/i18n/",".json")}var ep=(n,i)=>{let e=oi(oe),t=localStorage.getItem("forestPlus_token"),r=t?n.clone({setHeaders:{Authorization:`Bearer ${t}`}}):n;return i(r).pipe(Ri(o=>o.status===401||o.status===403?localStorage.getItem("forestPlus_refresh_token")?e.refreshToken().pipe(Mn(m=>{if(m.token&&m.refreshToken)localStorage.setItem("forestPlus_token",m.token),localStorage.setItem("forestPlus_refresh_token",m.refreshToken);else return e.logout(),Kt(()=>new Error("Refresh token inv\xE1lido"));let h=n.clone({setHeaders:{Authorization:`Bearer ${m.token}`}});return i(h)}),Ri(m=>(e.logout(),Kt(()=>m)))):(e.logout(),Kt(()=>o)):Kt(()=>o)))};Zn(Sr,{providers:[mr(dr.apiBaseUrl),er(Jr,tr()),Nn(Po,L.forRoot({loader:{provide:ir,useFactory:Jd,deps:[Hn]}})),Wn(Qn([No,ep]))]}).catch(n=>console.error(n));export{Jd as HttpLoaderFactory,ep as authInterceptor};
