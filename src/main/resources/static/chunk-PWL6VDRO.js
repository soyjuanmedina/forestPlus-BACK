import{a as J}from"./chunk-MMRZ3ALF.js";import{a as K}from"./chunk-E4QVSP3L.js";import{c as Y}from"./chunk-NFADQOFW.js";import{b as k}from"./chunk-ODURNTPO.js";import{a as H,b as d,d as V,e as O,h as D,i as G,k as j,l as z,q,r as U,t as W}from"./chunk-W5EN7SUI.js";import{b as L}from"./chunk-MGSRZDJZ.js";import{Ba as a,Ca as o,Da as u,Db as B,Ha as I,Ka as x,Lb as A,M as v,Ma as g,Nb as P,Pa as f,S as y,Sb as F,T as b,Vb as N,Wb as M,Xa as l,Ya as S,Za as s,da as _,ea as n,eb as w,fa as T,ib as r,jb as i,ra as C,va as h,yb as R}from"./chunk-QVELB6IZ.js";function Q(c,X){if(c&1){let t=I();a(0,"div",1)(1,"form",2),x("ngSubmit",function(){y(t);let p=g();return b(p.onSubmitTreeType())}),a(2,"h1",3),l(3),r(4,"translate"),r(5,"translate"),o(),a(6,"div",4),u(7,"img",5),r(8,"translate"),a(9,"label",6)(10,"span",7),l(11,"photo_camera"),o(),a(12,"span"),l(13),r(14,"translate"),o(),a(15,"input",8),x("change",function(p){y(t);let m=g();return b(m.onTreeTypeFileSelected(p))}),o()()(),a(16,"div",9)(17,"div",10)(18,"label",11),l(19),r(20,"translate"),o(),u(21,"input",12),r(22,"translate"),o(),a(23,"div",10)(24,"label",13),l(25),r(26,"translate"),o(),u(27,"input",14),r(28,"translate"),o()(),a(29,"div",9)(30,"div",10)(31,"label",15),l(32),r(33,"translate"),o(),u(34,"input",16),r(35,"translate"),o(),a(36,"div",10)(37,"label",17),l(38),r(39,"translate"),o(),u(40,"input",18),r(41,"translate"),o(),a(42,"div",10)(43,"label",19),l(44),r(45,"translate"),o(),u(46,"input",20),r(47,"translate"),o()(),a(48,"div",21)(49,"button",22),x("click",function(){y(t);let p=g();return b(p.cancel())}),l(50),r(51,"translate"),o(),a(52,"button",23),l(53),r(54,"translate"),r(55,"translate"),o()()()()}if(c&2){let t=g();n(),h("formGroup",t.treeTypeForm),n(2),s(" ",t.treeType.id?i(4,17,"TREE_TYPE.EDIT_TITLE"):i(5,19,"TREE_TYPE.NEW_TITLE")," "),n(4),f("alt",i(8,21,"TREE_TYPE.IMAGE_ALT")),h("src",t.previewImage||t.treeType.picture||"assets/tree-placeholder.png",_),n(6),S(i(14,23,"TREE_TYPE.SELECT_IMAGE")),n(6),s(" ",i(20,25,"TREE_TYPE.NAME")," "),n(2),f("placeholder",i(22,27,"TREE_TYPE.NAME_PLACEHOLDER")),n(4),s(" ",i(26,29,"TREE_TYPE.DESCRIPTION")," "),n(2),f("placeholder",i(28,31,"TREE_TYPE.DESCRIPTION_PLACEHOLDER")),n(5),s(" ",i(33,33,"TREE_TYPE.CO2")," "),n(2),f("placeholder",i(35,35,"TREE_TYPE.CO2_PLACEHOLDER")),n(4),s(" ",i(39,37,"TREE_TYPE.HEIGHT")," "),n(2),f("placeholder",i(41,39,"TREE_TYPE.HEIGHT_PLACEHOLDER")),n(4),s(" ",i(45,41,"TREE_TYPE.LIFESPAN")," "),n(2),f("placeholder",i(47,43,"TREE_TYPE.LIFESPAN_PLACEHOLDER")),n(4),s(" ",i(51,45,"COMMON.CANCEL")," "),n(3),s(" ",t.treeType.id?i(54,47,"COMMON.SAVE_CHANGES"):i(55,49,"TREE_TYPE.CREATE")," ")}}var me=(()=>{class c{constructor(t,e,p,m,E){this.fb=t,this.treeTypeService=e,this.route=p,this.router=m,this.snackBar=E,this.previewImage=null}ngOnInit(){this.initForm();let t=this.route.snapshot.paramMap.get("id");t?this.loadTreeType(+t):this.treeType={}}initForm(){this.treeTypeForm=this.fb.group({name:["",d.required],description:[""],co2Absorption:[0,[d.required,d.min(0)]],typicalHeight:[0,[d.required,d.min(0)]],lifespanYears:[0,[d.required,d.min(1)]]})}loadTreeType(t){this.treeTypeService.getTreeTypeById(t).subscribe({next:e=>{this.treeType=e,this.treeTypeForm.patchValue({name:e.name,description:e.description,co2Absorption:e.co2Absorption,typicalHeight:e.typicalHeight,lifespanYears:e.lifespanYears})},error:e=>{console.error("Error al cargar el tipo de \xE1rbol",e),this.snackBar.open("\u274C Error al cargar el tipo de \xE1rbol","Cerrar",{duration:3e3})}})}onTreeTypeFileSelected(t){let e=t.target;if(!e.files?.length)return;let p=e.files[0],m=new FileReader;m.onload=()=>this.previewImage=m.result,m.readAsDataURL(p),this.treeType?.id&&this.treeTypeService.updateTreeTypePicture(this.treeType.id,p).subscribe({next:E=>{this.treeType=E,this.snackBar.open("\u2705 Imagen actualizada","Cerrar",{duration:3e3})},error:E=>{console.error("Error al actualizar la imagen",E),this.snackBar.open("\u274C Error al actualizar la imagen","Cerrar",{duration:3e3})}})}onSubmitTreeType(){if(this.treeTypeForm.invalid)return;let t=this.treeTypeForm.value;console.log("formValue",t),this.treeType?.id?this.treeTypeService.updateTreeType(this.treeType.id,t).subscribe({next:()=>{this.snackBar.open("\u2705 Tipo de \xE1rbol actualizado","Cerrar",{duration:3e3}),this.router.navigate(["/admin/tree-types"])},error:e=>{console.error("Error al actualizar el tipo de \xE1rbol",e),this.snackBar.open("\u274C Error al actualizar el tipo de \xE1rbol","Cerrar",{duration:3e3})}}):this.treeTypeService.createTreeType(t).subscribe({next:()=>{this.snackBar.open("\u2705 Tipo de \xE1rbol creado","Cerrar",{duration:3e3}),this.router.navigate(["/admin/tree-types"])},error:e=>{console.error("Error al crear el tipo de \xE1rbol",e),this.snackBar.open("\u274C Error al crear el tipo de \xE1rbol","Cerrar",{duration:3e3})}})}cancel(){this.router.navigate(["/admin/tree-types"])}static{this.\u0275fac=function(e){return new(e||c)(T(U),T(K),T(A),T(P),T(J))}}static{this.\u0275cmp=v({type:c,selectors:[["app-tree-types-form"]],standalone:!0,features:[w],decls:1,vars:1,consts:[["class","w-full max-w-full mx-auto bg-white p-6 rounded-2xl shadow-lg",4,"ngIf"],[1,"w-full","max-w-full","mx-auto","bg-white","p-6","rounded-2xl","shadow-lg"],[3,"ngSubmit","formGroup"],[1,"text-2xl","font-bold","mb-6","text-center"],[1,"md:col-span-2","flex","flex-col","items-center","mb-6"],[1,"w-24","h-24","rounded-full","shadow-lg","mb-2","object-cover",3,"src","alt"],[1,"cursor-pointer","bg-gray-200","hover:bg-gray-300","p-2","rounded-full","flex","items-center","gap-2"],[1,"material-icons"],["type","file","accept","image/*","hidden","",3,"change"],[1,"flex","flex-col","md:flex-row","gap-4","mb-6"],[1,"flex-1"],["for","name",1,"block","text-gray-700","font-medium","mb-1"],["id","name","type","text","formControlName","name","required","",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"placeholder"],["for","description",1,"block","text-gray-700","font-medium","mb-1"],["id","description","type","text","formControlName","description",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"placeholder"],["for","co2Absorption",1,"block","text-gray-700","font-medium","mb-1"],["id","co2Absorption","type","number","formControlName","co2Absorption","step","0.01",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"placeholder"],["for","typicalHeight",1,"block","text-gray-700","font-medium","mb-1"],["id","typicalHeight","type","number","formControlName","typicalHeight","step","0.01",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"placeholder"],["for","lifespanYears",1,"block","text-gray-700","font-medium","mb-1"],["id","lifespanYears","type","number","formControlName","lifespanYears",1,"w-full","rounded-xl","border","border-gray-300","px-4","py-2","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","transition",3,"placeholder"],[1,"flex","justify-end","gap-4","mt-6"],["type","button",1,"flex-1","bg-gray-300","text-gray-700","py-3","rounded-xl","hover:bg-gray-400","transition",3,"click"],["type","submit",1,"flex-1","bg-green-600","text-white","py-3","rounded-xl","hover:bg-green-700","disabled:opacity-50","transition"]],template:function(e,p){e&1&&C(0,Q,56,51,"div",0),e&2&&h("ngIf",p.treeType)},dependencies:[B,R,W,D,H,G,V,O,q,j,z,L,k,Y,F,M,N]})}}return c})();export{me as TreeTypesFormComponent};
