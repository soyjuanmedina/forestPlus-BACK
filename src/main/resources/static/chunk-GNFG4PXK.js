import{a as ne,b as ae}from"./chunk-PRLTDVXS.js";import{a as V}from"./chunk-VVF2YXIY.js";import{a as re}from"./chunk-ESV2LYFT.js";import{a as W,d as X,e as ee,f as te,g as ie}from"./chunk-XCH7AQZF.js";import{a as Y}from"./chunk-E4DPJX3Y.js";import{b as G}from"./chunk-POY4MXUO.js";import{b as q,d as c,f as U,g as $,j as H,k as Z,l as z,m as J,s as K,u as Q}from"./chunk-35J2BH3M.js";import{a as j,b as k}from"./chunk-N4FHII2L.js";import{Aa as T,Ca as C,Fa as h,Ha as A,Hb as O,J as y,Jb as R,O as x,P as _,Rb as w,Sa as a,Sb as L,Ta as l,Ua as v,Va as g,ab as S,ba as t,ca as f,fb as n,gb as o,hb as I,ma as E,qa as p,sc as D,tb as F,ub as M,wa as r,xa as i,xb as B,ya as s,za as N,zb as P}from"./chunk-6A3NVZPE.js";function pe(d,b){if(d&1&&(N(0),a(1),n(2,"date"),T()),d&2){let e=A().$implicit;t(),v(" (",I(2,1,e.effectiveDate,"dd/MM/yyyy"),") ")}}function de(d,b){if(d&1&&(r(0,"mat-option",22),a(1),n(2,"translate"),n(3,"date"),E(4,pe,3,4,"ng-container",27),i()),d&2){let e=b.$implicit;p("value",e.id),t(),g(" ",e.landName||o(2,4,"TREE.SIN_ASIGNAR")," - ",I(3,6,e.plannedDate,"dd/MM/yyyy")," "),t(3),p("ngIf",e.effectiveDate)}}function se(d,b){if(d&1){let e=C();r(0,"mat-card",1)(1,"div",2)(2,"h2",3),a(3),n(4,"translate"),i(),r(5,"form",4)(6,"div",5)(7,"mat-form-field",6)(8,"mat-label"),a(9),n(10,"translate"),i(),s(11,"input",7),i()(),r(12,"div",5)(13,"mat-form-field",6)(14,"mat-label"),a(15),n(16,"translate"),i(),s(17,"input",8),i()(),r(18,"div",5)(19,"mat-form-field",6)(20,"mat-label"),a(21),n(22,"translate"),i(),s(23,"input",9),i()(),r(24,"div",5)(25,"label",10),a(26),n(27,"translate"),i(),r(28,"div",11)(29,"mat-form-field",12)(30,"mat-label"),a(31),n(32,"translate"),i(),s(33,"input",13),i(),r(34,"mat-form-field",12)(35,"mat-label"),a(36),n(37,"translate"),i(),s(38,"input",14),i(),r(39,"mat-form-field",12)(40,"mat-label"),a(41),n(42,"translate"),i(),s(43,"input",15),i(),r(44,"mat-form-field",12)(45,"mat-label"),a(46),n(47,"translate"),i(),s(48,"input",16),i(),r(49,"mat-form-field",12)(50,"mat-label"),a(51),n(52,"translate"),i(),s(53,"input",17),i()()(),r(54,"div",5)(55,"mat-form-field",6)(56,"mat-label"),a(57),n(58,"translate"),i(),s(59,"input",18),i()(),r(60,"div",5)(61,"mat-form-field",6)(62,"mat-label"),a(63),n(64,"translate"),i(),s(65,"input",19),i()(),r(66,"div",5)(67,"mat-form-field",6)(68,"mat-label"),a(69),n(70,"translate"),i(),s(71,"input",20),i()(),r(72,"div",5)(73,"mat-form-field",6)(74,"mat-label"),a(75),n(76,"translate"),i(),r(77,"mat-select",21)(78,"mat-option",22),a(79),n(80,"translate"),i(),E(81,de,5,9,"mat-option",23),i()()(),r(82,"div",24)(83,"button",25),h("click",function(){x(e);let u=A();return _(u.cancel())}),a(84),n(85,"translate"),i(),r(86,"button",26),h("click",function(){x(e);let u=A();return _(u.save())}),a(87),n(88,"translate"),i()()()()()}if(d&2){let e=A();t(3),v(" ",e.tree.customName||(e.tree.treeType==null?null:e.tree.treeType.name)||o(4,27,"TREE.ARBOL_SIN_TIPO")," "),t(2),p("formGroup",e.treeForm),t(4),l(o(10,29,"TREE.NOMBRE_PERSONALIZADO")),t(6),l(o(16,31,"TREE.TIPO")),t(6),l(o(22,33,"TREE.SPICE")),t(5),l(o(27,35,"TREE.CO2_ABSORBIDO")),t(5),l(o(32,37,"TREE_TYPE.CO2_AT_20_LABEL")),t(2),p("readonly",!e.isAdmin),t(3),l(o(37,39,"TREE_TYPE.CO2_AT_25_LABEL")),t(2),p("readonly",!e.isAdmin),t(3),l(o(42,41,"TREE_TYPE.CO2_AT_30_LABEL")),t(2),p("readonly",!e.isAdmin),t(3),l(o(47,43,"TREE_TYPE.CO2_AT_35_LABEL")),t(2),p("readonly",!e.isAdmin),t(3),l(o(52,45,"TREE_TYPE.CO2_AT_40_LABEL")),t(2),p("readonly",!e.isAdmin),t(4),l(o(58,47,"TREE.PLANTADO_EL")),t(2),p("readonly",!e.isAdmin),t(4),l(o(64,49,"TREE.TERRENO")),t(6),l(o(70,51,"TREE.PROPIETARIO")),t(6),l(o(76,53,"TREE.PLANTACION_PLANIFICADA")),t(3),p("value",null),t(),l(o(80,55,"COMMON.NONE")),t(2),p("ngForOf",e.plannedPlantations),t(3),v(" ",o(85,57,"COMMON.CANCEL")," "),t(2),p("disabled",!e.treeForm.valid),t(),v(" ",o(88,59,"COMMON.SAVE_CHANGES")," ")}}var Oe=(()=>{class d{constructor(e,m,u,oe,le,me){this.fb=e,this.route=m,this.router=u,this.treeService=oe,this.plannedPlantationService=le,this.authService=me,this.isAdmin=!1,this.plannedPlantations=[]}ngOnInit(){this.isAdmin=this.authService.currentUserRole==="ADMIN";let e=this.route.snapshot.paramMap.get("id");e&&this.treeService.getTreeById(+e).subscribe(m=>{this.tree=m,m.land?.id&&this.loadPlannedPlantations(m.land.id),this.initForm()})}loadPlannedPlantations(e){this.plannedPlantationService.getByLand(e).subscribe(m=>{this.plannedPlantations=m})}initForm(){this.treeForm=this.fb.group({customName:[this.tree.customName||""],treeTypeName:[{value:this.tree.treeType?.name,disabled:!0}],scientificName:[{value:this.tree.scientificName,disabled:!0}],co2AbsorptionAt20:[{value:this.tree.co2AbsorptionAt20,disabled:!this.isAdmin},[c.required,c.min(0)]],co2AbsorptionAt25:[{value:this.tree.co2AbsorptionAt25,disabled:!this.isAdmin},[c.min(0)]],co2AbsorptionAt30:[{value:this.tree.co2AbsorptionAt30,disabled:!this.isAdmin},[c.min(0)]],co2AbsorptionAt35:[{value:this.tree.co2AbsorptionAt35,disabled:!this.isAdmin},[c.min(0)]],co2AbsorptionAt40:[{value:this.tree.co2AbsorptionAt40,disabled:!this.isAdmin},[c.min(0)]],plantedAt:[{value:this.tree.plantedAt,disabled:!this.isAdmin},c.required],landName:[{value:this.tree.land?.name,disabled:!0}],ownerName:[{value:this.tree.ownerUserName,disabled:!0}],plannedPlantationId:[{value:this.tree.plannedPlantation?.id||null,disabled:!this.isAdmin}]})}save(){if(!this.treeForm.valid)return;let e={customName:this.treeForm.get("customName")?.value,co2AbsorptionAt20:this.treeForm.get("co2AbsorptionAt20")?.value,co2AbsorptionAt25:this.treeForm.get("co2AbsorptionAt25")?.value,co2AbsorptionAt30:this.treeForm.get("co2AbsorptionAt30")?.value,co2AbsorptionAt35:this.treeForm.get("co2AbsorptionAt35")?.value,co2AbsorptionAt40:this.treeForm.get("co2AbsorptionAt40")?.value,plantedAt:this.treeForm.get("plantedAt")?.value,plannedPlantationId:this.treeForm.get("plannedPlantationId")?.value};this.treeService.updateTree(this.tree.id,e).subscribe(()=>{this.router.navigate(["/tree",this.tree.id])})}cancel(){this.router.navigate(["/tree",this.tree.id])}static{this.\u0275fac=function(m){return new(m||d)(f(K),f(O),f(R),f(Y),f(re),f(V))}}static{this.\u0275cmp=y({type:d,selectors:[["app-tree-form"]],standalone:!0,features:[S],decls:1,vars:1,consts:[["class","rounded-2xl shadow-md p-6 md:p-8 w-full max-w-full mx-auto",4,"ngIf"],[1,"rounded-2xl","shadow-md","p-6","md:p-8","w-full","max-w-full","mx-auto"],[1,"flex","flex-col","text-left","w-full"],[1,"text-xl","md:text-2xl","font-semibold","mb-2"],[1,"w-full",3,"formGroup"],[1,"mb-4"],[1,"w-full"],["matInput","","formControlName","customName"],["matInput","","formControlName","treeTypeName","readonly",""],["matInput","","formControlName","scientificName","readonly",""],[1,"font-medium","block","mb-1"],[1,"flex","flex-wrap","gap-4"],[1,"flex-1","min-w-[120px]"],["matInput","","type","number","formControlName","co2AbsorptionAt20",3,"readonly"],["matInput","","type","number","formControlName","co2AbsorptionAt25",3,"readonly"],["matInput","","type","number","formControlName","co2AbsorptionAt30",3,"readonly"],["matInput","","type","number","formControlName","co2AbsorptionAt35",3,"readonly"],["matInput","","type","number","formControlName","co2AbsorptionAt40",3,"readonly"],["matInput","","type","date","formControlName","plantedAt",3,"readonly"],["matInput","","formControlName","landName","readonly",""],["matInput","","formControlName","ownerName","readonly",""],["formControlName","plannedPlantationId"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","gap-4","mt-4","w-full","justify-center","md:justify-start"],["type","button",1,"flex-1","md:flex-auto","bg-gray-300","text-gray-800","py-3","px-6","rounded-xl","hover:bg-gray-400","transition",3,"click"],["type","button",1,"flex-1","md:flex-auto","bg-green-600","text-white","py-3","px-6","rounded-xl","hover:bg-green-700","transition",3,"click","disabled"],[4,"ngIf"]],template:function(m,u){m&1&&E(0,se,89,61,"mat-card",0),m&2&&p("ngIf",u.tree)},dependencies:[P,F,M,B,Q,H,q,Z,U,$,z,J,ee,X,W,ie,te,G,k,j,ae,ne,D,L,w]})}}return d})();export{Oe as TreeFormComponent};
